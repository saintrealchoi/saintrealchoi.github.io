<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>[Docker] E02.Dockerfile</title>
      <link href="2021/04/09/docker-2/"/>
      <url>2021/04/09/docker-2/</url>
      
        <content type="html"><![CDATA[<br/><blockquote><p>이글은 위키북스의 <code>시작하세요! 도커/쿠버네티스</code>를 참고하여 쓴 글입니다.</p></blockquote><br/><h1 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h1><hr><br/><img src = "/image/dockerfile.png" alignt = "center"/><br/><h2 id="Make-an-Image"><a href="#Make-an-Image" class="headerlink" title="Make an Image"></a>Make an Image</h2><br/><p>일반적으로 개발한 애플리케이션을 컨테이너화한다면 다음과 같은 순서로 작업을 시행할 것입니다.</p><ol><li>아무것도 존재하지 않는 이미지(우분투, CentOS 등)로 컨테이너를 생성</li><li>애플리케이션을 위한 환경을 설치하고 소스코드 등을 복사해 잘 동작하는지 확인</li><li>컨테이너를 이미지로 커밋</li></ol><p>위와 같은 순서로 애플리케이션이 동작하는 환경을 구성하려면 수작업으로 패키지를 설치하고 소스코드를 복사하고 구동해보고.. 어느세월에 다 하겠냐는 것입니다.</p><p>비슷한 예시로 Makefile을 들 수 있습니다.</p><p>각각의 컴파일할 파일들을 컴파일할 명령어들을 지정해두고 의존성을 설정하고 make명령을 실행하면 각각의 모든 소스코드들을 컴파일할 필요가 사라지게 되는 것과 같은 이치인 것입니다.</p><p>도커는 이러한 빌드 명령어를 제공합니다. 완성된 이미지를 생성하기 위해 컨테이너에 설치해야 하는 패키지, 추가해야 하는 소스코드 실행해야 하는 명령어와 셸 스크립트 등을 하나의 파일 <code>Dockerfile</code>에 저장합니다.</p><br/><hr><h2 id="Make-an-Simple-Web-Server-Image"><a href="#Make-an-Simple-Web-Server-Image" class="headerlink" title="Make an Simple Web Server Image"></a>Make an Simple Web Server Image</h2><br/><p>Dockerfile을 사용하기 위한 간단한 시나리오로 웹 서버 이미지를 생성하는 예를 설명해보겠습니다.</p><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mkdir dockerfile &amp;&amp; cd dockerfile</span></span><br><span class="line"><span class="comment"># echo test &gt;&gt; test.html</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">test.html</span><br></pre></td></tr></table></figure><p>이제 Dockerfile을 생성해보겠습니다. 다음과 같은 명령어로 이미지에 아파치 웹 서버를 설치한 뒤, 로컬에 있는 test.html 파일을 웹 서버로 접근할 수 있는 컨테이너의 디렉터리인 /var/www/html에 복사합니다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># vim Dockerfile</span><br><span class="line"></span><br><span class="line">FROM ubuntu:14.04</span><br><span class="line">MAINTAINER &#123;Username&#125;</span><br><span class="line">LABEL &quot;puropose&quot;&#x3D;&quot;practice&quot;</span><br><span class="line">RUN apt-get update</span><br><span class="line">RUN apt-get install apache2 -y</span><br><span class="line">ADD test.html &#x2F;var&#x2F;www&#x2F;html</span><br><span class="line">WORKDIR &#x2F;var&#x2F;www&#x2F;html</span><br><span class="line">RUN [&quot;&#x2F;bin&#x2F;bash&quot;, &quot;-c&quot;, &quot;echo hello &lt;&lt; test2.html&quot;]</span><br><span class="line">EXPOSE 80</span><br><span class="line">CMD apachectl -DFOREGROUND</span><br></pre></td></tr></table></figure><p>Dockerfile의 명령어는 위에서 아래로 line by line으로 실행됩니다.</p><br/><hr><h2 id="Command-of-Dockerfile"><a href="#Command-of-Dockerfile" class="headerlink" title="Command of Dockerfile"></a>Command of Dockerfile</h2><br/><blockquote><p>FROM : 생성할 이미지의 베이스 이미지를 의미합니다. Dockerfile을 작성할 때 <strong>반드시 한 번 이상</strong> 입력해야 하며, 이미지 이름의 포맷은 docker run 명령어에서 이미지 이름을 사용했을 때와 같습니다. 도커에 사용할 이미지가 없다면 자동으로 pull 합니다.</p></blockquote><blockquote><p>MAINTAINER : 이미지를 생성한 개발자의 정보를 나타냅니다. 일반적으로는 작성한 사람과 연락할 수 있는 이메일 드을 입력합니다. 단, 도커 <strong>1.13.0 버전 이후로 사용하지 않습니다.</strong> 대신 아래와 같은 LABEL로 대체 가능합니다.</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LABEL maintainer &quot;&#123;username&#125; &lt;username@email.com&gt;</span><br></pre></td></tr></table></figure><blockquote><p>LABEL : 이미지에 메타데이터를 추가합니다. 이 때 “key : value”형태로 저장되며, 여러개의 메타데이터가 저장될 수 있습니다. 추가된 메타데이터는 docker inspect 명령어로 이미지의 정보를 구해서 확인할 수 있습니다.</p></blockquote><blockquote><p>RUN : 이미지를 만들기 위해 컨테이너 내부에서 명령어를 실행합니다. 위 예제에서는 apt-get update와 apt-get install apache2 명령어를 실행하여 아파치 웹 서버를 설치한 이미지가 생성됩니다. 단, install을 진행하다보면 [Y/N]를 묻는 경우가 있는데 이때를 위해 -y 옵션을 통해 Yes로 입력되도록 설정을 해야합니다. 이미지를 빌드할 때 별도의 입력을 받아야하는 것이 있다면 이를 오류로 간주하고 빌드를 종료하게 됩니다.</p></blockquote><blockquote><p>ADD : 파일을 이미지에 추가합니다. 추가하는 파일은 Dockerfile이 위치한 디렉터리인 Context에서 가져옵니다. 위 예제에서는 현재 디렉토리의 <code>test.html</code>파일을 <code>/var/www/html</code> 디렉터리에 추가합니다.</p></blockquote><blockquote><p>WORKDIR : working directory 즉, 명령어를 실행할 디렉터리를 의미합니다. bash shell에서 cd를 입력하는 것과 같은 기능을 합니다. 위 예제에서는 <code>/var/www/html</code> 디렉터리로 이동한 후 <code>/bin/bash</code> shell을 통해 echo hello &lt;&lt; test2.html을 입력한 것입니다. 또한. WORKDIR를 여러번 입력하면 cd를 여러번 입력한 것과 같습니다.</p></blockquote><blockquote><p>EXPOSE : 노출할 포트를 설정하는 명령어입니다. 하지만, 반드시 이 포트가 호스트의 포트와 바인딩되는 것은 아니고 단지 컨테이너의 80번 포트를 사용한다는 의미입니다. run docker -p option과 함께 사용됩니다. 이 명령어의 사용법은 뒤에서 다시 설명하겠습니다.</p></blockquote><blockquote><p>CMD : 컨테이너가 시작될 때마다 실행할 커맨드를 설정하며, Dockerfile에서 <strong>한번만 사용할 수 있습니다.</strong> 위 예제에서는 컨테이너를 생성하고 바로 <code>apachectl -DFOREGROUND</code>라는 커맨드를 통해 컨테이너가 시작될 때 바로 아파치 웹 서버가 실행되는 것입니다. 이는 <code>docker run -d</code>option과 같습니다. 만약 <code>docker run -it</code> option을 사용한다면 포그라운드에서 동작하는 것만 확인할 수 있게됩니다. run 명령어의 커맨드와 같은 역할입니다. 만약 <code>docker run</code> 커맨드 명령어를 입력하면 Dockerfile에서 사용한 CMD의 명령어는 <code>run</code>의 커맨드 명령어로 덮어쓰입니다.</p></blockquote><br/><hr><h2 id="Another-Command"><a href="#Another-Command" class="headerlink" title="Another Command"></a>Another Command</h2><blockquote><p>ENV: Dockerfile에서 사용될 환경변수를 지정합니다. 설정한 환경변수는 <code>$&#123;ENV_NAME&#125;</code>또는 <code>$ENV_NAME</code>의 형태로 사용할 수 있습니다. 이 환경변수는 <strong>Dockerfile뿐 아니라 이미지에도 저장됩니다.</strong> 다음 Dockerfile에서는 test라는 환경변수에 /home이라는 값을 설정했습니다.</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vi Dockerfile</span><br><span class="line"></span><br><span class="line">FROM ubuntu:14.04</span><br><span class="line">ENV test &#x2F;home</span><br><span class="line">WORKDIR $test</span><br><span class="line">RUN touch $test&#x2F;mytouchfile</span><br></pre></td></tr></table></figure><p>만약 이미지를 빌드할 때 -e 옵션을 통해 같은 이름의 환경변수를 사용한다면 기존의 값은 덮어 쓰여집니다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name env_test_override \</span><br><span class="line">-e test&#x3D;myvalue \</span><br><span class="line">myenv:0.0 &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure><blockquote><p>VOLUME : 빌드된 이미지로 컨테이너를 생성했을 때 호스트와 공유할 컨테이너의 내부의 디렉터리를 설정합니다. 즉, 컨테이너와 연동할 호스트의 디렉터리를 설정하는 것입니다. VOLUME [“/home/dir”, “home/dir2”]처럼 JSON 배열의 형식으로 여러개 사용하거나 <code>VOLUME /home/dir /home/dir2</code>로도 사용할 수 있습니다.</p></blockquote><blockquote><p>ARG : build 명령어를 실행할 때 추가로 입력받아 Dockerfile 내에서 사용될 변수의 값을 설정합니다. 즉, <code>docker build --build-arg my_arg =/home -t myarg:0.0 ./</code>과 같이 입력해야만 오류가 나지 않습니다. </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vi Dockerfile</span><br><span class="line">FROM ubuntu:14.04</span><br><span class="line">ARG my_arg</span><br><span class="line">RUN touch $&#123;my_arg&#125;&#x2F;mytouch</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build --build-arg my_arg&#x3D;&#x2F;home -t myarg:0.0 .&#x2F;</span><br></pre></td></tr></table></figure><blockquote><p>USER : USER로 컨테이너 내에서 사용될 사용자 계정의 이름을 설정하면 그 아래의 멸영어는 해당 사용자의 권한으로 실행됩니다. root권한이 필요가 없다면 USER를 사용하는 것을 권장합니다.</p></blockquote><blockquote><p>ONBUILD : 빌드된 이미지를 기반으로 하는 다른 이미지가 Dockerfile로 생성될 때 실행할 명령어를 추가합니다. ONBUILD, FROM, MAINTAINER를 제외한 RUN, ADD 등, 이미지가 빌드될 때 수행돼야 하는 각종 Dockerfile의 명령어를 나중에 빌드될 이미지를 위해 미리 저장해 놓는 것입니다. 단, 상속받은 자식이미지는 ONBUILD 속성은 상속되지 않습니다.<br>한가지 예시로 메이븐이미지파일은 다음과 같은 ONBUILD 옵션을 가지고 있는데 이 이미지를 사용하는 개발자는 프로젝트 폴더에 Dockerfile을 위치하고, 아래의 Dockerfile로부터 빌드된 이미지를 FROM 항목에 입력함으로써 메이븐을 쉽게 사용할 수 있습니다.</p></blockquote><br/><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FROM maven:3-jdk-8-alpine</span><br><span class="line">RUN mkdir 0p &#x2F;usr&#x2F;src&#x2F;app</span><br><span class="line">WORKDIR &#x2F;usr&#x2F;src&#x2F;app</span><br><span class="line">ONBUILD ADD . &#x2F;usr&#x2F;src&#x2F;app</span><br><span class="line">ONBUILD RUN mvn install</span><br></pre></td></tr></table></figure><br/><blockquote><p>STOPSIGNAL : 컨테이너가 정지될 때 사용될 시스템콜의 종류를 지정합니다. default로는 SIGTERM입니다. 다음과 같이 사용할 수 있습니다.</p></blockquote><br/><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FROM ubuntu:14.04</span><br><span class="line">STOPSIGNAL SIGKILL</span><br></pre></td></tr></table></figure><br/><blockquote><p>HEALTHCHECK : 이미지로부터 생성된 컨테이너에서 동작하는 애플리케이션의 상태를 체크하도록 설정합니다. 즉, 컨테이너 내부에서 동작 중인 애플리케이션의 프로세스가 종료되지는 않았으나 동작하고 있지 않은 상태를 방지하기 위해 사용되는 옵션입니다.</p></blockquote><br/><blockquote><p>SHELL : Dockerfile에서 기본적으로 사용하는 쉘은 <code>/bin/sh -c</code> 입니다. 윈도우에서는 <code>cmd /S /C</code>입니다. 따라서 RUN echo “hello, world’라는 명령어를 사용한다면 리눅스에서는 <code>/bin/sh -c echo &quot;hello,world&quot;</code>로 사용하고 윈도우에서는 <code>cmd /S /C echo &quot;hello,world&quot;</code>라고 사용합니다. 따라서 다음과 같이 쉘을 변경할 수 있습니다.</p></blockquote><br/><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FROM node</span><br><span class="line">RUN echo hello,node!</span><br><span class="line">SHELL [&quot;&#x2F;usr&#x2F;local&#x2F;bin&#x2F;node&quot;]</span><br><span class="line">RUN -v</span><br></pre></td></tr></table></figure><br/><blockquote><p>COPY : 로컬 디렉터리에서 읽어들인 컨텍스트로부터 이미지에 파일을 복사하는 역할을 합니다. 형식은 ADD와 같습니다. 차이점은 ADD는 외부 URL 및 tar 파일에서도 파일을 추가할 수 있지만 COPY는 로컬의 파일만 추가할 수 있습니다. 단, ADD는 그다지 권장되지 않습니다. 그 이유는 정확히 어떤파일이 추가될지 알 수 없다는 것입니다.</p></blockquote><br/><blockquote><p>ENTRYPOINT : CMD와 동일하게 컨테이너가 시작될 때 실행할 명령어를 설정하는 옵션입니다. 차이점은 CMD를 인자로 받아 사용할 수 있는 스크립트의 역할을 할 수 있다는 점에서 다릅니다. 즉, entrypoint가 없다면 CMD가 그냥 실행되지만 <code>entrypoint가 있다면 CMD는 그저 entrypoint의 인자로 쓰여지게 되는 것입니다.</code> 단, 실행할 스크립트 파일은 <strong>컨테이너 내부에</strong> 존재해야 합니다.</p></blockquote><br/><p><strong>최종적으로 정리하자면</strong> 다음과 같은 순서로 이미지가 작동합니다.</p><ol><li>어떤 설정 및 실행이 필요한지에 대해 스크립트로 정리</li><li>ADD 또는 COPY로 스크립트를 이미지로 복사</li><li>ENTRYPOINT를 이 스크립트로 설정</li><li>이미지를 빌드해 사용</li><li>스크립트에서 필요한 인자는 docker run 명령어에서 cmd로 entrypoint의 스크립트에 전달</li></ol><br/><hr><h2 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h2><br/><p>밑의 명령어로 Dockerfile을 빌드해보겠습니다.</p><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker build -t mybuild:0.0 ./</span></span><br></pre></td></tr></table></figure><blockquote><p>-t : 생성될 이미지의 이름을 설정하는 옵션입니다. 이를 사용하지 않을 경우 “docker run -it ubuntu:14.04”를 했을 경우 16진수 형태의 컨테이너가 생성된 것처럼 이미지도 똑같이 16진수 형태로 저장됩니다.</p></blockquote><p>build 명령어 끝에는 Dockerfile이 저장된 경로를 입력합니다. 즉, <code>docker build -t &#123;name&#125; &#123;location of Dockerfile&#125;</code>이 됩니다. 외부 URL로부터 Dockerfile의 내용을 가져와 빌드할 수도 있습니다.</p><p>그 결과로 다음과 같은 내용이 출력됩니다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[+] Building 84.4s (11&#x2F;11) FINISHED</span><br><span class="line"> &#x3D;&gt; [internal] load build definition from Dockerfile                                                                                                                                0.1s</span><br><span class="line"> &#x3D;&gt; &#x3D;&gt; transferring dockerfile: 296B                                                                                                                                                0.0s</span><br><span class="line"> &#x3D;&gt; [internal] load .dockerignore                                                                                                                                                   0.1s</span><br><span class="line"> &#x3D;&gt; &#x3D;&gt; transferring context: 2B                                                                                                                                                     0.0s</span><br><span class="line"> &#x3D;&gt; [internal] load metadata for docker.io&#x2F;library&#x2F;ubuntu:14.04                                                                                                                     0.0s</span><br><span class="line"> &#x3D;&gt; [internal] load build context                                                                                                                                                   0.2s</span><br><span class="line"> &#x3D;&gt; &#x3D;&gt; transferring context: 41B                                                                                                                                                    0.0s</span><br><span class="line"> &#x3D;&gt; [1&#x2F;6] FROM docker.io&#x2F;library&#x2F;ubuntu:14.04                                                                                                                                       0.2s</span><br><span class="line"> &#x3D;&gt; [2&#x2F;6] RUN apt-get update                                                                                                                                                       63.7s</span><br><span class="line"> &#x3D;&gt; [3&#x2F;6] RUN apt-get install apache2 -y                                                                                                                                           19.4s</span><br><span class="line"> &#x3D;&gt; [4&#x2F;6] ADD test.html &#x2F;var&#x2F;www&#x2F;html                                                                                                                                               0.1s</span><br><span class="line"> &#x3D;&gt; [5&#x2F;6] WORKDIR &#x2F;var&#x2F;www&#x2F;html                                                                                                                                                     0.1s</span><br><span class="line"> &#x3D;&gt; [6&#x2F;6] RUN [&quot;&#x2F;bin&#x2F;bash&quot;,&quot;-c&quot;,&quot;echo hello &lt;&lt; test2.html&quot;]                                                                                                                         0.4s</span><br><span class="line"> &#x3D;&gt; exporting to image                                                                                                                                                              0.3s</span><br><span class="line"> &#x3D;&gt; &#x3D;&gt; exporting layers                                                                                                                                                             0.3s</span><br><span class="line"> &#x3D;&gt; &#x3D;&gt; writing image sha256:4b663386bafe7165ba13a67767c2a3bc94e211f8c180da22ab96b98cb6537ae6                                                                                        0.0s</span><br><span class="line"> &#x3D;&gt; &#x3D;&gt; naming to docker.io&#x2F;library&#x2F;mybuild:0.0  </span><br></pre></td></tr></table></figure><p>이제 다음 명령어를 입력해 생성된 이미지로 컨테이너를 실행해보겠습니다.</p><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker run -d -P --name myserver mybuild:0.0</span></span><br></pre></td></tr></table></figure><p>-P 옵션은 dockerfile에서 설정한 EXPOSE의 모든 포트를 호스트에 연결하도록 설정하는 것입니다. 즉, ‘컨테이너의 80번 포트를 사용한다’를 의미합니다. 개발자는 EXPOSE를 통해 실제로 사용될 때 어떤 포트가 사용돼야 하는지 명시할 수 있으며, 사용자는 어떤 포트가 사용됐는지 알 수 있게 됩니다.</p><p><code>docker port</code>명령어를 통해 다음과 같이 컨테이너와 호스트가  연결된 포트를 확인할 수 있습니다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">csj7480@DESKTOP-03N08DE:~&#x2F;dockerfile$ docker port myserver</span><br><span class="line">80&#x2F;tcp -&gt; 0.0.0.0:49153</span><br></pre></td></tr></table></figure><br/><hr><h2 id="Precautions-for-Building-with-Dockerfile"><a href="#Precautions-for-Building-with-Dockerfile" class="headerlink" title="Precautions for Building with Dockerfile"></a>Precautions for Building with Dockerfile</h2><br/><p><strong>좋은 습관(practice)</strong></p><p>: Dockerfile을 사용할 때 좋은 습관이 있습니다. 예를들면 하나의 명령어를 사용할 때 <code>&quot;\&quot;</code>를 사용하여 가독성을 높일 수 있도록 작성하거나 <code>.dockerignore</code>파일을 사용하여 불필요한 파일을 빌드 컨텍스트에 적용시키지 않아야 합니다. 그리고 이미지 구조에 대해서도 알아야할 것이 있습니다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vi Dockerfile</span><br><span class="line">FROM ubuntu:14.04</span><br><span class="line">RUN ubuntu:14.04</span><br><span class="line">RUN mkdir &#x2F;test</span><br><span class="line">RUN fallocate -l 100m &#x2F;test&#x2F;dummy</span><br><span class="line">RUN rm &#x2F;test&#x2F;dummy</span><br></pre></td></tr></table></figure><p><code>fallocate</code>은  가상으로 파일을 만들어 메모리를 할당하는 명령어 인데 위의 예시에서는 100MB를 할당한 후 /test/에 dummy파일을 만든후 RUN rm /test/dummy를 통해 파일을 다시 제거했습니다.</p><p>그렇다면 상식적으로 ubuntu 깡통파일에서 dummy를 추가했다 삭제했으므로 이미지파일은 깡통에서 100MB만 추가 되어야 하겠지만 사실은 그렇지 않습니다. 컨테이너를 이미지로 생성할 때 레이어를 쌓는 개념으로 생성하므로 단지 파일을 추가하는 레이어, 삭제하는 레이어만 추가된 것입니다. 따라서 용량이 증가하여 불필요한 크기의 이미지가 생기는 것입니다.</p><p>이를 방지하기 위해 fallocate과 rm을 <code>&amp;&amp;</code>연산자를 통해 하나로 묶는다면 이러한 오류를 제거할 수 있습니다.</p><br/><hr><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><br/><blockquote><p><code>시작하세요! 도커/쿠버네티스</code> - 용찬호</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> image </tag>
            
            <tag> Dockerfile </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Docker] E01.Image</title>
      <link href="2021/04/05/docker-1/"/>
      <url>2021/04/05/docker-1/</url>
      
        <content type="html"><![CDATA[<h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><blockquote><p>이 글은 위키북스의 <code>시작하세요! 도커/쿠버네티스</code>를 참고하여 쓴 글입니다.</p></blockquote><br/><h2 id="Create-Docker-Image"><a href="#Create-Docker-Image" class="headerlink" title="Create Docker Image"></a>Create Docker Image</h2><br/><p>기본적으로 컨테이너를 생성할 때 다음과 같이 입력을 합니다.</p><br/><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span><span class="bash"> -it --name my_docker ubuntu:14.04</span></span><br></pre></td></tr></table></figure><br/><p>이때 [OPTIONS] 뒤에 붙이는 [IMAGE]명이 ubuntu, [TAG]명이 14.04인 것인데 이러한 <code>image</code>를 만드는 방법을 알아보도록 하겠습니다.</p><p>가장 먼저, 다음 명령어를 입력해 이미지로 만들 컨테이너를 생성합니다. 컨테이너 내부에 first라는 이름의 파일을 하나 생성하여 기존의 이미지로부터 변경사항을 한가지 만듭니다.</p><br/><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span><span class="bash"> -it --name commit_test ubuntu:14.04</span></span><br><span class="line">root@<span class="number">1</span>d152 :/<span class="comment"># echo test_first! &gt;&gt; first</span></span><br></pre></td></tr></table></figure><br/><p>first라는 파일을 만들어 기존의 image인 ubuntu:14.04로부터 변경사항을 만든 후 컨테이너에서 호스트로 빠져나와 docker commit 명령어를 사용하여 이미지로 만들 것입니다.</p><br/><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]</span><br></pre></td></tr></table></figure><br/><p>다음 명령은 아까 만들었던 commit_test라는 컨테이너를 commit_test:first라는 이름의 이미지로 생성하는 것입니다.</p><br/><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker commit \  // option</span><br><span class="line">-a <span class="string">&quot;YOUR_ID&quot;</span> -m <span class="string">&quot;Message&quot;</span> \// -a는 author를 의미</span><br><span class="line">commit_test \// 저장할 image</span><br><span class="line">commit_test:first    // 저장할 image 이름</span><br></pre></td></tr></table></figure><br/><p>위의 결과로 아래와 같은 이미지가 생성되는 것을 볼 수 있습니다.</p><br/><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">csj7480@DESKTOP-<span class="number">03</span>N08DE:~$ docker images</span><br><span class="line">REPOSITORY              TAG       IMAGE ID       CREATED          SIZE</span><br><span class="line">commit_test             first     c7d7b705e5a5   <span class="number">13</span> seconds ago   <span class="number">197</span>MB</span><br></pre></td></tr></table></figure><br/><h2 id="Extract-Image"><a href="#Extract-Image" class="headerlink" title="Extract Image"></a>Extract Image</h2><br/><p>도커 이미지를 별도로 저장하거나 옮기는 등 필요에 따라 이미지를 단일 바이너리 파일로 저장해야 할 때가 있습니다. docker save 명령어를 사용하면 컨테이너의 커맨드, 이미지 이름과 태그 등 이미지의 모든 메타데이터를 포함해 하나의 파일로 추출할 수 있습니다. -o 옵션에는 추출될 파일명을 입력합니다.</p><br/><blockquote><p>메타데이터(Metadata)는 데이터에 대한 데이터이다.<br>Karen Coyle에 의하면 “어떤 목적을 가지고 만들어진 데이터(Constructed data with a purpose)” 라고 정의한다.<br>출처 : <a href="https://wa-yeong.tistory.com/14">https://wa-yeong.tistory.com/14</a></p></blockquote><br/><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker save -o ubuntu_14_04.tar ubuntu:<span class="number">14.04</span></span><br></pre></td></tr></table></figure><br/><p>이 때 추출된 이미지는 이미지의 모든 메타데이터를 포함하기 때문에 load 명령어로 이미지를 로드하면 이전의 이미지와 <strong>완전히 동일한</strong> 이미지가 도커엔진에 생성됩니다.<br><br/></p><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker load-i ubuntu_14_04.tar</span><br></pre></td></tr></table></figure><br/><p>유사하게 사용할 수 있는 명령어로 <code>export</code>,<code>import</code>가 있는데, detach모드나 변경된 사항, 컨테이너 command와 같은 컨테이너의 설정 등을 이미지에 저장하지 않아 효율적이지 못합니다,</p><p>이는 레이어 구조의 파일이 아닌 단일 파일이기 때문에 여러버전의 이미지를 추출하면 이미지 용량을 각기 차지하게 됩니다.</p><p>예륻 들면, ubuntu:14.04이미지와 commit_test:first라는 두 개의 이미지를 <code>export</code>할 경우 각각 197MB의 파일이 생성되어 총 394MB의 용량을 차지하게 됩니다.</p><br/><h2 id="Docker-private-Registry"><a href="#Docker-private-Registry" class="headerlink" title="Docker private Registry"></a>Docker private Registry</h2><br/><p>컨테이너 이미지는 컨테이너의 사본이라고 할 수 있는데, 이 이미지를 복사해서 다른 시스템으로 이동을 시킬 수 있습니다. 생성된 컨테이너 이미지는 일종의 템플릿이 되며, 새로운 애플리케이션을 만들거나 확대 및 확장할 때 이 템플릿을 사용합니다.</p><p>그러한 이미지를 작업하려면 생성된 이미지를 저장, 업로드, 다운로드의 프로세스를 거쳐야 하는데 이러한 프로세스를 통해 공유할 수 있는 장소를 레지스트리라고 합니다.</p><p>레지스트리의 종류는 publick과 private이 존재하는데 우선 private registry에 대해 먼저 알아보도록 하겠습니다.</p><p>도커 사설 레지스트리(Docker Private Registry)를 사용하면 개인 서버에 이미지를 저장할 수 있는 저장소를 만들 수 있습니다. 이 레지스트리는 컨테이너로서 구현되므로 이에 해당하는 도커 이미지가 존재합니다. 이 이미지는 도커에서 공식적으로 제공하기 때문에 아래의 run 명령어로 간단히 사용할 수 있습니다.</p><br/><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span><span class="bash"> -d --name myregistry \</span></span><br><span class="line"><span class="bash">-p 5000:5000 \</span></span><br><span class="line"><span class="bash">--restart=always \</span></span><br><span class="line"><span class="bash">registry:2.6</span></span><br></pre></td></tr></table></figure><br/><p>이 때, 레지스트리는 기본적으로 5000번 포트를 사용하므로 -p 옵션으로 호스트의 5000번 포트를 컨테이너의 5000번 포트와 연결하는 옵션을 지정해줍니다.</p><p>이 포트로 <code>RESTful API</code>를 사용할 수 있습니다.</p><br/><p><code>curl localhost:5000/v2/</code>명령어를 통해 레지스트리 컨테이너가 정상적으로 작동하는지 확인해봅시다.</p><p><code>curl</code>명령어는 HTTP요청을 보내는 도구 중 하나입니다.</p><br/><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">csj7480@DESKTOP-<span class="number">03</span>N08DE:~$ curl localhost:<span class="number">5000</span>/v2/</span><br><span class="line">&#123;&#125;csj7480@DESKTOP-<span class="number">03</span>N08DE:~$</span><br></pre></td></tr></table></figure><br/><p>위와 같이 {}가 출력됨을 확인할 수 있습니다.</p><p>이제 Push를 해보겠습니다. 도커 허브의 저장소를 사용할 때 썼던 이미지를 레지스트리 컨테이너에 올려봅시다. 다음의 명령을 입력하여 이미지의 이름을 추가합니다.</p><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag my-image-name:<span class="number">0.0</span> $&#123;DOCKER_HOST_IP&#125;:<span class="number">5000</span>/my-image-name:<span class="number">0.0</span></span><br></pre></td></tr></table></figure><p>이때, ${DOCKER_HOST_IP}에는 레지스트리 컨테이너를 생성한 도커 호스트 IP를 입력합니다.</p><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker push localhost:<span class="number">5000</span>/my-image-name:<span class="number">0.0</span></span><br></pre></td></tr></table></figure><br/><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">csj7480@DESKTOP-<span class="number">03</span>N08DE:~$ docker push localhost:<span class="number">5000</span>/my-image-name:<span class="number">0.0</span></span><br><span class="line">The push refers to repository [localhost:<span class="number">5000</span>/my-image-name]</span><br><span class="line">adcd7cbb0060: Pushed</span><br><span class="line"><span class="number">83109</span>fa660b2: Pushed</span><br><span class="line"><span class="number">30</span>d3c4334a23: Pushed</span><br><span class="line">f2fa9f4cf8fd: Pushed</span><br><span class="line"><span class="number">0.0</span>: digest: sha256:<span class="number">9</span>d5b17cc8225ebfc551944991eaf21e16cc6e6b84628df904277d751909c6e19 size: <span class="number">1152</span></span><br></pre></td></tr></table></figure><br/><p align = "center"><img src = "/image/docker_1.jpg"/></p><hr><br/><p>위와 같이 push가 안되어있는 것을 볼 수 있는데, registry를 원격에 구축하기 위해서는 몇가지 설정이 필요합니다.</p><p>기본적으로 도커 데몬은 HTTPS를 사용하지 않은 레지스트리 컨테이너에 접근하지 못하도록 설정되어있습니다. 따라서, HTTPS를 사용하려면 인증서를 적용해 별도로 설정해야 하는데, 이 내용은 나중에 다뤄보도록 하겠습니다.</p><p>지금은 테스트를 위해 HTTPS를 사용하지 않아도 이미지를 push, pull할 수 있도록 해봅시다.</p><p>도커데몬은 JSON 형태로 된 파일을 읽어 실행 옵션으로 사용합니다. 도커 데몬은 기본적으로 <code>etc/docker/daemon.json</code>파일을 읽지만 이 파일이 없어도 도커 데몬이 실행되므로 꼭 이 방법을 사용해야하는 것은 아닙니다. 하지만 현재 사용 중인 운영체제에서 도커 서비스 설정 파일의 위치를 모르거나 도커 실행 옵션이 많아서 관리가 어렵다면 <code>daemon.json</code>파일을 작성하는 것이 편리합니다.</p><p>앞서말한 설정을 위해 이 파일에 들어가서 다음을 추가합니다.</p><p>OS가 Linux가 아닌 Windows일 경우 <code>User/.docker/daemon.json</code>의 경로로 확인할 수 있습니다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;insecure-registries&quot;: [&quot;localhost:5000&quot;]</span><br></pre></td></tr></table></figure><p>도커 데몬에 <code>--insecure-registry</code>옵션만 추가하면 별도의 인증 절차 없이 레지스트리 컨테이너에서 이미지를 push,pull할 수 있습니다.</p>]]></content>
      
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> image </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[WearMask] E00.Capstone Project</title>
      <link href="2021/03/15/wearmask-00/"/>
      <url>2021/03/15/wearmask-00/</url>
      
        <content type="html"><![CDATA[<h1 id="Capstone-Software-project"><a href="#Capstone-Software-project" class="headerlink" title="Capstone Software project"></a>Capstone Software project</h1><p><br></br></p><h2 id="시작하기에-앞서"><a href="#시작하기에-앞서" class="headerlink" title="시작하기에 앞서"></a>시작하기에 앞서</h2><hr><p> 캡스톤소프트웨어프로젝트를 수강하며 졸업프로젝트를 진행하려고 한다.</p><p>캡스톤프로젝트는 학교에서 프로젝트 주제를 정해주고 마음에 드는 주제를 정하여 교수님과 컨택하여 정하는 방식으로 진행된다.</p><p>나는 그 중 <strong>마스크 착용 감지 알람 시스템</strong>을 선택하게 되었다.</p><p>선택하게된 가장 큰 이유는 방학 중 <strong>AAIS</strong>에서 노영균교수님의 지도하에 이미지분류 딥러닝 모델을 공부했었기 때문이다.</p><p>또한, 랩실 인턴을하면서 이미지를 가지고 활용할 수 있는 분야가 무궁무진하다 생각했기 때문이다.</p><center><img src = "/image/tsne.jpg"/></center><center>[그림 1] PCA(위), t-SNE(아래)를 통해 이미지 분포 비교</center><p><br></br></p><p> 위의 이미지는 Nature지에 실린 [Efficient neural network compression via transfer learning for machine<br>vision inspection]논문에서 발췌한 이미지이다.</p><p>비록, 분류하려는 이미지가 전이학습(Transfer Learning)할 모델의 학습데이터인 /imageNet과 분포가 다른데도 불구하고 <strong>전이학습을 해야만 한다는 것이다.</strong></p><p>이미지 인식을 조금 더 배우고 적용시켜보고싶다는 생각에 위와같은 주제를 선택하였다.</p><p><br></br></p><h2 id="마스크-착용-감지"><a href="#마스크-착용-감지" class="headerlink" title="마스크 착용 감지?"></a>마스크 착용 감지?</h2><hr><p> 구글링을 해보면 마스크 착용을 구분하는 모델이 굉장히 많이 나와있다.</p><p>실제로 그를 적용시켜보면 학습이 잘되어 있는 것처럼보인다.</p><p>우선, webcam을 열고 cvlib에서 제공하는 <code>detect_face</code>를 사용하면 얼굴을 검출해주고 딥러닝 모델을 통해 마스크를 썼는지 안썼는지 판단해준다.</p><p>그럼 더이상 진행할 이유가 없지 않은가?</p><p><strong>하지만 큰 문제가 있다.</strong></p><p>그 문제를 지금부터 살펴볼까 한다.</p><p><br></br></p><h2 id="Face-Detection"><a href="#Face-Detection" class="headerlink" title="Face Detection"></a>Face Detection</h2><hr><center><img src = "/image/test.jpg"/></center><center>[그림 2] 프로토타입</center><p><br></br></p><p> 간단하게 만들어본 모델을 사용할 시 위와같은 결과가 나온다.</p><p>얼굴인식이 cvlib에서 제공하는 메서드를 사용할 경우 어느정도는 얼굴인식을 하지만 사람이 멀어질 수록 검출을 못한다.</p><p>또한, cvlib의 face detection은 마스크를 쓰지 않은 얼굴을 학습시킨 모델이라 마스크를 썼을 경우 구분을 못하는 경우도 존재한다.</p><p>따라서, 이부분을 먼저 수정해야한다.</p><hr><ol><li><p>OpenCV Haar Training &amp; Cascade Training</p><p>Haar Cascad classifier은 ‘Rapid Object Detection using a Boosted Cascade of Simple Features’에서 제안된 효과적인 객체 검출 방법이다.</p></li></ol><p>다수의 객체 이미지(positive /image)와 그 외의 객체가 아닌 이미지(negative /image)를 cascade함수로 트레이닝 시켜 객체 검출을 하는 머신러닝 기반의 접근 방법이다.</p><p>다수의 얼굴 이미지(우리의 목표를 위해 마스크를 쓴 이미지도 필요하다)와 억룽리 없는 이미지를 classifier에 학습시켜 얼굴의 특징들을 추출해서 저장한다.</p><p>학습을 시키기 이전의 <code>cv2.CascadeClassifier</code>(<code>haarcascade_frontface.xml</code>)을 사용할 경우 기존의 <code>cvlib.detect_face</code>보다 조금 더 잘찾는다.</p><p>하지만 눈에 띄게 잘 찾는 것이 아니므로 마스크를 쓴 이미지로 다시 학습을 시켜봐야할 것이다.</p><p><br></br></p><center><img src = "/image/features.jpg"/></center><center>[그림 3] cascade classifer가 학습할 feature들</center><p><br></br></p><hr><ol start="2"><li><p>MTCNN</p><p>이 딥러닝 모델을 보았을 때 굉장히 놀랐다. 예시를 한 번 보게 된다면 다음과 같다.</p></li></ol><p><br></br></p><center><img src = "/image/many.png"/></center><center>[그림 4] MTCNN을 적용시켰을 때 face detection</center><p><br></br></p><p> 굉장히 작은 얼굴들도 모두 검출해내는 것을 볼 수 있다.</p><p><br></br></p><center><img src = "/image/structure.png"/></center><center>[그림 5] MTCNN 학습 방법</center><p><br></br></p><p> 위와 같이 P-net, R-net, O-net이라는 CNN을 차례로 통과하는 Cascade모델이다.</p><p><br></br></p><p><a href="https://youtu.be/w4tigQn-7Jw"><img src="https://img.youtube.com/vi/w4tigQn-7Jw/0.jpg" alt="MTCNN Process /images"></a></p><center>[그림 6] MTCNN 학습 방법 영상 </center><br></br><p> 한눈에 보기 쉽게 설명해놓은 유튜브 영상이다.</p><p><br></br></p><h2 id="Recognize-the-Mask"><a href="#Recognize-the-Mask" class="headerlink" title="Recognize the Mask"></a>Recognize the Mask</h2><hr><center><img src = "/image/fail.jpg"/></center><center>[그림 7] 프로토타입</center><p><br></br></p><p> 위의 결과를 보면 알 수 있듯이 아직은 정확히 검출하지 못하는 것을 볼 수 있다.</p><p>첫번째로 학습을 시켰을 때 피부가 하얀 남자나 여자들은 구분을 못시켰었는데 학습데이터가 내 얼굴이라 색도 모델이 보고있는 것인가생각하여서 다양한 인종의 사진들을 캐글에서 긁어와 학습시켰지만 여전히 구분을 못시키고 있음을 볼 수 있다.</p><p>이는 아직 데이터셋의 부족으로 일어난 현상이라 생각한다.</p><p>마스크를 썼다, 안썼다 두가지로만 분류하고 있었는데 tensorflow-keras로 학습을 시켰을 때 학습이 매우 잘되어 처음부터 99퍼센트의 accruacy를 보여주었었다.</p><p>그리고 단 3번의 epoch만으로도 99.999에 가까운 accuracy를 보여주는 것으로 보아 좀더 노이즈가 많은 데이터를 주고 학습을 시켜야겠단 생각이 들었다.</p><p><br></br></p><h2 id="앞으로의-계획"><a href="#앞으로의-계획" class="headerlink" title="앞으로의 계획"></a>앞으로의 계획</h2><hr><p> 딥러닝의 black-box특성을 살짝 엿볼 수 있게 하는 grad-CAM이라는 모듈을 사용해서 마스크를 잘 보고 있는지 확인해가며 학습을 시켜볼 예정이다.</p><p><br></br></p><p><img src="https://media.arxiv-vanity.com/render-output/4682170/figures/grad-cam_approach.jpg" alt="grad-cam"></p><center>[그림 8] Grad-CAM의 원리</center><p><br></br></p><p> 그리고 face detection분야도 다양한 모듈을 사용하고 수정해가며 검출률을 높여보려고한다.</p><p>일년동안의 프로젝트가 잘 진핻되었으면 좋겠다는 생각을 하며 글을 마치도록 하겠다.</p><p><br></br></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><hr><ol><li><a href="http://www.arxiv-vanity.com/papers/1611.07450/">http://www.arxiv-vanity.com/papers/1611.07450/</a></li><li><a href="https://m.blog.naver.com/PostView.nhn?blogId=dnjswns2280&amp;logNo=222028246343&amp;proxyReferer=https://www.google.com/">https://m.blog.naver.com/PostView.nhn?blogId=dnjswns2280&amp;logNo=222028246343&amp;proxyReferer=https:%2F%2Fwww.google.com%2F</a></li><li><a href="https://www.youtube.com/watch?v=w4tigQn-7Jw">https://www.youtube.com/watch?v=w4tigQn-7Jw</a></li><li><a href="https://yeomko.tistory.com/16">https://yeomko.tistory.com/16</a></li><li><a href="https://www.kaggle.com/prasoonkottarathil/face-mask-lite-dataset?select=with_mask">https://www.kaggle.com/prasoonkottarathil/face-mask-lite-dataset?select=with_mask</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> WearMask </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AAIS </tag>
            
            <tag> WearMask </tag>
            
            <tag> Capstone </tag>
            
            <tag> DeepLearning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AAIS] After Finishing Internship</title>
      <link href="2021/02/24/aais-final/"/>
      <url>2021/02/24/aais-final/</url>
      
        <content type="html"><![CDATA[<h1 id="AAIS-인턴을-마무리하며"><a href="#AAIS-인턴을-마무리하며" class="headerlink" title="AAIS 인턴을 마무리하며"></a>AAIS 인턴을 마무리하며</h1><hr><br><h2 id="1-다른-주제들에-대해서"><a href="#1-다른-주제들에-대해서" class="headerlink" title="1. 다른 주제들에 대해서"></a>1. 다른 주제들에 대해서</h2><hr><br><p>나는 치아 데이터를 통해 나이를 추정하는 것을 해보았지만, 같은 인턴들 중에는 트랜스포머를 다룬분이 세분이나 계셨다.</p><p>트랜스포머는 자연어처리를 함에 있어서 최근 가장 핫한 주제여서 손대볼까 했지만 나는 기본부터(?) 차근차근 해나가는 걸 해보고 싶어서 저 주제를 선택했던 것이다.</p><p>트랜스포머에 대해서 따로 공부하진 않았지만 세분 덕에 많은 것을 배웠다.</p><ol><li>Transformer의 Attention의 역할</li><li>Embedding을 했을 때와 안했을 때 PCA와 t-sne를 통한 관찰</li><li>Positional Encoding의 유무로 달라지는 Attention의 관계</li></ol><p>나중에 자연어처리에 대해서 공부하게 된다면 이번 인턴을 통해서 얻은 지식을 충분히 활용할 수 있을 것 같았다.</p><p>또한, 신호처리를 하신분도 계셨는데 이 데이터도 더 발전시킨다면 심전도그래프나 다른 심박수 그래프같은 것이 일정시간 지나면 의사에게 바로 신호가 가는 시스템도 만들 수 있을 것 같았다.</p><p>워낙 의료분야에는 변수도 많고 전제조건이 많아서 이를 다 포함하는 네트워크가 만들어질 수 있을진 모르겠지만 분명한건 정말 만들어질 것 같다.</p><p>진짜다.</p><br><h2 id="2-나의-주제에-대해서"><a href="#2-나의-주제에-대해서" class="headerlink" title="2. 나의 주제에 대해서"></a>2. 나의 주제에 대해서</h2><hr><br><p>짧게 연구주제에 대해서 요약하자면</p><ol><li>ImageNet을 학습했던 ResNet-152를 Transfer Learning(전이학습)을 하였다.</li><li>데이터 분포의 차이가 커서 base model을 freeze하지 않고 Full Layer Training을 하였다.</li><li>Overfitting을 막고자 data augmentation(Flip, Brightness, Rotation)을 하였다.</li><li>공간정보를 잃지 않기 위해 일반적인 Flatten Layer보다 Global Average Pooling + FC 층을 classifier로 사용하였다.</li><li>Majority Voting System을 통해 Accuracy를 높였다.</li></ol><br><p align = 'center'><img src = '/image/result.jpg'></p><center>그림1.[연구결과 요약]</center><br><p>우선 결과는 좋지 않은 편이었다. 김승현박사님과 노영균교수님이 진행했던 프로젝트를 리빌딩하는 주제나 다름이 없었는데 기본적인 accuracy 측면에서 좋지 못했다.</p><p>AUC score만 봤을 때도 좋지 못한 편이었는데 적게는 5%부터 많게는 10%까지 수치가 차이가 났다.</p><p>정말 아쉬운 결과였지만 교수님과 조교님들에게 조언을 받아 발전시킬 수 있을 것이라 생각한다.</p><p>한 조교님이 같은 주제를 이어서 하고 계시는데, Global Average Pooling층이 아닌 Flatten + FC층도 좋은 결과가 나오고 있다고 한다.</p><p>나는 <code>x = keras.layers.Flatten()(x)</code>이후에 base model의 필터의 갯수인 2048개를 연결해보고 점점 줄여져 나가는 형식으로 진행했었다.</p><p>그리고 GAP층으로 했을 때도 필터의 수를 늘릴 수 있다고 생각하지 못해서 이것보다 늘리지 못했었는데, Flatten을 하게되면 기본적으로 1차원벡터로 길게 늘어나는데, 이 때는 Node의 수를 2048개보다 늘릴 수 있다는 생각을 간과했었다.</p><p>validation accuracy가 0.88정도로 수렴했다고 하는데 나보다 무려 10퍼센트나 높은 수치였다. 그리고 실제 논문에서도 0.87정도로 수렴했기 때문에 더 좋은 방법이라 생각한다.</p><br><p align = 'center'><img src = '/image/grad.jpg'></p><center>그림2.[Grad-CAM을 이용한 네트워크 내부관찰]</center><br><p>역시 시각화시키는 것이 흥미유발이 잘되는 것 같다.</p><p>Loss가 줄어들면서 학습이 되어나가는 짜릿함도 있지만 시각화됐을 때 어떤 요소가 class를 결정짓는데 중요한 역할을 했는지 볼 수 있는 Grad-CAM같은 것도 알게되어 좋았다.</p><p>또한, 프로젝트를 발표하면서 교수님의 조언도 도움이 되었다. 연구가설과 연구결과로 인해 얻을 수 있는 점을 기술하지 않았는데</p><p>이를 명확히 하는 것이 보기 좋을 것 같고 프로젝트의 의미를 와닿게 설명하는 것이라 생각한다.</p><br><h2 id="3-마무리-지으며"><a href="#3-마무리-지으며" class="headerlink" title="3. 마무리 지으며"></a>3. 마무리 지으며</h2><hr><br><p>교수님과 조교님들에게 많은 것을 배운 시간들이었다.</p><p>중간에 장청재박사님의 발표연습도 구경해봤고 어떻게 발표를 구상해야 짧은시간내에 흥미유발과 정보전달이 잘될지 알게 되었다.</p><p>처음에는 아무것도 모르고 시작한 것이라 잘 모르고 응용부터 시작하려했는데 교수님께서 원리를 놓치지 말고 공부하라고 조언 해주셔서 원리를 알고 적용을 시켰다.</p><p>짧은 시간이었지만 정말 많은것을 배웠다.</p><p>이제는 졸업프로젝트로 다시 시작해보겠다.</p>]]></content>
      
      
      <categories>
          
          <category> AAIS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AAIS </tag>
            
            <tag> keras </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Java] Day08 - 인터페이스</title>
      <link href="2021/02/15/java-day8/"/>
      <url>2021/02/15/java-day8/</url>
      
        <content type="html"><![CDATA[<p align = 'center'><img src = "https://user-images.githubusercontent.com/12427330/103539943-44dc6c00-4edc-11eb-8dbb-9d6f3bacf911.png"></p><p>이 스터디는 백기선님의 유튜브로 진행되는 live study입니다.</p><br><h1 id="Day08-인터페이스"><a href="#Day08-인터페이스" class="headerlink" title="Day08. 인터페이스"></a>Day08. 인터페이스</h1><br><h2 id="Review-Day07"><a href="#Review-Day07" class="headerlink" title="Review Day07"></a>Review Day07</h2><hr><blockquote></blockquote><h2 id="Day08-인터페이스-1"><a href="#Day08-인터페이스-1" class="headerlink" title="Day08. 인터페이스"></a>Day08. 인터페이스</h2><hr><br><h3 id="What-is-Interface"><a href="#What-is-Interface" class="headerlink" title="What is Interface"></a>What is Interface</h3><hr><br><p>인터페이스 하면 남자들은 가장 많이 떠오르는 것이 게임하면서 본 인터페이스다(?). 반가운 단어지만 이제부터 다뤄볼 인터페이스는 다른얘기이다.</p><p>인터페이스란 일종의 <strong>추상클래스</strong>이다. 인터페이스는 추상클래스처럼 추상메서드를 갖지만 추상클래스보다 추상화정도가 높아서 추상클래와 달리 몸통을 갖춘 일반 메서드 또는 멤버변수를 구성원으로 가질 수 없다.</p><p>오직 <strong>추상메서드</strong>와 <strong>상수</strong>만을 멤버로 가질 수 있으며, 그 외의 다른 <strong>어떠한 요소</strong>도 가질 수 없다.</p><p>추상클래스를 <code>미완성 설계도</code>라고 한다면 인터페이스는 <code>기본 설계도</code>라고 할 수 있다.</p><p>또한, 추상클래스는 ==”is-a : ~는 ~이다”==의 개념이고, 인터페이스는 ==”has-a: ~는 ~를 할 수 있다.”==의 개념이다.</p><p>ex. SSON은 사람 Person 이면서 코딩(Developable)을 할 수 있다.</p><ul><li>class SSON <strong>extends</strong> Person <strong>implements</strong> Developable</li></ul><p>이제부터 인터페이스의 사용법과 사용이유에 대해서 다뤄보도록 하겠다.</p><br><h3 id="How-to-define-Interface"><a href="#How-to-define-Interface" class="headerlink" title="How to define Interface"></a>How to define Interface</h3><hr><br><p>인터페이스를 정의 하는 것은 클래스와 동일하다. 키워드로 class 대신 interface를 사용한다는 것만 다르다. interface의 접근제어자는 public 또는 default를 사용할 수 있다.</p><p>예시는 다음과 같다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">howToMakeInterface</span> </span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> 상수이름 = 값;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> 메서드이름(매개변수);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>인터페이스는 다음과 같은 제약조건이 있다.</p><ol><li>모든 멤버변수는 public static final 이어야 하며, 이를 생략할 수 있다.</li><li>모든 메서드는 public abstract 이어야 하며, 이를 생략할 수 있다. (단, static메서드와 default메서드는 예외)</li></ol><p>static과 default메서드는 뒤에서 다뤄보도록 하겠다.</p><p>인터페이스에 정의된 모든 멤버에 예외없이 적용되는 사항이기 때문에 제어자를 생략할 수 있는 것이다. 인텔리제이를 사용하다보면 접근제어자를 생략하는 것을 자주 경험하게 되는데 클래스에서 대부분 public을 사용하기 때문에 생략하면 public으로 implicit하게 선언되는 것이기 때문이다.</p><p>이는 컴파일 시에 컴파일러가 자동적으로 추가해준다.</p><br><h3 id="Inherit-Interface"><a href="#Inherit-Interface" class="headerlink" title="Inherit Interface"></a>Inherit Interface</h3><hr><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Movable</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>; <span class="comment">// public abstract가 생략되었다.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Attackable</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">attack</span><span class="params">(Unit u)</span></span>; <span class="comment">// public abstract가 생략되었다.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Fightable</span> <span class="keyword">extends</span> <span class="title">Movable</span>, <span class="title">Attackable</span></span>&#123; &#125;</span><br></pre></td></tr></table></figure><p>클래스의 상속과 마찬가지로 자손 인터페이스(Fightable)는 조상 인터페이스(Movable, Attackable)에 정의된 멤버를 모두 상속받는다.</p><p>위에 Fightable 인터페이스는 정의된 멤버가 한개도 없지만 조상 인터페이스에서 정의된 move와 attack을 멤버로 갖게되는 것이다.</p><p>또한, 인터페이스는 인터페이스로부터만 상속을 받을 수 있다. 당연한 것일수도 있는데 자손이 추상클래스만 선언이 가능한데 부모 클래스가 추상클래스가 아닐경우 상속을 받으면 이에 위반되는 경우가 생성될 수 있으므로 당연한 것이다.</p><p>인터페이스의 상속 구조에서는</p><p><strong>→ 서브 인터페이스는 수퍼 인터페이스의 메서드까지 모두 구현해야 한다.</strong></p><p>→ <strong>인터페이스 레퍼런스는</strong> 인터페이스를 <strong>구현한 클래스의 인스턴스를 가리킬 수 있고</strong>, 해당 인터페이스에 선언된 메서드(수퍼 인스턴스 메소드 포함)만 호출 할 수 있다.</p><p><strong>단, 인터페이스는 클래스와 달리 Object와 같은 최상위조상이 존재하지 않는다.</strong></p><br><h3 id="How-to-implement-Interface"><a href="#How-to-implement-Interface" class="headerlink" title="How to implement Interface"></a>How to implement Interface</h3><hr><br><p>인터페이스도 추상클래스이기 때문에 당연히 그 자체로는 인스턴스를 생성하는 것이 불가능하다.</p><p>추상클래스가 상속을 통해 추상메서드를 완성하는 것처럼, 인터페이스도 자신에 정의된 추상메서드의 몸통을 만들어주는 클래스를 작성해야 한다.</p><p>그 방법은 다음과 같다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> 클래스이름 <span class="keyword">implements</span> 인터페이스이름</span>&#123;</span><br><span class="line"><span class="comment">//추상메서드를 구현.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fighter</span> <span class="keyword">implements</span> <span class="title">Fightable</span></span>&#123;</span><br><span class="line"><span class="function">pulic <span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;   implement  &#125;</span><br><span class="line">    <span class="function">pulic <span class="keyword">void</span> <span class="title">attack</span><span class="params">(Unit u)</span> </span>&#123;  implement   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>인터페이스는 implements를 사용하여 구현을 하는데 말 그대로 구현을 해야하기 때문이다. 모든 멤버를 구현하지 않을 경우는 abstract를 붙여서 완성되지 않은 클래스임을 명시해줘야한다.</p><p>위처럼 Fightable이라는 interface에 구성되어야할 move, attack과 같은 메서드를 <strong>모두</strong> 작성하지 않을 경우 abstract를 붙여야 한다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Fighter</span> <span class="keyword">implements</span> <span class="title">Fightable</span></span>&#123;</span><br><span class="line"><span class="function">pulic <span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;   implement  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>인터페이스의 이름에는 주로 ~able의 접미사가 붙는 경우가 많은데, 그 이유는 어떠한 기능 또는 행위를 하는데 필요한 메서드를 제공한다는 의미를 직관적으로 알게하기 위함이다. 반드시 ‘able’로 끝나야하는 것은 아니지만 가독성을 높이기위해서는 따르는 것이 좋을 것이다.</p><br><h3 id="Multiple-Inheritance-of-Interface"><a href="#Multiple-Inheritance-of-Interface" class="headerlink" title="Multiple Inheritance of Interface"></a>Multiple Inheritance of Interface</h3><hr><br><p>다중상속을 할 때, 멤버변수의 이름이 같거나 메서드의 선언부가 일치하고 구현 내용이 다르다면 어떤 조상의 것인지 불분명하기 때문에 자바에서는 다중상속을 허용하지 않는다.</p><p>또 다른 객체지향언어인 C++에서는 다중상속을 허용하기 때문에 다중상속의 단점이 부각되지만 인터페이스로 다중상속을 구현할 수 있다.</p><p>다중상속을 위해서 인터페이스를 사용하는 것은 아니므로 헷갈리지 말자.</p><p>상위 인터페이스에 있는 메서드 중에서 <strong>메서드 명과 파라미터 형식은 같지만 리턴 타입이 다른</strong> 메서드가 있다면, 둘중 어떤 것을 상속받느냐에 따라 <strong>규칙이 달라지기 때문에 다중 상속이 불가능</strong>하다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tv</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">boolean</span> power;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> channel;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> volume;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">power</span><span class="params">()</span> </span>&#123; power = ! power;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">channelUp</span><span class="params">()</span> </span>&#123; channel++;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">channelDown</span><span class="params">()</span> </span>&#123; channel--;&#125;;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VCR</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> counter;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCounter</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> counter;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IVCR</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCounter</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TVCR</span> <span class="keyword">extends</span> <span class="title">Tv</span> <span class="keyword">implements</span> <span class="title">IVCR</span></span>&#123;</span><br><span class="line">    VCR vcr = <span class="keyword">new</span> VCR();</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCounter</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> vcr.getCounter();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>위와같이 다중상속을 허용할 수 있다.</p><br><h3 id="How-to-use-the-implementation-using-reference"><a href="#How-to-use-the-implementation-using-reference" class="headerlink" title="How to use the implementation using reference"></a>How to use the implementation using reference</h3><hr><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function">String <span class="title">getName</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getLegs</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><p>위와 같이 <code>Animal</code>이라는 interface가 있다고 하자.</p><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bird</span> <span class="keyword">implements</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;새&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getLegs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">implements</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;고양이&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getLegs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><p><code>Bird</code>와 <code>Cat</code>이라는 <code>Animal</code> interface를 구현한 class가 있을 때, 두 클래스를 인스턴스화 하여 메서드를 호출해보자.</p><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Cat cat = <span class="keyword">new</span> Cat();</span><br><span class="line">Bird bird = <span class="keyword">new</span> Bird();</span><br><span class="line"></span><br><span class="line">System.out.println(cat.getName()); <span class="comment">// 고양이</span></span><br><span class="line">System.out.println(cat.getLegs()); <span class="comment">// 4</span></span><br><span class="line"></span><br><span class="line">System.out.println(bird.getName()); <span class="comment">// 새</span></span><br><span class="line">System.out.println(bird.getLegs()); <span class="comment">// 2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br><p>또한, 인스턴스들은 interface타입으로 생성이 가능하다.</p><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Animal cat = <span class="keyword">new</span> Cat();</span><br><span class="line">Animal bird = <span class="keyword">new</span> Bird();</span><br></pre></td></tr></table></figure><br><p>Animal 인터페이스를 파라미터로 받는 메소드가 있다면 Cat, Bird 타입의 인스턴스를 파라미터로 사용할 수 있습니다.</p><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printAnimal</span><span class="params">(Animal animal)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;이름 : &quot;</span> + animal.getName());</span><br><span class="line">    System.out.println(<span class="string">&quot;다리 개수 : &quot;</span> + animal.getLegs());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Cat cat = <span class="keyword">new</span> Cat();</span><br><span class="line">Bird bird = <span class="keyword">new</span> Bird();</span><br><span class="line"></span><br><span class="line">printAnimal(cat);</span><br><span class="line">printAnimal(bird);</span><br></pre></td></tr></table></figure><br><h3 id="Default-Method-of-Interface-java8"><a href="#Default-Method-of-Interface-java8" class="headerlink" title="Default Method of Interface, java8"></a>Default Method of Interface, java8</h3><hr><br><p>java8부터는 Default Method와 Static Method를 선언할 수 있다. static method는 인스턴스를 생성하지 않아도 가능하므로 없을 이유가 없었다.</p><p>static method는 나중에 다뤄보고 우선 default method부터 다뤄보겠다.</p><p>들어가기에 앞서 default method가 필요한 이유에 대해서 얘기해보겠다.</p><blockquote><p>Q. 만약 당신이 유명한 RPG게임의 제작자라고 하자. 직업군이 총 256가지인 게임이라고 할 때, 인터페이스에 아이템 강화시스템을 도입한다고 한다. 인터페이스에 강화시스템을 도입한다면 추상메서드이기 때문에 구현한 모든 직업군에 따로 정의를 해야할 것이다. 구현 X 256을 한다면 총 얼마의 시간이 걸리겠는가?</p></blockquote><p>정말 최악이다. 구현을 간단하게 한다 쳐도 256번을 반복하라니 정말 최악이다. 하지만 interface에 default method 즉, 기본으로 생성할 수 있는 method가 없을 경우의 얘기이다.</p><p>디폴트 메서드는 추상 메서드의 기본적인 구현을 제공하는 메서드로, <strong>추상 메서드가 아니기 때문에</strong> 디폴트 메서드가 새로 추가되어도 해당 인터페이스를 구현한 클래스를 변경하지 않아도 된다.</p><p>이 때, 새로 추가된 디폴트 메서드가 기존의 메서드와 이름이 중복되어 충돌하는 경우가 발생할 수 있다. 이럴 경우는 다음의 규칙을 따른다.</p><ol><li><p>여러 인터페이스의 디폴트 메서드간의 충돌</p><ul><li>인터페이스를 구현한 클래스에서 디폴트 메서드를 오버라이딩해야한다.</li></ul></li><li><p>디폴트 메서드와 조상 클래스의 메서드간의 충돌</p><ul><li>조상 클래스의 메서드가 상속되고, 디폴트 메서드는 무시된다.</li></ul></li></ol><p>위의 경우를 코드로 살펴보겠다.</p><p align = 'center'><img src = "/image/ab.jpg"></p><p>위와같이 1.같은 경우에는 디폴트 메서드간의 충돌이 일어나서 컴파일시 오류가 나는 경우이다.</p><p align = 'center'><img src = "/image/makea.jpg"></p><p>위와같이 2.같은 경우에는 조상 클래스의 printMethod가 실행됨을 알 수 있다.</p><br><h3 id="Static-Method-of-Interface-java8"><a href="#Static-Method-of-Interface-java8" class="headerlink" title="Static Method of Interface, java8"></a>Static Method of Interface, java8</h3><hr><br><p>인스턴스 생성과 상관없이 인터페이스 타입으로 호출하는 메소드이다.</p><p>static 예약어를 사용하고, 접근제어자는 항상 public이며 생략 할 수 있다.</p><p>static method는 일반적으로 우리가 정의하는 메소드와는 다르다.</p><ol><li><p>code body가 있어야 한다.</p></li><li><p>implements 한 곳에서 override가 불가능하다.</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">StaticInterface</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">make</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;static make&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">newInterface</span> <span class="keyword">extends</span> <span class="title">StaticInterface</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">make</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;it isn&#x27;t overriding&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>위의 <code>StaticInterface</code>의 <code>make</code>를 호출하기 위해서는 <code>StaticInterface.make()</code>를 써야지만 호출이 가능하다.</p><h3 id="Private-Method-of-Interface-java9"><a href="#Private-Method-of-Interface-java9" class="headerlink" title="Private Method of Interface, java9"></a>Private Method of Interface, java9</h3><hr><br><p>java8 에서는 default method와 static method가 추가 되었고,</p><p>java9 에서는 private method와 private static method가 추가 되었다.</p><p>java8의 default method와 static method는 여전히 불편하게 만든다.</p><p>단지 특정 기능을 처리하는 내부 method일 뿐인데도, 외부에 공개되는 public method로 만들어야하기 때문이다.</p><p>interface를 구현하는 다른 interface 혹은 class가 해당 method에 엑세스 하거나 상속할 수 있는 것을 원하지 않아도, </p><p>그렇게 될 수 있는 것이다.</p><p>java9 에서는 위와 같은 사항으로 인해 private method와 private static method라는 새로운 기능을 제공해준다.</p><p> → 코드의 중복을 피하고 interface에 대한 캡슐화를 유지 할 수 있게 되었다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Car</span> </span>&#123; </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">carMethod</span><span class="params">()</span></span>; </span><br><span class="line">    <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">defaultCarMethod</span><span class="params">()</span> </span>&#123; </span><br><span class="line">        System.out.println(<span class="string">&quot;Default Car Method&quot;</span>);</span><br><span class="line">        privateCarMethod(); privateStaticCarMethod(); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">privateCarMethod</span><span class="params">()</span> </span>&#123; </span><br><span class="line">        System.out.println(<span class="string">&quot;private car method&quot;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">privateStaticCarMethod</span><span class="params">()</span> </span>&#123; </span><br><span class="line">        System.out.println(<span class="string">&quot;private static car method&quot;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DefaultCar</span> <span class="keyword">implements</span> <span class="title">Car</span></span>&#123; </span><br><span class="line">    <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">carMethod</span><span class="params">()</span> </span>&#123; </span><br><span class="line">        System.out.println(<span class="string">&quot;car method by DefaultCar&quot;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><br><hr><br><ol><li><a href="https://www.notion.so/4b0cf3f6ff7549adb2951e27519fc0e6">https://www.notion.so/4b0cf3f6ff7549adb2951e27519fc0e6</a></li><li><a href="https://blog.baesangwoo.dev/posts/java-livestudy-8week/">https://blog.baesangwoo.dev/posts/java-livestudy-8week/</a></li><li><a href="https://dev-coco.tistory.com/13">https://dev-coco.tistory.com/13</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java8 </tag>
            
            <tag> interface </tag>
            
            <tag> java9 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AAIS] E07. ROC-curve</title>
      <link href="2021/02/14/aais-07/"/>
      <url>2021/02/14/aais-07/</url>
      
        <content type="html"><![CDATA[<h1 id="ROC-curve"><a href="#ROC-curve" class="headerlink" title="ROC curve"></a>ROC curve</h1><h2 id="ROC-cuve"><a href="#ROC-cuve" class="headerlink" title="ROC cuve"></a>ROC cuve</h2><hr><p>ROC(Receiver Operating Characteristic) curve는 다양한 threshold에 대한 이진분류의 성능을 표시한 것이다.</p><p>이진분류란 ‘맞다 틀리다’ ‘사람이다 아니다’와 같이 두가지의 경우로 분류하는 것을 말하며,</p><p>우리는 True Positive Rate와 False Positive Rate 두 가지를 이용해서 표현하게 된다.</p><p>ROC curve는 이러한 지표들을 이용해서 어느 것이 분류를 더 잘했는지 판단해주는 그래프이다.</p><p>딥러닝에서 metric을 판단할 때, accuracy말고 또 보아야 하는 것 중 하나인 것이다.</p><p>accuracy와 ROC-curve의 차이는 간단한 예로 확인할 수 있다.</p><p>전체 100명 중 90명이 COVID-19에 양성의 반응을 일으키고, 10명이 음성의 반응이 난다 하자. 어떠한 분류기가 모든 환자를 감염자라고 분류할 경우</p><p>accuracy는 90%에 달한다. 하지만 이는 분명히 틀린 분류기 이다. 정확한 판단을 위해서는 감염자를 감염자로 분류하는 것(TPR)과 비감염자를 비감염자(FPR)라고 분류하는 두가지 경우를 살펴봐야 하는 것이다.</p><br><p align = 'center'><img src = "https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2020-08-05-ROC/pic1.png", width = "500px"></p><center>그림1. ROC-curve</center><br><h2 id="True-Positive-False-Positive"><a href="#True-Positive-False-Positive" class="headerlink" title="True Positive? False Positive?"></a>True Positive? False Positive?</h2><hr><p>처음에 이것을 보면 무슨 뜻인지 감이 안잡힐 수 있다. 우리와 같은 주니어들을 위해 정의에 대해서 다뤄보겠다.</p><p>어떠한 환자가 암에 걸렸다고 했을 때, 암에 걸렸다(A)와 암에 걸리지 않았다(B)로 나누자.</p><ol><li>True Positive(= Sensitivity) : 예측한 값(A)과 실제의 경우(A)가 같을 때 즉, 맞을 때</li><li>False Positive(= Specificity) : 예측한 값(B)과 실제의 경우(A)가 다를 때 즉, 틀릴 때</li><li>True Negative : 예측한 틀린 경우(B)와 실제의 틀린 경우(B)가 같을 때</li><li>False Negative : 예측한 틀린 경우(A)와 실제의 틀린 경우가(B)가 다를 때</li></ol><br><p align = 'center'><img src = "https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2020-08-05-ROC/pic3.png", width = "500px"></p><center>그림2. TPR과 FPR의 그래프</center><br><p>쉽게 말하자면, True/False는 예측값이 실제와 같을 때, 다를 때이고 Positive, Negative는 예측값을 옳은 경우, 틀린 경우로 나눌 때이다.</p><p>TPR(True Positive Rate)과 FPR(False Positive Rate)은 서로 비례하는 관계에 있다. 암환자를 진단할 때, 성급한 의사는 아주 조금의 징후만 보여도 암이라고 진단할 수 있으며 이 경우 TPR은 1에 가까워진다. 동시에 FPR도 1에 가까워진다.</p><p>반대로, 실력이 없는 의사라서 암환자를 알아내지 못한다면, 모든 환제에 대해 암이 아니라고 할것이며, 이경우 TPR은 매우 낮아져 0에 가까워질 것이고, 마찬가지로 FPR도 0에 가까워질 것이다.</p><p>따라서, TPR을 높이면 필연적으로 FPR도 높아진 다는 것이다. 이를 위해서 기준(Threshold)를 정해서 TPR과 FPR을 측정을 해야하는 것이다. 그리고 이것을 한눈에 볼 수 있도록 시각화한 것이 ROC-Cuve인 것이다.</p><p>ROC-curve의 장점에는 한가지가 더 있는데, <strong>병의 위험성에 따라서 어떤 기준을 둬야할 지 정하기가 좋다는 것이다.</strong></p><p>예를 들어 췌장암같이 걸릴 확률은 낮지만 치사율이 굉장히 높은 질병이 있다고 할 때, 약간의 징후만으로 병을 양성이라고 판단하는 것은 더 좋은 결과를 나타낼 수 있다. 따라서 FPR도 또한 높아지지만 더 많은 환자를 살릴 수 있을 것이다.</p><h2 id="ROC-curve에서-점의-의미"><a href="#ROC-curve에서-점의-의미" class="headerlink" title="ROC-curve에서 점의 의미"></a>ROC-curve에서 점의 의미</h2><hr><p>앞서 말했듯이 상황에 따라 다른 threshold를 적용해야한다.</p><p>threshold를 TPR또는 FPR에 따라 정의하게 되었을 때, 그 부분을 정의하는 것이다.</p><p>즉, threshold별로 TPR과 FPR을 알아보게 되는 것이다. 모든 threshold별로 비율을 쉽게 보게 된다는 것이다.</p><p align = "center"><img src ="https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2020-08-05-ROC/pic6.gif"></p><h2 id="ROC-curve에서-그래프의-의미"><a href="#ROC-curve에서-그래프의-의미" class="headerlink" title="ROC-curve에서 그래프의 의미"></a>ROC-curve에서 그래프의 의미</h2><hr><p>그래프는 이진분류의 성능에 따라 다르게 그려진다.</p><p align = "center"><img src ="https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2020-08-05-ROC/pic7.gif"></p><p>위와 같이 두가지의 그룹을 잘분류할수록 많이 휘고 분류하지 못할경우 직선에 가까워진다.</p><p>이처럼 곡선의 모양에 따라 분류를 잘 할 수있음을 판단할 수 있는 근거가 되는 것이다.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://angeloyeo.github.io/2020/08/05/ROC.html">https://angeloyeo.github.io/2020/08/05/ROC.html</a><br><a href="https://newsight.tistory.com/53">https://newsight.tistory.com/53</a></p>]]></content>
      
      
      <categories>
          
          <category> AAIS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AAIS </tag>
            
            <tag> keras </tag>
            
            <tag> metrics </tag>
            
            <tag> ROC </tag>
            
            <tag> AUC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Java] Day07 - 패키지</title>
      <link href="2021/02/06/java-day7/"/>
      <url>2021/02/06/java-day7/</url>
      
        <content type="html"><![CDATA[<h1 id="Day07-패키지"><a href="#Day07-패키지" class="headerlink" title="Day07. 패키지"></a>Day07. 패키지</h1><h2 id="Review-Day06"><a href="#Review-Day06" class="headerlink" title="Review Day06"></a>Review Day06</h2><hr><blockquote><p>Q1. @Override Annotation이 단순히 마크의 의미만 가지고 있나요?</p></blockquote><p>아니다. 단순히 오버라이딩한 메서드임을 보여주는 것이 아니라 컴파일러가 오버라이딩을 한것인지 오류를 체크해준다.</p><p>예를 들어, 나는 오버라이딩을 잘했다고 생각했지만 막상 컴파일을 하고 보니 이것은 오버라이딩을 한것이 아닌 새로운 메서드를 정의한 것이라면 오류가 뜨게 하는 것이다.</p><p>따라서, 명시적으로 어노테이션을 하는 것이 좋다.</p><br><h2 id="Day07-패키지-1"><a href="#Day07-패키지-1" class="headerlink" title="Day07. 패키지"></a>Day07. 패키지</h2><hr><br><h3 id="package-keyword"><a href="#package-keyword" class="headerlink" title="package keyword"></a>package keyword</h3><hr><p>패키지란, 클래스의 묶음이다. 패키지 안에는 클래스 또는 인터페이스를 포함시킬 수 있으며, 서로 관련된 클래스들끼리 그룹 단위로 묶어 놓음으로써 클래스를 효율적으로 관리할 수 있다.</p><p>같은 이름의 클래스 일지라도 서로 다른 패키지에 존재하는 것이 가능하므로, 자신만의 패키지 체계를 유지함으로써 다른 개발자가 개발한 클래스 라이브러리의 클래스와 이름이 충돌하는 것을 피할 수 있다. - Java의 정석</p><p>디렉토리가 디렉토리를 포함할 수 있는 것처럼 패키지 또한 다른 패키지를 포함하는 것이 가능하다. 이는 <code>.</code>으로 구분이 가능하다.</p><p>예를들어 우리가 자주쓰는 <code>String</code>클래스는 <code>java</code>라는 패키지의 <code>lang</code>안의 <code>String</code>이라는 클래스이다.</p><p>이는 <code>java.lang.String</code>으로 쓰는 것이다.</p><p>패키지는 다음과 같은 규칙을 가진다.</p><ol><li>하나의 소스파일에는 첫 번째 문장으로 단 한번의 패키지 선언만을 허용한다.</li><li>모든 클래스는 반드시 하나의 패키지에 속해야 한다.</li><li>패키지는 점(.)을 구분자로 하여 계층구조로 구성할 수 있다.</li><li>패키지는 물리적으로 클래스파일(.class)을 포함하는 하나의 디렉토리이다.</li></ol><p>또한 패키지이름의 규칙도 존재한다.</p><table><thead><tr><th>패키지 시작이름</th><th>내용</th></tr></thead><tbody><tr><td>java</td><td>자바 기본 패키지()</td></tr><tr><td>javax</td><td>자바 확장 패키지(Java vendor 개발)</td></tr><tr><td>org</td><td>일반적으로 비영리단체 (오픈소스) 패키지</td></tr><tr><td>com</td><td>일반적으로 영리단체(회사) 패키지</td></tr></tbody></table><p>패키지의 선언은</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> 패키지명;</span><br></pre></td></tr></table></figure><p>과 같이 간단하게 설정 가능하다. 우리가 인텔리제이를 쓰다보면 첫줄에 자바에서 기본적으로 제공하는 ‘이름없는패키지(unnamed package)’가 설정되어 있음을 볼 수 있다.</p><p>패키지명은 소문자로 하는 것을 원칙으로 하고 있다.</p><p>패키지를 구성하는 과정은 뒤에 클래스패스를 다루면서 다시 얘기해보겠다.</p><br><h3 id="import-keyword"><a href="#import-keyword" class="headerlink" title="import keyword"></a>import keyword</h3><hr><p>기존의 패키지에 포함되지 않은 다른 클래스들을 사용하기 위해서는 패키지명이 포함된 클래스 이름을 사용해야 한다.</p><p>하지만 매번 패키지이름을 쓰는 것은 불편하므로 import문을 사용하여 클래스의 패키지를 미리 명시해주면 소스코드에 사용되는 클래스이름에서 패키지명을 생략할 수 있다.</p><p>인텔리제이는 ‘Alt+Enter’를 하면 자동으로 import해주는 기능을 가지고 있다.</p><p>클래스 이름을 지정해주는 대신 ‘*’를 사용하면 컴파일러는 해당 패키지에서 일치하는 클래스이름을 찾아야 하는 수고를 더 해야할 것이다. 단지 그 뿐이다. 실행 시 성능상의 차이는 전혀 없다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br></pre></td></tr></table></figure><p>위와 같은 코드는 다음과 같이 한줄로 줄일 수 있다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br></pre></td></tr></table></figure><p>하지만 이는 클래스의 이름 대신 ‘<em>‘를 사용하는 것이지 패키지 대신 ‘</em>‘를 사용하는 것은 불가능하다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.text.*;</span><br></pre></td></tr></table></figure><p>는</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.*;</span><br></pre></td></tr></table></figure><p>과 같지 않다.</p><br><h4 id="빌트인패키지-Built-in-package"><a href="#빌트인패키지-Built-in-package" class="headerlink" title="빌트인패키지(Built-in package)"></a>빌트인패키지(Built-in package)</h4><hr><p>지금까지 String이나 System같은 클래스들을 패키지명 없이 사용할 수 있었던 이유는 모든 소스파일에는 implicit하게 <code>import java.lang.*</code>이 선언되어 있다.</p><p>매우 중요하고 자주쓰는 패키지이기 때문에 따로 import문으로 지정하지 않아도 되도록 한 것이다.</p><p>이를 <code>built-in package</code>라 하는 것이다. 또한, 클래스 이름과 패키지 이름을 합쳐야 FQCN(Fully Qualified Class Name)이라고 한다.</p><p>추가로 static import문도 가능하다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.Integer.*; <span class="comment">// Integer클래스의 모든 static메서드</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.random; <span class="comment">// Math.random()</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.System.out; <span class="comment">// System.out을 out으로 참조가능</span></span><br></pre></td></tr></table></figure><p><code>System.out.println(Math.random()); </code>–&gt; <code>out.println(random());</code>으로 바꿀 수 있다.</p><br><h3 id="클래스패스란"><a href="#클래스패스란" class="headerlink" title="클래스패스란?"></a>클래스패스란?</h3><hr><p>클래스패스란 JVM 혹은 Java 컴파일러가 사용하는 파라미터로 클래스나 패키지를 찾을 때 기준이 되는 경로를 말한다.</p><p>즉, java 명령을 통해 class 파일을 실행할 때 클래스 파일을 찾는 기준이 되는 경로를 클래스패스라고 한다.</p><p>따로 지정해주지 않는다면 기본적으로는 java명령을 실행하는 위치(현재 디렉터리)를 말한다.</p><p>소스코드(.java로 끝나는 파일)를 컴파일하면 소스코드가 바이트코드로 변환되는데, java runtime으로 .class 파일에 포함된 명령을 실행하려면 이 파일을 찾을수 있어야한다.</p><p>.class 파일을 찾을 때, classpath에 지정된 경로를 사용한다.</p><p>세미 콜론(;)을 구분자로 하여 여러개의 경로를 지정할 수 있다.</p><p>classpath를 지정하는 방법 두가지를 살펴보겠다.</p><br><h4 id="CLASSPATH-환경변수"><a href="#CLASSPATH-환경변수" class="headerlink" title="CLASSPATH 환경변수"></a>CLASSPATH 환경변수</h4><hr><p><code>CLASSPATH=,;C:\Program Files\JDK\lib\tools.jar</code>처럼 컴퓨터 시스템 변수설정을 통해 지정할 수 있다.</p><p>JVM이 시작될 때 JVM의 클래스 로더는 이 환경변수를 호출하게 된다. 그래서 환경 변수에 설정되어 있는 디렉토리가 호출되면 그 디렉토리에 있는 클래스들을 먼저 JVM에 로드한다.</p><p>따라서, CLASSPATH 환경 변수에는 필수 클래스들이 위치한 디렉토리를 등록하도록 한다.</p><p align = 'center'><img src = 'https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FcgTFrB%2FbtqRqb5kigF%2FTIDMKzmCWECK2NDscHxQH0%2Fimg.png'></p><p>하지만, 운영체제를 변경하면 클래스패스가 사라지기 때문에 이식성 면에서는 불리하다.</p><ul><li>Windows : 시스템설정 &gt; 환경변수</li><li>linux, unix계열 : /etc/profile</li></ul><p>따라서 최근에는 운영체제 상의 환경변수로 클래스패스를 설정하는 것은 지양하고 IDE나 빌드도구를 통해 클래스패스를 설정한다.</p><br><h4 id="classpath-옵션"><a href="#classpath-옵션" class="headerlink" title="-classpath 옵션"></a>-classpath 옵션</h4><hr><p>원래의 자바 컴파일러인 <code>javac</code>를 사용할 때는 <code>javac &lt;options&gt; &lt;source filed&gt;</code>와 같은 형태로 컴파일을 했는데</p><p>참조할 클래스 파일들을 찾기 위해서 파일 경로를 지정해주는 <code>-classpath</code> 옵션이 있다.</p><p>예를들어 컴파일 할 <code>Test.java</code>파일이 <code>C:\Users</code>에 있고, 필요한 클래스파일들이 <code>C:\Java\classes</code>에 존재한다면,</p><p><code>javac -classpath C;\Java\classes C:\Users\Test.java</code>로 옵션을 주고 컴파일시에 클래스패스가 참조된다.</p><p>이 때, <code>-cp</code>로 약자를 사용하여 옵션을 주는 것도 가능하다.</p><br><h3 id="접근지시자-Access-Modifiers"><a href="#접근지시자-Access-Modifiers" class="headerlink" title="접근지시자(Access Modifiers)"></a>접근지시자(Access Modifiers)</h3><hr><p>접근 지시자는 멤버 변수나 메서드들의 접근 범위를 정의하기 위해 사용되는 것이다.</p><p>main 메서드가 없는 클래스는 대부분 다른 클래스에서 사용할 목적으로 설계된 클래스이다.</p><p>클래스들은 외부 클래스에서 접근할 수 있는 멤버와 접근할 수 없는 멤버를 구분하여 설계하는 것이 바람직하다.</p><p>객체 생성을 막기 위해 생성자를 호출하지 못하게 하거나, 객체의 특정 데이터를 보호하기 위해 해당 필드에 접근하지 못하게 하기 위해서 사용한다.</p><p>접근 제한자(Access Modifiers)또는 접근 수준 지시자(Access-level Modifier)라고도 한다.</p><p>우리가 사용할 접근제한자는 다음과 간다.</p><ol><li><p>public</p><p> 모든 패키지에서 아무런 제한 없이 호출 할 수 있게 하며, 보통 생성자, 필드 또는 메서드가 public이면 클래스도 public으로 선언한다.</p></li><li><p>protected</p><p> 같은 패키지에서는 제한 없이 호출할 수 있으나, 다른 패키지에서는 호출할 수 없다.</p><p> 다른 패키지에 속한 클래스가 해당 클래스의 자식 클래스라면 호출할 수 있다.</p></li><li><p>default</p><p> 접근제한자를 생략한다면 default 제한을 가진다.</p><p> protected와 같이 같은 패키지에서는 제한 없이 호출할 수 있으나, 다른 패키지에서는 호출할 수 없다.</p></li><li><p>private</p><p> 오로지 클래스 내부에서만 사용할 수 있다.</p></li></ol><br><p align = 'center'><img src ="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FKb2tD%2FbtqRrPm3DAn%2F9Q28T3eXG4n3kukPuMiup0%2Fimg.png"></p><br><table><thead><tr><th>지시자</th><th>클래스 내부</th><th>동일 패키지</th><th>상속받은 클래스</th><th>이외</th></tr></thead><tbody><tr><td>private</td><td>O</td><td>X</td><td>X</td><td>X</td></tr><tr><td>default</td><td>O</td><td>O</td><td>X</td><td>X</td></tr><tr><td>protected</td><td>O</td><td>O</td><td>O</td><td>X</td></tr><tr><td>public</td><td>O</td><td>O</td><td>O</td><td>O</td></tr></tbody></table><br><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><hr><p>자바의정석<br><a href="https://kils-log-of-develop.tistory.com/430">https://kils-log-of-develop.tistory.com/430</a><br><a href="https://blog.baesangwoo.dev/posts/java-livestudy-7week/">https://blog.baesangwoo.dev/posts/java-livestudy-7week/</a><br><a href="https://www.notion.so/ed8e346f88f54849a06ff968b1877ca5">https://www.notion.so/ed8e346f88f54849a06ff968b1877ca5</a><br><a href="https://pej4303.tistory.com/57">https://pej4303.tistory.com/57</a></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Java] Day06 - 상속</title>
      <link href="2021/02/03/java-day6/"/>
      <url>2021/02/03/java-day6/</url>
      
        <content type="html"><![CDATA[<h1 id="Day06-상속"><a href="#Day06-상속" class="headerlink" title="Day06 상속"></a>Day06 상속</h1><br><h2 id="Review-day05"><a href="#Review-day05" class="headerlink" title="Review day05"></a>Review day05</h2><br><blockquote><p>Q1. 초기화블록과 생성자 중 어느것이 먼저 실행되는가?</p></blockquote><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> number;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">this</span>.number = <span class="number">10</span>;</span><br><span class="line">    System.out.println(<span class="string">&quot;init block&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">this</span>.number = <span class="number">100</span>;</span><br><span class="line">    System.out.println(<span class="string">&quot;constructor&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main()&#123;</span><br><span class="line">Init init = <span class="keyword">new</span> Init();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같은 코드를 살펴보면 init block –&gt; constructor로 출력이 됨을 확인할 수 있다. 즉, <code>초기화블록이 먼저 실행되고 그다음 생성자가 실행되는 것</code>이다. 그렇다면 왜 초기화블록을 사용하는가? 바로, static 변수에 관해서 초기화가 필요할 수 있기 때문이다.</p><p>참고로</p><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Init</span><span class="params">(<span class="keyword">int</span> number)</span></span>&#123;</span><br><span class="line"><span class="keyword">this</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><p>위와 같은 코드는 디폴트 생성자인 this()를 호출하여 생성자를 호출하는 것이다. this 자체는 생성자는 아니지만(인스턴스) 해당 클래스의 생성자를 호출할 수 있다. (생성자는 메서드가 아니다.)<br><del>모든 생성자에는 explicit하게 this();를 쓰지 않아도 implicit하게 this();가 호출이 된다.</del><br>모든 생성자에는 explicit하게 super();를 쓰지 않아도 implicit하게 super();이 호출이 된다. 이는 이후에 있을 상속을 살펴보며 다시 보겠다.</p><blockquote><p>Q2. final은 언제 사용하는 것이 좋은가?</p></blockquote><p>상속을 막을 때 final, 생성을 막을 때 abstract로 인지하자!<br>String은 final로 선언되어 있는 것을 확인할 수 있는데 이처럼 상속받은 클래스가 메소드들을 오버라이딩하게 된다면 클래스의 목적이 달라져서 상속자체를 막기위하여 final class를 정의하게 된다. 단, 정확히는 오버라이딩만 막으려면 메소드를 final로 정의하면된다.</p><br><hr><br><h2 id="Day06-상속-1"><a href="#Day06-상속-1" class="headerlink" title="Day06 상속"></a>Day06 상속</h2><h3 id="자바-상속의-특징"><a href="#자바-상속의-특징" class="headerlink" title="자바 상속의 특징"></a>자바 상속의 특징</h3><hr><p>첫번째로 Single inheritance만 된다는 것이다. C++같은 언어는 다중상속을 허용한다.<br>여러 조상클래스로부터 상속받는 것이 가능하다는 것이다. 다중상속을 허용하면 여러 클래스로부터 상속받을 수 있기 때문에 복합적인 기능을 가진 클래스를 쉽게 작성할 수 있따는 장점이 있지만, 클래스간의 관계가 매우 복잡해진다는 것과 서로 다른 클래스로부터 상속받은 메서드나 멤버간의 이름이 같은 경우 구별할 수 있는 방법이 없다는 단점이 있다. 이에 따른 rule이 존재하여 어떤메서드가 어디서 상속되었는지 확인하지 못하면 찾기어려운 오류가 생기기 마련이다.</p><p>이러한 오류를 해결하기 위해 다중상속의 장점을 포기하고 단일상속만을 허용한다.</p><p>단일 상속이 하나의 조상클래스만을 가질 수 있기 때문에 다중상속에 비해 불편한 점이 있지만 클래스간의 관계가 더 명확해지고 코드를 신뢰할 수 있게 만들어준다는 점에서는 장점을 가지게 된다.</p><p>두번째 특징으로는 모든 클래스는 implicit하게 Object의 서브클래스라는 점이다. 이 부분은 잠시 후에 Object클래스를 다루면서 다시 얘기해보겠다.</p><h3 id="super-keyword"><a href="#super-keyword" class="headerlink" title="super keyword"></a>super keyword</h3><hr><p>super는 자손 클래스에서 조상 클래스로부터 상속받은 멤버를 참조하는데 사용되는 참조변수이다.</p><p>더 간단하게 말하자면 상속받은 클래스가 조상 클래스의 멤버를 보기위해 앞에 붙여야하는 keyword인 것이다.</p><p>멤버변수와 지역변수간에 구별하기 위해 this keyword를 붙인것과 비슷한 이치이다.</p><h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><br><ol><li>부모 클래스의 멤버 변수 접근 : super.멤버변수</li><li>부모 클래스의 멤버 메서드 접근 : super.멤버메서드(매개변수)</li><li>부모 클래스의 생성자 호출 : super(매개변수)</li></ol><p>단 주의해야할 점은 <strong>반드시 자식 클래스의 생성자 첫 라인에서 부모 생성자를 호출해야한다는 점인데 쓰지 않아도 implicit하게 호출이 된다.</strong></p><h4 id="super"><a href="#super" class="headerlink" title="super()"></a>super()</h4><hr><p><code>super()</code>는 부모클래스의 생성자를 호출할 때 사용된다. 이를 <code>constructor chaining</code>이라고 부른다.</p><h3 id="Method-overriding"><a href="#Method-overriding" class="headerlink" title="Method overriding"></a>Method overriding</h3><hr><p>오버라이딩이란 조상 클래스로부터 상속받은 메서드의 내용을 변경하는 것을 말한다.<br>그에 따른 조건은 다음과 같이 세개가 있다.</p><ol><li>이름이 같아야한다.</li><li>매개변수가 같아야한다.</li><li>반환타입이 같아야한다.</li></ol><p>즉, 선언부가 같아야한다는 것이다. 다만 <code>access modifier</code>와 <code>exception</code>은 제한된 조건 하에서만 다르게 변경할 수 있다.</p><ol><li>access modifier(접근제어자)는 조상클래스의 메서드보다 좁은 범위로 변경할 수 없다.</li></ol><ul><li>만일 조상클래스에 접근제어자가 protected라면 오버라이딩할 시 protected나 public이어야한다. 대부분의 경우에는 같은 범위의 접근 제어자를 사용한다. 접근범위의 순서는 public, protected, (default), private이다.</li></ul><ol start="2"><li>조상클래스의 메서드보다 많은 수의 예외를 선언할 수 없다.</li></ol><p>또한, 인스턴스메서드를 static메서드로, static메서드를 인스턴스메서드로 변경할 수 없다.</p><p>조상 클래스에 정의된 static메서드를 자손 클래스에서 똑같은 이름의 static메서드로 정의할 순 있지만 이는 각 클래스에 별개의 static메서드를 정의한 것일 뿐 오버라이딩한 것이 아니다.</p><p>static멤버들은 자신들이 정의된 클래스에 묶여있다고 생각하면 좋다.</p><h4 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">int</span> y;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">getLocation</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x :&quot;</span> + x + <span class="string">&quot;, y :&quot;</span> +y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point3D</span> <span class="keyword">extends</span> <span class="title">Point</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> z;</span><br><span class="line">    <span class="function">String <span class="title">getLocation</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;x :&quot;</span> + x + <span class="string">&quot;, y :&quot;</span> +y + <span class="string">&quot;, z :&quot;</span> + z;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>위처럼 상속을 받은 후에 원래 정의되어있던 메서드를 위의 규칙에 따라 재정의하는 것이 오버라이딩(overriding)이다.</p><h3 id="Dynamic-Method-Dispatch"><a href="#Dynamic-Method-Dispatch" class="headerlink" title="Dynamic Method Dispatch"></a>Dynamic Method Dispatch</h3><hr><p>Runtime polymorphism. “같은 클래스를 상속하고 있는 여러 클래스 중 어느 서브클래스를 사용할 것인가”를 런타임 시점까지 미룸으로서, 클래스 재사용성을 높이는 테크닉이다.</p><h4 id="Visitor-Pattern"><a href="#Visitor-Pattern" class="headerlink" title="Visitor Pattern"></a>Visitor Pattern</h4><br><p align = 'center'><img src = "https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=http%3A%2F%2Fcfile5.uf.tistory.com%2Fimage%2F9944383359DD815E11EC68"></p><p>오른쪽에는 Composite 패턴으로 구현 된 File과 Directory로 이루어진 데이터 구조가 있다.</p><p>다만, 방문자를 수용하기 위해 Element 인터페이스를 상속받아서 accept() 메서드를 각각 구현하고 있으며 각 element의 경로를 구하는 연산 부분이 방문자에서 이루어진다.</p><p>왼쪽에는 방문자로 데이터 구조를 방문하면서 필요한 연산을 수행한다. 각 element에 접근하기 위한 visit메서드를 오버라이딩 및 오버로딩을 하고 있다.</p><p><strong><a href="https://lktprogrammer.tistory.com/58">예제</a></strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor v)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span> <span class="keyword">implements</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Entry</span><span class="params">(String name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Entry entry)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>방문자를 수용하기 위한 accept() 메서드를 정의하는 인터페이스 Element와 File과 Directory가 공통적으로 구현 해야 할 인터페이스를 정의하는 상위 클래스 Entry를 정의한다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">File</span> <span class="keyword">extends</span> <span class="title">Entry</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">File</span><span class="params">(String name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Entry entry)</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        v.visit(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Directory</span> <span class="keyword">extends</span> <span class="title">Entry</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ArrayList&lt;Entry&gt; directory = <span class="keyword">new</span> ArrayList();    <span class="comment">//자식 객체를 담기 위한 ArrayList</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Directory</span><span class="params">(String name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Entry entry)</span>                    <span class="comment">//자식 객체 추가</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        directory.add(entry);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        v.visit(<span class="keyword">this</span>);            <span class="comment">//어느 visit() 메서드를 호출할지 결정납니다.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>데이터 구조에 해당하는 File과 Directory이다.</p><p>앞서 Composite패턴에서는 경로를 구하는 연산을 이곳에서 이루어졌던 반면에 지금은 방문자를 수용하는 accept() 메서드를 구현하고 있다.</p><p>accept() 내용은 매개변수로 받은 Visitor 객체를 통하여 자기 자신을 인자로 하는 visit() 메서드를 호출 하고 있다.</p><p>살펴 볼 것은 visit() 메서드는 File과 Directory에서 자기 자신을 인자로 해서 호출이 이루어지고 있다.</p><p>이때 File에 대한 visit() 메서드가 호출이 될지 Directory에 대한 visit()가 호출이 될지 결정이 된다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Visitor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(File file)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(Directory directory)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewVisitor</span> <span class="keyword">extends</span> <span class="title">Visitor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String Path=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(File file)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(Path + <span class="string">&quot;/&quot;</span>+file.name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(Directory dic)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Path = Path + <span class="string">&quot;/&quot;</span> + dic.name;</span><br><span class="line">        System.out.println(Path);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;dic.directory.size();i++)</span><br><span class="line">        &#123;</span><br><span class="line">            dic.directory.get(i).accept(<span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Visitor 클래스는 방문자들이 데이터 구조를 방문하기 위한 인터페이스를 정의하고 있다.</p><p>ViewVisitor 클래스는 데이터 구조를 방문하면서 각 Element의 현재 경로를 출력해주는 역할을 한다.</p><p>visit() 라는 같은 이름으로 하나는 Directory를 인자로 갖는 다른 하나는 File를 인자로 갖는 메서드를 오버로딩이 되어 있는 상태이다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String argsp[])</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Directory root = <span class="keyword">new</span> Directory(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        Directory bin = <span class="keyword">new</span> Directory(<span class="string">&quot;bin&quot;</span>);</span><br><span class="line">        Directory Lkt = <span class="keyword">new</span> Directory(<span class="string">&quot;Lkt&quot;</span>);</span><br><span class="line">        File file1 = <span class="keyword">new</span> File(<span class="string">&quot;file1&quot;</span>);</span><br><span class="line">        File file2 = <span class="keyword">new</span> File(<span class="string">&quot;file2&quot;</span>);</span><br><span class="line">        File file3 = <span class="keyword">new</span> File(<span class="string">&quot;file3&quot;</span>);</span><br><span class="line">        File file4 = <span class="keyword">new</span> File(<span class="string">&quot;file4&quot;</span>);</span><br><span class="line"></span><br><span class="line">        root.add(file1);</span><br><span class="line">        bin.add(file2);</span><br><span class="line">        bin.add(file3);</span><br><span class="line">        Lkt.add(file4);</span><br><span class="line">        root.add(Lkt);</span><br><span class="line">        root.add(bin);</span><br><span class="line"></span><br><span class="line">        root.accept(<span class="keyword">new</span> ViewVisitor());    <span class="comment">//경로 출력</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>이처럼 Visitor 패턴은 데이터 구조와 연산을 분리함으로써 데이터 구조를 변경하지 않으면서 새로운 연산을 쉽게 할 수 있다.</p><p>만약 새로운 연산을 추가하고자 한다면 새로운 visit() 메서드를 구현하면 된다.</p><h3 id="Abstract-class"><a href="#Abstract-class" class="headerlink" title="Abstract class"></a>Abstract class</h3><hr><p>추상클래스는 인스턴스로 생성할 수 없고 상속을 통해서 자손클래스에 의해 완성될 수 있는 클래스이다.</p><p>추상클래스 자체로는 클래스로서의 역할이 부락능하지만, 새로운 클래스를 작성하는데 있어서 바탕이 되는 조상클래스로의 중요한 의미가 있다. 클래스의 틀을 제공해준다고 보면 좋다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Player</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">(<span class="keyword">int</span> pos)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>위의 예제처럼 선언부만 정의되어있고 구현부는 정의되어있지 않은 특징을 지닌다. 진짜 말그대로 틀만 잡아준 것이다.</p><p>단, 추상메서드를 구현해놨다면 자손클래스에서는 반드시 구현을 시켜야한다. 그렇지 않으면 상속받은 클래스 또한 추상클래스로 정의된다.</p><p align= 'center'><img src = "/image/1592.jpg"></p><p>위처럼 컴파일 에러가 나게된다.</p><h3 id="Object-class"><a href="#Object-class" class="headerlink" title="Object class"></a>Object class</h3><hr><p>아까 말했듯 Object클래스는 모든 클래스 상속계층도의 최상위에 있는 조상클래스이다.</p><p>다른 클래스로부터 상속 받지 않는 우리가 생각하는 기존의 최상위 조상클래스는 자동적으로 Object클래스로부터 상속받게 함으로써 이것을 가능하게 한다.</p><p>실제로 위의 예시의 Player클래스를 <code>Player instanceof Object</code>문은 <code>True</code>가 나온다.</p><p align = "center"><img src = "/image/1596.jpg"></p><p>Object클래스는 위와 같은 메서드들이 정의되어있으며 모든 클래스들은 위의 메서드들을 사용할 수 있다.</p><hr><h4 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="toString()"></a>toString()</h4><br><p><strong>기본동작</strong> : 객체의 해시코드를 출력한다.<br><strong>Override 목적</strong> : 객체의 정보를 문자열 형태로 표현하고자 할 때<br><strong>toString() 의 원형은 아래와 같다.</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getClass().getName() + <span class="string">&#x27;@&#x27;</span> + Integer.toHexString(hashCode())</span><br></pre></td></tr></table></figure><hr><h4 id="equals"><a href="#equals" class="headerlink" title="equals()"></a>equals()</h4><p><strong>기본동작</strong> : ‘==’ 연산 결과 반환</p><p><strong>override 목적</strong> : 물리적으로 다른 메모리에 위치하는 객체여도 논리적으로 동일함을 구현하기 위함.</p><p>equals()를 사용해 두 객체의 동일함을 논리적으로 override할 수 있다.</p><p><strong>‘물리적 동일함’</strong> - 객체가 메모리에서 같은 주소값을 갖는 것을 의미</p><p><strong>‘논리적 동일함’</strong> - 물리적으로는 다른 위치에 있지만 같은 id의 회원객체, 같은 id의 주문객체와 같이 도메인을 구분할 수 있는 고유한 값 등에 의해 동일한 것을 의미</p><hr><h4 id="hashCode"><a href="#hashCode" class="headerlink" title="hashCode()"></a>hashCode()</h4><p><strong>해시코드란,</strong> jvm이 인스턴스를 생성할 때 메모리 주소를 변환해서 부여하는 코드.</p><p>실제 메모리 주소값과는 별개의 값이며 실제 메모리 주소는 System 클래스의 identityHashCode()로 확인할 수 있다.</p><p><strong>기본동작 :</strong> JVM이 부여한 코드값. 인스턴스가 저장된 가상머신의 주소를 10진수로 반환한다.</p><p><strong>override 목적</strong> : 두 개의 서로 다른 메모리에 위치한 객체가 동일성을 갖기 위함.</p><p><strong>자바에서의 동일성</strong></p><p>equals()의 반환값이 true, hashCode() 반환값이 동일함을 의미한다.</p><p>→ <strong>보통 equals()와 hashCode()는 함께 override 한다.</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> id;</span><br><span class="line">String name;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(<span class="keyword">int</span> id, String name)</span></span>&#123;</span><br><span class="line"><span class="keyword">this</span>.id = id;</span><br><span class="line"><span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(obj <span class="keyword">instanceof</span> User)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.getId() == ((User)obj).getId();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">      User user1 = <span class="keyword">new</span> User(<span class="number">1001</span>, <span class="string">&quot;홍길동&quot;</span>);</span><br><span class="line">      User user2 = <span class="keyword">new</span> User(<span class="number">1001</span>, <span class="string">&quot;홍길동&quot;</span>);</span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">&quot;user1.equals(user2): &quot;</span> + user1.equals(user2));</span><br><span class="line">      System.out.println(<span class="string">&quot;user1.hashCode(): &quot;</span> + user1.hashCode());</span><br><span class="line">      System.out.println(<span class="string">&quot;user2.hashCode(): &quot;</span> + user2.hashCode());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>위 main 메소드 실행 결과</strong></p><ul><li>equals 메소드를 overriding 하여 같음을 확인</li><li>hashCode는 별도 재정의 하지 않았음으로 아래와 같이 다르게 출력</li></ul><p>user1.equals(user2): true<br>user1.hashCode(): 901506536<br>user2.hashCode(): 747464370</p><p><code>Process finished with exit code 0</code></p><hr><h4 id="clone"><a href="#clone" class="headerlink" title="clone()"></a>clone()</h4><p>해당 인스턴스를 복제하여 새로운 인스턴스를 반환한다.</p><p><strong>but.</strong> 단지 필드의 값만 복사함으로, 필드의 값이 배열이나 인스턴스면 제대로 복제할 수 없다.</p><p>→ clone() 메소드를 오버라이딩하여 복제가 제대로 이루어지도록 재정의 해야 한다.</p><p>이러한 clone() 메소드는 데이터의 보호를 이유로 <strong>Cloneable 인터페이스를 구현한 클래스의 인스턴스만</strong>이 사용할 수 있다.</p><p>Clone 메소드는 신중하게 오버라이드하자. (feat. effective Java)</p><p>Cloneable 인터페이스는 복제를 허용하는 객체라는 것을 알리는 목적으로 사용하는 믹스인 인터페이스이다. (Mixin Interface)</p><ul><li><p>믹스인 인터페이스이기 때문에 자신이 clone method를 가지고 있는 것도 아니다.</p></li><li><p>Object의 clone은 Cloneable을 implements 하지 않으면 사용할 수 없다.</p><p>Cloneable 을 impelemtns한 class에서 clone을 호출하면, 해당 객체의 복제본을 만들어 반환한다.</p></li></ul><p>→ 복제 객체는 원본 객체와 같은 필드를 가지며 각 필드의 값도 복사된다.</p><p><strong>but</strong>.</p><p><strong>reference를 가진 녀석들은 Deep Copy 가 아닌 Soft Copy를 수행한다는 점에 주목해야한다.</strong></p><p>clone 메소드는 또 다른 생성자와 같다.</p><p>clone 메소드가 원본 객체에 손상을 주지 않으면서 원본과 복제 객체 간의 상호 영향도 없도록 해야 한다.</p><p>→ 즉, reference의 경우 deep copy를 해주어야 한다는 것이다.</p><p>여기서 deep copy는 해당 객체의 clone을 호출해주는 것만으로 끝나는 것이 아니다.</p><ul><li>Collection일 경우에는 Collection 안의 내용물들도 clone 을 해주는 진정한 Deep Copy가 되어야 한다.</li></ul><hr><h4 id="finalize"><a href="#finalize" class="headerlink" title="finalize()"></a>finalize()</h4><p>finalize() 메소드는 직접 호출하는 메소드가 아니라 객체가 HEAP 메모리에서 해제될 때 가비지 콜렉터가 호출하는 메소드이다.</p><p>이 메소드가 Override되어 있으면 가바지 콜렉터가 이 메소드를 호출하여 실행한다.</p><p>즉, finalize()는 객체가 해제될 때 리소스 해제, 소켓 close 등의 필요한 것들을 구현해주면 된다.</p><hr><br><br><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>Java의 정석<br><a href="https://www.notion.so/e5c33507880b4d098f83a2c4f8f02c04">https://www.notion.so/e5c33507880b4d098f83a2c4f8f02c04</a><br><a href="https://github.com/ByungJun25/study/tree/main/java/whiteship-study/6week#Method-Overriding%EA%B3%BC-Hiding">https://github.com/ByungJun25/study/tree/main/java/whiteship-study/6week#Method-Overriding%EA%B3%BC-Hiding</a><br><a href="https://lktprogrammer.tistory.com/58">https://lktprogrammer.tistory.com/58</a><br><a href="https://blog.naver.com/swoh1227/222181505425">https://blog.naver.com/swoh1227/222181505425</a><br><a href="https://leemoono.tistory.com/20">https://leemoono.tistory.com/20</a></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AAIS] E06. Grad-CAM</title>
      <link href="2021/02/01/aais-06/"/>
      <url>2021/02/01/aais-06/</url>
      
        <content type="html"><![CDATA[<h1 id="Before-start-Check-resources"><a href="#Before-start-Check-resources" class="headerlink" title="Before start Check resources"></a>Before start Check resources</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!nvidia-smi</span><br></pre></td></tr></table></figure><pre><code>Mon Feb  1 09:11:32 2021+-----------------------------------------------------------------------------+| NVIDIA-SMI 410.104      Driver Version: 410.104      CUDA Version: 10.1     ||-------------------------------+----------------------+----------------------+| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC || Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. ||===============================+======================+======================||   0  Tesla V100-DGXS...  On   | 00000000:07:00.0 Off |                    0 || N/A   65C    P0   286W / 300W |  31558MiB / 32478MiB |     97%      Default |+-------------------------------+----------------------+----------------------+|   1  Tesla V100-DGXS...  On   | 00000000:08:00.0 Off |                    0 || N/A   61C    P0   228W / 300W |   2630MiB / 32478MiB |     94%      Default |+-------------------------------+----------------------+----------------------+|   2  Tesla V100-DGXS...  On   | 00000000:0E:00.0 Off |                    0 || N/A   63C    P0   238W / 300W |   5264MiB / 32478MiB |     98%      Default |+-------------------------------+----------------------+----------------------+|   3  Tesla V100-DGXS...  On   | 00000000:0F:00.0 Off |                    0 || N/A   63C    P0   248W / 300W |  14704MiB / 32478MiB |     96%      Default |+-------------------------------+----------------------+----------------------++-----------------------------------------------------------------------------+| Processes:                                                       GPU Memory ||  GPU       PID   Type   Process name                             Usage      ||=============================================================================|+-----------------------------------------------------------------------------+</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># using gpu:/2</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.environ[<span class="string">&quot;CUDA_VISIBLE_DEVICES&quot;</span>] = <span class="string">&quot;2&quot;</span></span><br><span class="line"></span><br><span class="line">gpus = tf.config.experimental.list_physical_devices(<span class="string">&#x27;GPU&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> gpus:</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    tf.config.experimental.set_memory_growth(gpus[<span class="number">0</span>], <span class="literal">True</span>)</span><br><span class="line">  <span class="keyword">except</span> RuntimeError <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br></pre></td></tr></table></figure><h1 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> keras.applications <span class="keyword">import</span> VGG16</span><br><span class="line"><span class="keyword">from</span> keras <span class="keyword">import</span> layers</span><br><span class="line"><span class="keyword">from</span> keras <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> keras.applications.vgg16 <span class="keyword">import</span> preprocess_input, decode_predictions</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> keras.preprocessing <span class="keyword">import</span> image</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> keras <span class="keyword">import</span> backend <span class="keyword">as</span> K</span><br><span class="line"><span class="keyword">import</span> cv2</span><br></pre></td></tr></table></figure><h1 id="Using-VGG16-for-Grad-CAM"><a href="#Using-VGG16-for-Grad-CAM" class="headerlink" title="Using VGG16 for Grad-CAM"></a>Using VGG16 for Grad-CAM</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model = tf.keras.applications.vgg16.VGG16()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.summary()</span><br></pre></td></tr></table></figure><pre><code>Model: &quot;vgg16&quot;_________________________________________________________________Layer (type)                 Output Shape              Param #=================================================================input_1 (InputLayer)         [(None, 224, 224, 3)]     0_________________________________________________________________block1_conv1 (Conv2D)        (None, 224, 224, 64)      1792_________________________________________________________________block1_conv2 (Conv2D)        (None, 224, 224, 64)      36928_________________________________________________________________block1_pool (MaxPooling2D)   (None, 112, 112, 64)      0_________________________________________________________________block2_conv1 (Conv2D)        (None, 112, 112, 128)     73856_________________________________________________________________block2_conv2 (Conv2D)        (None, 112, 112, 128)     147584_________________________________________________________________block2_pool (MaxPooling2D)   (None, 56, 56, 128)       0_________________________________________________________________block3_conv1 (Conv2D)        (None, 56, 56, 256)       295168_________________________________________________________________block3_conv2 (Conv2D)        (None, 56, 56, 256)       590080_________________________________________________________________block3_conv3 (Conv2D)        (None, 56, 56, 256)       590080_________________________________________________________________block3_pool (MaxPooling2D)   (None, 28, 28, 256)       0_________________________________________________________________block4_conv1 (Conv2D)        (None, 28, 28, 512)       1180160_________________________________________________________________block4_conv2 (Conv2D)        (None, 28, 28, 512)       2359808_________________________________________________________________block4_conv3 (Conv2D)        (None, 28, 28, 512)       2359808_________________________________________________________________block4_pool (MaxPooling2D)   (None, 14, 14, 512)       0_________________________________________________________________block5_conv1 (Conv2D)        (None, 14, 14, 512)       2359808_________________________________________________________________block5_conv2 (Conv2D)        (None, 14, 14, 512)       2359808_________________________________________________________________block5_conv3 (Conv2D)        (None, 14, 14, 512)       2359808_________________________________________________________________block5_pool (MaxPooling2D)   (None, 7, 7, 512)         0_________________________________________________________________flatten (Flatten)            (None, 25088)             0_________________________________________________________________fc1 (Dense)                  (None, 4096)              102764544_________________________________________________________________fc2 (Dense)                  (None, 4096)              16781312_________________________________________________________________predictions (Dense)          (None, 1000)              4097000=================================================================Total params: 138,357,544Trainable params: 138,357,544Non-trainable params: 0_________________________________________________________________</code></pre><h1 id="Preprocess-the-image"><a href="#Preprocess-the-image" class="headerlink" title="Preprocess the image"></a>Preprocess the image</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">img_path = <span class="string">&#x27;../sungjin/dog/test/bo/bo_26.jpg&#x27;</span></span><br><span class="line">img = image.load_img(img_path,target_size=(<span class="number">224</span>,<span class="number">224</span>))</span><br><span class="line">x = image.img_to_array(img)</span><br><span class="line">x = np.expand_dims(x,axis=<span class="number">0</span>)</span><br><span class="line">x = preprocess_input(x)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.imshow(img)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.image.AxesImage at 0x7f7a885bc520&gt;</code></pre><p><img src="/image/output_10_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">preds = model.predict(x)</span><br><span class="line">print(preds.shape)</span><br><span class="line">print(<span class="string">&#x27;Predicted:&#x27;</span>,decode_predictions(preds,top=<span class="number">3</span>)[<span class="number">0</span>])</span><br><span class="line">print(np.argmax(preds[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure><pre><code>(1, 1000)Predicted: [(&#39;n02113799&#39;, &#39;standard_poodle&#39;, 0.21771519), (&#39;n02111277&#39;, &#39;Newfoundland&#39;, 0.19664182), (&#39;n02097130&#39;, &#39;giant_schnauzer&#39;, 0.16597004)]267</code></pre><h1 id="About-equation"><a href="#About-equation" class="headerlink" title="About equation"></a>About equation</h1><br><h2 id="Grad-CAM"><a href="#Grad-CAM" class="headerlink" title="Grad-CAM"></a>Grad-CAM</h2><br><p> For each class c in the CNN, Grad−CAM is calculated with a linear combination of the k-th feature maps of the convolutional layer $A_k$ and the importance weight αc<br>K, followed by ReLU activation:</p><br><p align = center><img src ="/image/10.jpg"></p><p align = center><img src = "/image/20.jpg"</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># layer which calculate `score class`</span></span><br><span class="line">conv_layer = model.get_layer(<span class="string">&quot;block5_conv3&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heatmap_model = models.Model([model.inputs],[conv_layer.output,model.output])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.GradientTape() <span class="keyword">as</span> gtape:</span><br><span class="line">    conv_output, predictions = heatmap_model(x) <span class="comment"># y^c, c</span></span><br><span class="line">    loss = predictions[:, np.argmax(predictions[<span class="number">0</span>])] <span class="comment"># probability</span></span><br><span class="line">    grads = gtape.gradient(loss, conv_output) <span class="comment"># partial-derivative</span></span><br><span class="line">    pooled_grads = K.mean(grads, axis=(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>)) <span class="comment"># a_k^c , weight</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">heatmap = tf.reduce_mean(tf.multiply(pooled_grads, conv_output), axis=-<span class="number">1</span>) <span class="comment"># summation weight * filter</span></span><br><span class="line">heatmap = np.maximum(heatmap, <span class="number">0</span>) <span class="comment"># ReLu</span></span><br><span class="line">max_heat = np.<span class="built_in">max</span>(heatmap) <span class="comment"># normalization</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> max_heat == <span class="number">0</span>:</span><br><span class="line">    max_heat = <span class="number">1e-10</span></span><br><span class="line">heatmap /= max_heat</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.matshow(heatmap[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.image.AxesImage at 0x7f7c992031c0&gt;</code></pre><p><img src="/image/output_17_1.png" alt="png"></p><h1 id="Visualize-Grad-CAM"><a href="#Visualize-Grad-CAM" class="headerlink" title="Visualize Grad-CAM"></a>Visualize Grad-CAM</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># img = mpimg.imread(img_path)</span></span><br><span class="line">img = cv2.imread(img_path)</span><br><span class="line">hm = heatmap[<span class="number">0</span>]</span><br><span class="line">hm = cv2.resize(hm, (img.shape[<span class="number">1</span>],img.shape[<span class="number">0</span>]))</span><br><span class="line">hm = np.uint8(<span class="number">255</span>*hm)</span><br><span class="line">hm = cv2.applyColorMap(hm,cv2.COLORMAP_JET)</span><br><span class="line">superimposed_img = hm * <span class="number">0.8</span> + img</span><br><span class="line"></span><br><span class="line">superimposed_img[superimposed_img &gt; <span class="number">255</span>] = <span class="number">255</span></span><br><span class="line">superimposed_img = superimposed_img.astype(<span class="string">&#x27;uint8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.imshow(superimposed_img)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.image.AxesImage at 0x7f7c991e5f70&gt;</code></pre><p><img src="/image/output_19_1.png" alt="png"></p><h1 id="Return-the-resources"><a href="#Return-the-resources" class="headerlink" title="Return the resources"></a>Return the resources</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> IPython</span><br><span class="line">app = IPython.Application.instance()</span><br><span class="line">app.kernel.do_shutdown(<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><pre><code>&#123;&#39;status&#39;: &#39;ok&#39;, &#39;restart&#39;: True&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> AAIS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AAIS </tag>
            
            <tag> keras </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Java] Day05 - 클래스</title>
      <link href="2021/01/30/java-day5/"/>
      <url>2021/01/30/java-day5/</url>
      
        <content type="html"><![CDATA[<h1 id="Day05-클래스"><a href="#Day05-클래스" class="headerlink" title="Day05 클래스"></a>Day05 클래스</h1><hr><h2 id="Before-Start"><a href="#Before-Start" class="headerlink" title="Before Start"></a>Before Start</h2><hr><p>시작하기에 앞서 8주차 인터페이스까지는 성의가 없을(?) 것이다. C++와 비슷한 점이 많을 뿐더러 개념을 다루기에는 시간관리능력이 부족하다. 따라서, 개념을 알고싶은 분들은 각각의 개념을 잘 소개한 글을 링크할테니 참고하면 좋을 것이다.</p><h2 id="Review-Day04"><a href="#Review-Day04" class="headerlink" title="Review Day04"></a>Review Day04</h2><hr><blockquote><p>Q1. queue를 LinkedList 구조체로 사용했을 때, offer, add / poll,remove / peek,element의 차이는?</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">boolean</span> offer = queue.offer(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">boolean</span> add = queue.add(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>각각 첫번째는 예외를 던지지 않고 두번째는 예외를 던지는 것이다. 중요한 것은 일관성(consistency)이 있게 예외를 던질 것이라면 다 던지고 아니면 다 던지지 말아야하는 것이다.<br>같은 기능을 가지지만 하나는 null값을, 하나는 에러가 나는것이다. 예시로 들면, peek은 아무것도 없을 때는 null값을 주지만 element는 아무것도 없는데 무엇을 보려는 것이냐는 에러를 던지게 되는 것이다.</p><h2 id="Day05-클래스-1"><a href="#Day05-클래스-1" class="headerlink" title="Day05. 클래스"></a>Day05. 클래스</h2><h3 id="클래스란"><a href="#클래스란" class="headerlink" title="클래스란?"></a>클래스란?</h3><p>클래스를 이해하는데 <a href="https://k3068.tistory.com/29">이 글</a>을 참조하면 좋을 것이다. 나는 “Java의 정석”이라는 책을 통해 따로 공부하고 있는데 블로그 포스팅을 하기에는 벌려 놓은 일이 너무 많다. 따라서 생략하도록 하겠다.<br>클래스 정의하는 방법, 객체 만드는 방법 (new 키워드 이해하기), 메소드 정의하는 방법, 생성자 정의하는 방법,this 키워드 이해하기는 SKIP..</p><h3 id="이진트리-Binary-Tree"><a href="#이진트리-Binary-Tree" class="headerlink" title="이진트리(Binary Tree)"></a>이진트리(Binary Tree)</h3><p>int 값을 가지고 있는 이진 트리를 나타내는 Node 라는 클래스를 정의하세요.<br>int value, Node left, right를 가지고 있어야 합니다.<br>BinrayTree라는 클래스를 정의하고 주어진 노드를 기준으로 출력하는 bfs(Node node)와 dfs(Node node) 메소드를 구현하세요.<br>DFS는 왼쪽, 루트, 오른쪽 순으로 순회하세요.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.Queue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BinarySearchTree</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Node left;</span><br><span class="line">        <span class="keyword">private</span> Node right;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> value;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(<span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.value = value;</span><br><span class="line">            <span class="keyword">this</span>.left = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">this</span>.right = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Define Getter</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Node <span class="title">getLeft</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> left;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Node <span class="title">getRight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> right;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Define Setter</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLeft</span><span class="params">(Node left)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.left = left;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRight</span><span class="params">(Node right)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.right = right;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setValue</span><span class="params">(<span class="keyword">int</span> value)</span></span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Node root;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BinarySearchTree</span><span class="params">(Node root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.root = root;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Node <span class="title">getRoot</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">BFS</span><span class="params">(Node root)</span> </span>&#123;</span><br><span class="line">        Queue&lt;Node&gt; que = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">        que.offer(root);</span><br><span class="line">        <span class="keyword">while</span>(!que.isEmpty()) &#123;</span><br><span class="line">            Node node = que.poll();</span><br><span class="line">            System.out.print(node.getValue()+<span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(node.getLeft() != <span class="keyword">null</span>)</span><br><span class="line">                que.offer(node.getLeft());</span><br><span class="line">            <span class="keyword">if</span>(node.getRight() != <span class="keyword">null</span>)</span><br><span class="line">                que.offer(node.getRight());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Inorder</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DFS</span><span class="params">(Node root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        DFS(root.getLeft());</span><br><span class="line">        System.out.print(root.getValue()+<span class="string">&quot; &quot;</span>);</span><br><span class="line">        DFS(root.getRight());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AAIS] E05. Transfer Learning - 2</title>
      <link href="2021/01/29/aais-05/"/>
      <url>2021/01/29/aais-05/</url>
      
        <content type="html"><![CDATA[<h1 id="Again-CNN"><a href="#Again-CNN" class="headerlink" title="Again CNN.."></a>Again CNN..</h1><h2 id="Review-the-report"><a href="#Review-the-report" class="headerlink" title="Review the report"></a>Review the report</h2><hr><p>지난 포스트에서 <code>transfer learning</code>을 이용하여 학습을 시켜보았는데<br>이번시간에는 <code>transfer learning</code>을 써야하는 이유에 대해서 다룬 논문을 리뷰해보겠습니다.</p><h3 id="ABSTRACT"><a href="#ABSTRACT" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h3><p>transfer learning이란 간단히 말해 기존의 네트워크를 가져와서 미세조정(fine-tuning)하여 새로운 problem solution을 찾는 것이다.</p><p>그러나, 기존의(source, original)네트워크가 타겟(target)네트워크가 dissimilar하다면 당연히 도움이 안될 것이라 생각한다.<br>예를 들자면 ImageNet의 데이터들은 Caltech101이나 Pascal VOC의 데이터들과 similer하니까 학습하는 것이 비슷할 것이므로 <code>transfer learning</code>이 좋은 결과를 얻을 것이라고 누구나 예상할 수 있다.<br>그러나, ImageNet과 DAGM 데이터들은 PCA를 통해 distribution을 보면 확연히 다른 데이터들이므로 기존의 네트워크의 학습방법은 쓸모가 없을 것이라 생각한다.<br>하지만 실제로 <code>transfer learning</code>을 진행해본 결과 from-scratch로 학습한 네트워크보다 훨씬 좋은 효율(accuracy, # of parameters)을 가진다는 것이다.</p><br><p><img src="/image/fig1.jpg" alt="fig1"></p><br><h2 id="Why-Transfer-Learning"><a href="#Why-Transfer-Learning" class="headerlink" title="Why Transfer Learning?"></a>Why Transfer Learning?</h2><h3 id="Comparison-of-classification-accuracy-and-training-convergence-time-of-teacher-networks"><a href="#Comparison-of-classification-accuracy-and-training-convergence-time-of-teacher-networks" class="headerlink" title="Comparison of classification accuracy and training convergence time of teacher networks"></a>Comparison of classification accuracy and training convergence time of teacher networks</h3><hr><br><p><img src="/image/table2.jpg" alt="table2"></p><br><p>위의 표를 보면 결론적으로 data augmentation을 적용시킨 from-scratch 네트워크(99.55)도 transfer learning을 적용시킨 네트워크(99.90%)처럼 높은 정확도를 보여주고 있습니다. 하지만 Convergence Time을 보게 되면 약 1300배가량 더 많은 시간을 들여야 하는 것을 알 수 있습니다.</p>]]></content>
      
      
      <categories>
          
          <category> AAIS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AAIS </tag>
            
            <tag> keras </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AAIS] E04. Transfer Learning - 1</title>
      <link href="2021/01/27/aais-04/"/>
      <url>2021/01/27/aais-04/</url>
      
        <content type="html"><![CDATA[<h1 id="Transfer-Learning"><a href="#Transfer-Learning" class="headerlink" title="Transfer Learning"></a>Transfer Learning</h1><br><h2 id="About-VGG16"><a href="#About-VGG16" class="headerlink" title="About VGG16"></a>About VGG16</h2><hr><p><a href="https://analysisbugs.tistory.com/65?category=839091">https://analysisbugs.tistory.com/65?category=839091</a><br><br><a href="https://bskyvision.com/504">https://bskyvision.com/504</a><br><br><a href="https://medium.com/@msmapark2/vgg16-%EB%85%BC%EB%AC%B8-%EB%A6%AC%EB%B7%B0-very-deep-convolutional-networks-for-large-scale-image-recognition-6f748235242a">https://medium.com/@msmapark2/vgg16-%EB%85%BC%EB%AC%B8-%EB%A6%AC%EB%B7%B0-very-deep-convolutional-networks-for-large-scale-image-recognition-6f748235242a</a></p><p>이전의 모델들은 대부분 7x7 filter, 11x11 filter를 사용하였으나 이부분부터 3x3 filter를 사용하였습니다.</p><p>예시로 10x10을 7x7 filter를 통과시키면 feature map이 4x4가 만들어지는데 필요한 파라미터 수는 7x7 = 49이고<br>10x10모델을 3x3 filter를 한번통과시키면 8x8 map &gt; 두번통과시키면 6x6 map &gt; 세번통과시키면 4x4 featur map이 만들어지는데 필요한 파라미터수는 3x3x3 = 27로 크게 줄어듭니다.<br><br><br><br></p><blockquote><p>Q.이렇게 할 경우 왜 좋은가? : 3x3일경우 패딩이 1이라서 경계선의 추론이 더 쉬워진다?  + relu를 세번통과하기 때문에 <strong>비 선형성이 증가하게 된다.</strong></p></blockquote><br><br><hr><h2 id="transfer-learning"><a href="#transfer-learning" class="headerlink" title="transfer learning"></a>transfer learning</h2><ol><li>모델을 가져와서 ‘include_top=False’를 통해 분류층(classification)을 삭제시킨다.</li><li>‘model.trainable = False’로 설정시켜서 동결(freezing)을 시킨다.</li><li>global_average_pooling과 dense layer를 쌓은 후 컴파일한다.</li><li>ImageDataGenerator를 통해 적은량의 데이터를 data augmentation을 진행시킨 후 학습시킨다.</li><li>‘model.trainable = True’로 설정시켜서 동결을 해제한다.</li><li>learning_rate을 매우 낮게 설정하여 fine-tuning하기</li></ol><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!nvidia-smi</span><br></pre></td></tr></table></figure><pre><code>Mon Jan 25 13:30:28 2021+-----------------------------------------------------------------------------+| NVIDIA-SMI 410.104      Driver Version: 410.104      CUDA Version: 10.1     ||-------------------------------+----------------------+----------------------+| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC || Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. ||===============================+======================+======================||   0  Tesla V100-DGXS...  On   | 00000000:07:00.0 Off |                    0 || N/A   41C    P0    49W / 300W |    947MiB / 32478MiB |      0%      Default |+-------------------------------+----------------------+----------------------+|   1  Tesla V100-DGXS...  On   | 00000000:08:00.0 Off |                    0 || N/A   39C    P0    40W / 300W |     12MiB / 32478MiB |      0%      Default |+-------------------------------+----------------------+----------------------+|   2  Tesla V100-DGXS...  On   | 00000000:0E:00.0 Off |                    0 || N/A   40C    P0    52W / 300W |   5134MiB / 32478MiB |      0%      Default |+-------------------------------+----------------------+----------------------+|   3  Tesla V100-DGXS...  On   | 00000000:0F:00.0 Off |                    0 || N/A   39C    P0    38W / 300W |     38MiB / 32478MiB |      0%      Default |+-------------------------------+----------------------+----------------------++-----------------------------------------------------------------------------+| Processes:                                                       GPU Memory ||  GPU       PID   Type   Process name                             Usage      ||=============================================================================|+-----------------------------------------------------------------------------+</code></pre><hr><h3 id="1-classification층을-삭제"><a href="#1-classification층을-삭제" class="headerlink" title="1. classification층을 삭제"></a>1. classification층을 삭제</h3><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keras.application.VGG16(weights,input_shape,include_top)</span><br></pre></td></tr></table></figure><p><code>include_top</code>은 최상단 Layer인 fully connected layer를 포함시키는지 여부를 전달시키는 것으로 pre-trained된 것을 새롭게 prediction하기위해 이 layer는 제거시켜줍니다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"></span><br><span class="line">base_model = keras.applications.VGG16(</span><br><span class="line">    weights=<span class="string">&#x27;imagenet&#x27;</span>,  <span class="comment"># Load weights pre-trained on ImageNet.</span></span><br><span class="line">    input_shape=(<span class="number">224</span>, <span class="number">224</span>, <span class="number">3</span>),</span><br><span class="line">    include_top=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base_model.summary()</span><br></pre></td></tr></table></figure><pre><code>Model: &quot;vgg16&quot;_________________________________________________________________Layer (type)                 Output Shape              Param #=================================================================input_1 (InputLayer)         [(None, 224, 224, 3)]     0_________________________________________________________________block1_conv1 (Conv2D)        (None, 224, 224, 64)      1792_________________________________________________________________block1_conv2 (Conv2D)        (None, 224, 224, 64)      36928_________________________________________________________________block1_pool (MaxPooling2D)   (None, 112, 112, 64)      0_________________________________________________________________block2_conv1 (Conv2D)        (None, 112, 112, 128)     73856_________________________________________________________________block2_conv2 (Conv2D)        (None, 112, 112, 128)     147584_________________________________________________________________block2_pool (MaxPooling2D)   (None, 56, 56, 128)       0_________________________________________________________________block3_conv1 (Conv2D)        (None, 56, 56, 256)       295168_________________________________________________________________block3_conv2 (Conv2D)        (None, 56, 56, 256)       590080_________________________________________________________________block3_conv3 (Conv2D)        (None, 56, 56, 256)       590080_________________________________________________________________block3_pool (MaxPooling2D)   (None, 28, 28, 256)       0_________________________________________________________________block4_conv1 (Conv2D)        (None, 28, 28, 512)       1180160_________________________________________________________________block4_conv2 (Conv2D)        (None, 28, 28, 512)       2359808_________________________________________________________________block4_conv3 (Conv2D)        (None, 28, 28, 512)       2359808_________________________________________________________________block4_pool (MaxPooling2D)   (None, 14, 14, 512)       0_________________________________________________________________block5_conv1 (Conv2D)        (None, 14, 14, 512)       2359808_________________________________________________________________block5_conv2 (Conv2D)        (None, 14, 14, 512)       2359808_________________________________________________________________block5_conv3 (Conv2D)        (None, 14, 14, 512)       2359808_________________________________________________________________block5_pool (MaxPooling2D)   (None, 7, 7, 512)         0=================================================================Total params: 14,714,688Trainable params: 14,714,688Non-trainable params: 0_________________________________________________________________</code></pre><p>이전과 다르게 <code>classification</code> layer이 삭제되었다. (<code>Flatten</code> ~ <code>Dense</code>)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base_model.trainable = <span class="literal">False</span></span><br></pre></td></tr></table></figure><h3 id="2-기존의-네트워크-동결시키기"><a href="#2-기존의-네트워크-동결시키기" class="headerlink" title="2. 기존의 네트워크 동결시키기"></a>2. 기존의 네트워크 동결시키기</h3><p><code>trainable</code>옵션을 False로 하여 새로운 학습을 할 때에 기존의 학습된 네트워크가 같이 학습되지 않도록 합니다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">inputs = keras.Input(shape=(<span class="number">224</span>, <span class="number">224</span>, <span class="number">3</span>))</span><br><span class="line"><span class="comment"># Separately from setting trainable on the model, we set training to False</span></span><br><span class="line">x = base_model(inputs, training=<span class="literal">False</span>)</span><br><span class="line">x = keras.layers.GlobalAveragePooling2D()(x)</span><br><span class="line"><span class="comment"># A Dense classifier with a single unit (binary classification)</span></span><br><span class="line">outputs = keras.layers.Dense(<span class="number">1</span>)(x)</span><br><span class="line">model = keras.Model(inputs, outputs)</span><br><span class="line">model.summary()</span><br></pre></td></tr></table></figure><pre><code>Model: &quot;model&quot;_________________________________________________________________Layer (type)                 Output Shape              Param #=================================================================input_2 (InputLayer)         [(None, 224, 224, 3)]     0_________________________________________________________________vgg16 (Model)                (None, 7, 7, 512)         14714688_________________________________________________________________global_average_pooling2d (Gl (None, 512)               0_________________________________________________________________dense (Dense)                (None, 1)                 513=================================================================Total params: 14,715,201Trainable params: 513Non-trainable params: 14,714,688_________________________________________________________________</code></pre><h4 id="about-layer"><a href="#about-layer" class="headerlink" title="about layer"></a>about layer</h4><ol><li>GlobalAveragePooing2D</li></ol><ul><li>기존의 fully convolutional Network는 많은 parameter수와 계산이 오래걸리고, 위치의 정보가 모두 사라지는 단점이 있습니다.</li><li>같은 chennel의 feature들의 평균을 내어 채널의 개수만큼 원소를 가지는 벡터를 출력 (이경우에는 입력 층이 (7,7,512)이므로 (512,)를 출력시키는 layer)</li><li>fully connected layer를 없애기 위한 방법</li><li><a href="https://github.com/tensorflow/tensorflow/blob/r1.4/tensorflow/python/keras/_impl/keras/layers/pooling.py">코드</a></li></ul><ol start="2"><li>Dense(1)</li></ol><ul><li>binary로 클래스를 분류할 것이기 때문에 0과 1로 classification</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Important to use binary crossentropy and binary accuracy as we now have a binary classification problem</span></span><br><span class="line">model.<span class="built_in">compile</span>(loss=keras.losses.BinaryCrossentropy(from_logits=<span class="literal">True</span>), metrics=[keras.metrics.BinaryAccuracy()])</span><br></pre></td></tr></table></figure><h3 id="before-data-augmentation"><a href="#before-data-augmentation" class="headerlink" title="before data augmentation"></a>before data augmentation</h3><hr><p><img src="/image/check.jpg" alt="check"></p><p>위 그림과같이 <code>ImageDataGenerator.flow_from_directory</code>를 사용할 때에 hidden folder가 있는지 확인해야합니다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dog</span><br><span class="line">        test</span><br><span class="line">                bo</span><br><span class="line">                not_bo</span><br><span class="line">        train</span><br><span class="line">                bo</span><br><span class="line">                not_bo</span><br></pre></td></tr></table></figure><p>위와 같이 directory별로 class를 구분하기 때문에 <code>.ipynb_checkpoints</code>폴더를 삭제해야합니다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.preprocessing.image <span class="keyword">import</span> ImageDataGenerator</span><br><span class="line"><span class="comment"># create a data generator</span></span><br><span class="line">datagen = ImageDataGenerator(</span><br><span class="line">        samplewise_center=<span class="literal">True</span>,  <span class="comment"># set each sample mean to 0</span></span><br><span class="line">        rotation_range=<span class="number">10</span>,  <span class="comment"># randomly rotate images in the range (degrees, 0 to 180)</span></span><br><span class="line">        zoom_range = <span class="number">0.1</span>, <span class="comment"># Randomly zoom image</span></span><br><span class="line">        width_shift_range=<span class="number">0.1</span>,  <span class="comment"># randomly shift images horizontally (fraction of total width)</span></span><br><span class="line">        height_shift_range=<span class="number">0.1</span>,  <span class="comment"># randomly shift images vertically (fraction of total height)</span></span><br><span class="line">        horizontal_flip=<span class="literal">True</span>,  <span class="comment"># randomly flip images</span></span><br><span class="line">        vertical_flip=<span class="literal">False</span>) <span class="comment"># we don&#x27;t expect Bo to be upside-down so we will not flip vertically</span></span><br></pre></td></tr></table></figure><h2 id="data-augmentation"><a href="#data-augmentation" class="headerlink" title="data augmentation"></a>data augmentation</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># load and iterate training dataset</span></span><br><span class="line"></span><br><span class="line">seed = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">train_it = datagen.flow_from_directory(<span class="string">&#x27;../sungjin/dog/train/&#x27;</span>,</span><br><span class="line"><span class="comment">#                                        save_to_dir=&#x27;../sungjin/dog2/train/&#x27;, //2700여개의 파일이 생성됨</span></span><br><span class="line">                                       seed = seed,</span><br><span class="line">                                       target_size=(<span class="number">224</span>, <span class="number">224</span>),</span><br><span class="line">                                       color_mode=<span class="string">&#x27;rgb&#x27;</span>,</span><br><span class="line">                                       class_mode=<span class="string">&#x27;binary&#x27;</span>,</span><br><span class="line">                                       batch_size=<span class="number">8</span>)</span><br><span class="line"><span class="comment"># load and iterate test dataset</span></span><br><span class="line">test_it = datagen.flow_from_directory(<span class="string">&#x27;../sungjin/dog/test/&#x27;</span>,</span><br><span class="line"><span class="comment">#                                       save_to_dir=&#x27;../sungjin/dog2/test/&#x27;, // 1600여개의 파일이 생성됨</span></span><br><span class="line">                                      seed = seed,</span><br><span class="line">                                      target_size=(<span class="number">224</span>, <span class="number">224</span>),</span><br><span class="line">                                      color_mode=<span class="string">&#x27;rgb&#x27;</span>,</span><br><span class="line">                                      class_mode=<span class="string">&#x27;binary&#x27;</span>,</span><br><span class="line">                                      batch_size=<span class="number">8</span>)</span><br></pre></td></tr></table></figure><pre><code>Found 139 images belonging to 2 classes.Found 20 images belonging to 2 classes.</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">history = model.fit(train_it, steps_per_epoch=<span class="number">12</span>, validation_data=test_it, validation_steps=<span class="number">4</span>, epochs=<span class="number">20</span>)</span><br></pre></td></tr></table></figure><pre><code>Epoch 1/2012/12 [==============================] - 3s 225ms/step - loss: 1.4831 - binary_accuracy: 0.6562 - val_loss: 3.5233 - val_binary_accuracy: 0.5357Epoch 2/2012/12 [==============================] - 2s 178ms/step - loss: 1.1998 - binary_accuracy: 0.7473 - val_loss: 1.9760 - val_binary_accuracy: 0.6667Epoch 3/2012/12 [==============================] - 2s 161ms/step - loss: 0.4746 - binary_accuracy: 0.8462 - val_loss: 1.3999 - val_binary_accuracy: 0.7143Epoch 4/2012/12 [==============================] - 2s 172ms/step - loss: 0.3132 - binary_accuracy: 0.8646 - val_loss: 1.0363 - val_binary_accuracy: 0.7857Epoch 5/2012/12 [==============================] - 2s 175ms/step - loss: 0.2785 - binary_accuracy: 0.9011 - val_loss: 1.0750 - val_binary_accuracy: 0.7917Epoch 6/2012/12 [==============================] - 2s 178ms/step - loss: 0.0651 - binary_accuracy: 0.9670 - val_loss: 1.3541 - val_binary_accuracy: 0.7143Epoch 7/2012/12 [==============================] - 2s 198ms/step - loss: 0.1798 - binary_accuracy: 0.9167 - val_loss: 0.9755 - val_binary_accuracy: 0.8214Epoch 8/2012/12 [==============================] - 2s 166ms/step - loss: 0.0315 - binary_accuracy: 0.9890 - val_loss: 0.5196 - val_binary_accuracy: 0.9167Epoch 9/2012/12 [==============================] - 2s 179ms/step - loss: 0.0822 - binary_accuracy: 0.9341 - val_loss: 0.3601 - val_binary_accuracy: 0.8929Epoch 10/2012/12 [==============================] - 2s 181ms/step - loss: 0.0169 - binary_accuracy: 0.9896 - val_loss: 0.3563 - val_binary_accuracy: 0.9286Epoch 11/2012/12 [==============================] - 2s 191ms/step - loss: 0.0437 - binary_accuracy: 0.9890 - val_loss: 0.4602 - val_binary_accuracy: 0.8333Epoch 12/2012/12 [==============================] - 2s 158ms/step - loss: 0.0405 - binary_accuracy: 0.9890 - val_loss: 0.2497 - val_binary_accuracy: 0.8929Epoch 13/2012/12 [==============================] - 2s 191ms/step - loss: 0.0083 - binary_accuracy: 1.0000 - val_loss: 0.4642 - val_binary_accuracy: 0.8571Epoch 14/2012/12 [==============================] - 2s 163ms/step - loss: 0.0133 - binary_accuracy: 0.9890 - val_loss: 0.2259 - val_binary_accuracy: 0.9167Epoch 15/2012/12 [==============================] - 2s 178ms/step - loss: 0.0050 - binary_accuracy: 1.0000 - val_loss: 0.2705 - val_binary_accuracy: 0.8929Epoch 16/2012/12 [==============================] - 2s 185ms/step - loss: 0.0027 - binary_accuracy: 1.0000 - val_loss: 0.2617 - val_binary_accuracy: 0.8929Epoch 17/2012/12 [==============================] - 2s 179ms/step - loss: 0.0203 - binary_accuracy: 0.9890 - val_loss: 0.1751 - val_binary_accuracy: 0.9583Epoch 18/2012/12 [==============================] - 2s 173ms/step - loss: 0.0055 - binary_accuracy: 1.0000 - val_loss: 0.0705 - val_binary_accuracy: 1.0000Epoch 19/2012/12 [==============================] - 2s 199ms/step - loss: 0.0015 - binary_accuracy: 1.0000 - val_loss: 0.0275 - val_binary_accuracy: 1.0000Epoch 20/2012/12 [==============================] - 2s 189ms/step - loss: 0.0056 - binary_accuracy: 1.0000 - val_loss: 0.1403 - val_binary_accuracy: 0.9583</code></pre><h2 id="기존의-네트워크-동결-해제-및-fine-tuning"><a href="#기존의-네트워크-동결-해제-및-fine-tuning" class="headerlink" title="기존의 네트워크 동결 해제 및 fine-tuning"></a>기존의 네트워크 동결 해제 및 fine-tuning</h2><p>새롭게 컴파일할 때 기존의 네트워크를 unfreezing하여 fine-tuning(미세조정)한다. <br><br>단, 이때 다음과 같은 세가지의 전략이 있다.</p><p align = "center"><img src = "https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FH4rr7%2FbtqvBNchX4H%2FRmikaKBNm2N6VYD9JbI800%2Fimg.png", width="700px"></p><hr><ol><li>전체모델을 학습시키기</li></ol><ul><li>이 방법은 pre-trained model의 구조만 사용하고 새로운 데이터셋에 맞게 전부 새로 학습시키는 방법입니다. 큰 사이즈의 데이터셋이 필요합니다.</li></ul><br><ol start="2"><li>일부의 층만 학습시키고 나머지는 동결시키기</li></ol><ul><li>초기 레이어는 추상적인(일반적인)특징을 추출하고 후기 레이어는 구체적이고 특유한 특징을 추출하는데 이런 특성을 이용해서 선택적으로 재학습시킵니다.</li><li>데이터셋이 작고 모델의 파라미터가 많다면 오버피팅이 될 수 있으므로 적은양의 계층을 학습시킵니다.</li><li>데이터셋이 크고 그에 비해 모델의 파라미터가 적다면 오버피팅의 가능성이 적으므로 더 많은 양의 계층을 학습시킵니다.</li></ul><br><ol start="3"><li>전체 동결시키기 (classification만 학습시키기)</li></ol><ul><li>기존의 네트워크는 건들지 않고 그대로 두면서 특징 추출 메커니즘으로써 활용하고, classifier만 재학습시키는 방법을 씁니다.</li><li>데이터셋이 너무 작을때나 새로운 문제가 이전 모델이 이미 학습한 데이터셋과 매우 비슷할 때 사용합니다.</li></ul><hr><p align = "center"><img src = "https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FxjNT2%2FbtqvC7gR5Vw%2FWW1IlF9M9DTCypyNTeC2Wk%2Fimg.png", width= "900px"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Unfreeze the base model</span></span><br><span class="line">base_model.trainable = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># It&#x27;s important to recompile your model after you make any changes</span></span><br><span class="line"><span class="comment"># to the `trainable` attribute of any inner layer, so that your changes</span></span><br><span class="line"><span class="comment"># are taken into account</span></span><br><span class="line">model.<span class="built_in">compile</span>(optimizer = keras.optimizers.Adam(lr = <span class="number">.00001</span>),</span><br><span class="line"><span class="comment">#               optimizer=keras.optimizers.RMSprop(learning_rate = .00001),  # Very low learning rate</span></span><br><span class="line">              loss=keras.losses.BinaryCrossentropy(from_logits=<span class="literal">True</span>),</span><br><span class="line">              metrics=[keras.metrics.BinaryAccuracy()])</span><br></pre></td></tr></table></figure><h3 id="optimizer"><a href="#optimizer" class="headerlink" title="optimizer"></a><a href="%22https://cs231n.github.io/neural-networks-3/#ada%22">optimizer</a></h3><p><img src = "/image/minibatch.jpg", width = "700px"></p><br><p><img src = "/image/optimizer.jpg", width = "700px"></p><p><img src = "https://cs231n.github.io/assets/nn3/opt2.gif",  width="400px"><img src = "https://cs231n.github.io/assets/nn3/opt1.gif", width = "400px"></p><p><a href="%22https://dalpo0814.tistory.com/29%22">reference</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">history = model.fit(train_it, steps_per_epoch=<span class="number">12</span>, validation_data=test_it, validation_steps=<span class="number">4</span>, epochs=<span class="number">20</span>)</span><br></pre></td></tr></table></figure><pre><code>Epoch 1/2012/12 [==============================] - 3s 219ms/step - loss: 0.0849 - binary_accuracy: 0.9670 - val_loss: 0.0158 - val_binary_accuracy: 1.0000Epoch 2/2012/12 [==============================] - 2s 204ms/step - loss: 0.0053 - binary_accuracy: 1.0000 - val_loss: 0.0118 - val_binary_accuracy: 1.0000Epoch 3/2012/12 [==============================] - 2s 176ms/step - loss: 0.0020 - binary_accuracy: 1.0000 - val_loss: 0.0015 - val_binary_accuracy: 1.0000Epoch 4/2012/12 [==============================] - 2s 196ms/step - loss: 1.5012e-04 - binary_accuracy: 1.0000 - val_loss: 0.0154 - val_binary_accuracy: 1.0000Epoch 5/2012/12 [==============================] - 3s 211ms/step - loss: 1.7610e-04 - binary_accuracy: 1.0000 - val_loss: 0.0034 - val_binary_accuracy: 1.0000Epoch 6/2012/12 [==============================] - 2s 198ms/step - loss: 1.0886e-04 - binary_accuracy: 1.0000 - val_loss: 0.0275 - val_binary_accuracy: 1.0000Epoch 7/2012/12 [==============================] - 2s 178ms/step - loss: 2.9665e-05 - binary_accuracy: 1.0000 - val_loss: 0.0093 - val_binary_accuracy: 1.0000Epoch 8/2012/12 [==============================] - 2s 205ms/step - loss: 1.7676e-05 - binary_accuracy: 1.0000 - val_loss: 0.0108 - val_binary_accuracy: 1.0000Epoch 9/2012/12 [==============================] - 2s 182ms/step - loss: 3.1658e-05 - binary_accuracy: 1.0000 - val_loss: 8.7812e-04 - val_binary_accuracy: 1.0000Epoch 10/2012/12 [==============================] - 2s 195ms/step - loss: 3.5808e-05 - binary_accuracy: 1.0000 - val_loss: 0.0020 - val_binary_accuracy: 1.0000Epoch 11/2012/12 [==============================] - 2s 191ms/step - loss: 3.2332e-05 - binary_accuracy: 1.0000 - val_loss: 0.0474 - val_binary_accuracy: 0.9643Epoch 12/2012/12 [==============================] - 2s 202ms/step - loss: 1.3189e-04 - binary_accuracy: 1.0000 - val_loss: 0.0044 - val_binary_accuracy: 1.0000Epoch 13/2012/12 [==============================] - 2s 202ms/step - loss: 1.7362e-04 - binary_accuracy: 1.0000 - val_loss: 0.0073 - val_binary_accuracy: 1.0000Epoch 14/2012/12 [==============================] - 2s 194ms/step - loss: 2.4271e-05 - binary_accuracy: 1.0000 - val_loss: 0.0235 - val_binary_accuracy: 1.0000Epoch 15/2012/12 [==============================] - 3s 219ms/step - loss: 1.0316e-05 - binary_accuracy: 1.0000 - val_loss: 0.0388 - val_binary_accuracy: 1.0000Epoch 16/2012/12 [==============================] - 2s 187ms/step - loss: 2.3622e-05 - binary_accuracy: 1.0000 - val_loss: 0.0031 - val_binary_accuracy: 1.0000Epoch 17/2012/12 [==============================] - 2s 201ms/step - loss: 2.0185e-05 - binary_accuracy: 1.0000 - val_loss: 0.0413 - val_binary_accuracy: 0.9643Epoch 18/2012/12 [==============================] - 2s 175ms/step - loss: 3.8968e-05 - binary_accuracy: 1.0000 - val_loss: 0.0197 - val_binary_accuracy: 1.0000Epoch 19/2012/12 [==============================] - 2s 202ms/step - loss: 9.7374e-06 - binary_accuracy: 1.0000 - val_loss: 0.0902 - val_binary_accuracy: 0.9643Epoch 20/2012/12 [==============================] - 2s 206ms/step - loss: 1.0378e-04 - binary_accuracy: 1.0000 - val_loss: 0.0148 - val_binary_accuracy: 1.0000</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">inputs = keras.Input(shape=(<span class="number">224</span>, <span class="number">224</span>, <span class="number">3</span>))</span><br><span class="line"><span class="comment"># Separately from setting trainable on the model, we set training to False</span></span><br><span class="line">x = base_model(inputs, training=<span class="literal">False</span>)</span><br><span class="line">x = keras.layers.Flatten(input_shape=(<span class="number">7</span>,<span class="number">7</span>,<span class="number">512</span>))(x)</span><br><span class="line"><span class="comment"># x = keras.layers.Dense(256, activation=&#x27;relu&#x27;,input_dim=(7*7*512))(x)</span></span><br><span class="line"><span class="comment"># x = keras.layers.Dropout(0.2)(x)</span></span><br><span class="line">outputs = keras.layers.Dense(<span class="number">1</span>,activation = <span class="string">&#x27;sigmoid&#x27;</span>)(x)</span><br><span class="line">model = keras.Model(inputs, outputs)</span><br><span class="line">model.summary()</span><br></pre></td></tr></table></figure><pre><code>Model: &quot;model&quot;_________________________________________________________________Layer (type)                 Output Shape              Param #=================================================================input_2 (InputLayer)         [(None, 224, 224, 3)]     0_________________________________________________________________vgg16 (Model)                (None, 7, 7, 512)         14714688_________________________________________________________________flatten (Flatten)            (None, 25088)             0_________________________________________________________________dense (Dense)                (None, 1)                 25089=================================================================Total params: 14,739,777Trainable params: 25,089Non-trainable params: 14,714,688_________________________________________________________________</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Important to use binary crossentropy and binary accuracy as we now have a binary classification problem</span></span><br><span class="line">model.<span class="built_in">compile</span>(</span><br><span class="line"><span class="comment">#     optimizer=keras.optimizers.Adam(),</span></span><br><span class="line">              loss=keras.losses.BinaryCrossentropy(from_logits=<span class="literal">True</span>),</span><br><span class="line">              metrics=[keras.metrics.BinaryAccuracy()])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.preprocessing.image <span class="keyword">import</span> ImageDataGenerator</span><br><span class="line"><span class="comment"># create a data generator</span></span><br><span class="line">datagen = ImageDataGenerator(</span><br><span class="line">        samplewise_center=<span class="literal">True</span>,  <span class="comment"># set each sample mean to 0</span></span><br><span class="line">        rotation_range=<span class="number">10</span>,  <span class="comment"># randomly rotate images in the range (degrees, 0 to 180)</span></span><br><span class="line">        zoom_range = <span class="number">0.1</span>, <span class="comment"># Randomly zoom image</span></span><br><span class="line">        width_shift_range=<span class="number">0.1</span>,  <span class="comment"># randomly shift images horizontally (fraction of total width)</span></span><br><span class="line">        height_shift_range=<span class="number">0.1</span>,  <span class="comment"># randomly shift images vertically (fraction of total height)</span></span><br><span class="line">        horizontal_flip=<span class="literal">True</span>,  <span class="comment"># randomly flip images</span></span><br><span class="line">        vertical_flip=<span class="literal">False</span>) <span class="comment"># we don&#x27;t expect Bo to be upside-down so we will not flip vertically</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># load and iterate training dataset</span></span><br><span class="line"></span><br><span class="line">seed = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">train_it = datagen.flow_from_directory(<span class="string">&#x27;../sungjin/dog/train/&#x27;</span>,</span><br><span class="line"><span class="comment">#                                        save_to_dir=&#x27;../sungjin/dog2/train/&#x27;, //2700여개의 파일이 생성됨</span></span><br><span class="line">                                       seed = seed,</span><br><span class="line">                                       target_size=(<span class="number">224</span>, <span class="number">224</span>),</span><br><span class="line">                                       color_mode=<span class="string">&#x27;rgb&#x27;</span>,</span><br><span class="line">                                       class_mode=<span class="string">&#x27;binary&#x27;</span>,</span><br><span class="line">                                       batch_size=<span class="number">8</span>)</span><br><span class="line"><span class="comment"># load and iterate test dataset</span></span><br><span class="line">test_it = datagen.flow_from_directory(<span class="string">&#x27;../sungjin/dog/test/&#x27;</span>,</span><br><span class="line"><span class="comment">#                                       save_to_dir=&#x27;../sungjin/dog2/test/&#x27;, // 1600여개의 파일이 생성됨</span></span><br><span class="line">                                      seed = seed,</span><br><span class="line">                                      target_size=(<span class="number">224</span>, <span class="number">224</span>),</span><br><span class="line">                                      color_mode=<span class="string">&#x27;rgb&#x27;</span>,</span><br><span class="line">                                      class_mode=<span class="string">&#x27;binary&#x27;</span>,</span><br><span class="line">                                      batch_size=<span class="number">8</span>)</span><br></pre></td></tr></table></figure><pre><code>Found 139 images belonging to 2 classes.Found 20 images belonging to 2 classes.</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">history = model.fit(train_it, steps_per_epoch=<span class="number">12</span>, validation_data=test_it, validation_steps=<span class="number">4</span>, epochs=<span class="number">20</span>)</span><br></pre></td></tr></table></figure><pre><code>Epoch 1/2012/12 [==============================] - 3s 243ms/step - loss: 0.4516 - binary_accuracy: 0.8333 - val_loss: 0.8132 - val_binary_accuracy: 0.5000Epoch 2/2012/12 [==============================] - 2s 195ms/step - loss: 0.4823 - binary_accuracy: 0.8352 - val_loss: 0.8549 - val_binary_accuracy: 0.4583Epoch 3/2012/12 [==============================] - 2s 179ms/step - loss: 0.4232 - binary_accuracy: 0.8901 - val_loss: 0.8483 - val_binary_accuracy: 0.4643Epoch 4/2012/12 [==============================] - 2s 202ms/step - loss: 0.4383 - binary_accuracy: 0.8750 - val_loss: 0.8490 - val_binary_accuracy: 0.4643Epoch 5/2012/12 [==============================] - 2s 195ms/step - loss: 0.4781 - binary_accuracy: 0.8352 - val_loss: 0.8133 - val_binary_accuracy: 0.5000Epoch 6/2012/12 [==============================] - 2s 199ms/step - loss: 0.4341 - binary_accuracy: 0.8791 - val_loss: 0.7775 - val_binary_accuracy: 0.5357Epoch 7/2012/12 [==============================] - 2s 204ms/step - loss: 0.4526 - binary_accuracy: 0.8646 - val_loss: 0.7197 - val_binary_accuracy: 0.6071Epoch 8/2012/12 [==============================] - 2s 170ms/step - loss: 0.4012 - binary_accuracy: 0.9121 - val_loss: 0.8549 - val_binary_accuracy: 0.4583Epoch 9/2012/12 [==============================] - 2s 197ms/step - loss: 0.4823 - binary_accuracy: 0.8352 - val_loss: 0.8490 - val_binary_accuracy: 0.4643Epoch 10/2012/12 [==============================] - 2s 201ms/step - loss: 0.4070 - binary_accuracy: 0.9062 - val_loss: 0.8133 - val_binary_accuracy: 0.5000Epoch 11/2012/12 [==============================] - 2s 205ms/step - loss: 0.5111 - binary_accuracy: 0.8022 - val_loss: 0.7716 - val_binary_accuracy: 0.5417Epoch 12/2012/12 [==============================] - 2s 181ms/step - loss: 0.4341 - binary_accuracy: 0.8791 - val_loss: 0.8490 - val_binary_accuracy: 0.4643Epoch 13/2012/12 [==============================] - 3s 216ms/step - loss: 0.4383 - binary_accuracy: 0.8750 - val_loss: 0.8133 - val_binary_accuracy: 0.5000Epoch 14/2012/12 [==============================] - 2s 190ms/step - loss: 0.4451 - binary_accuracy: 0.8681 - val_loss: 0.8133 - val_binary_accuracy: 0.5000Epoch 15/2012/12 [==============================] - 2s 191ms/step - loss: 0.4603 - binary_accuracy: 0.8571 - val_loss: 0.8847 - val_binary_accuracy: 0.4286Epoch 16/2012/12 [==============================] - 2s 202ms/step - loss: 0.4278 - binary_accuracy: 0.8854 - val_loss: 0.8133 - val_binary_accuracy: 0.5000Epoch 17/2012/12 [==============================] - 2s 205ms/step - loss: 0.4451 - binary_accuracy: 0.8681 - val_loss: 0.8549 - val_binary_accuracy: 0.4583Epoch 18/2012/12 [==============================] - 2s 179ms/step - loss: 0.4781 - binary_accuracy: 0.8352 - val_loss: 0.8490 - val_binary_accuracy: 0.4643Epoch 19/2012/12 [==============================] - 2s 207ms/step - loss: 0.4695 - binary_accuracy: 0.8438 - val_loss: 0.7775 - val_binary_accuracy: 0.5357Epoch 20/2012/12 [==============================] - 2s 185ms/step - loss: 0.4232 - binary_accuracy: 0.8901 - val_loss: 0.8549 - val_binary_accuracy: 0.4583</code></pre><h2 id="Global-Average-Pooing-vs-Fully-Convolutional-Network"><a href="#Global-Average-Pooing-vs-Fully-Convolutional-Network" class="headerlink" title="Global Average Pooing vs Fully Convolutional Network"></a><code>Global Average Pooing</code> vs <code>Fully Convolutional Network</code></h2><p><img src = "/image/GAP.jpg", width = "400px"><img src = "/image/fullyConvolution.jpg", width = "400px"></p>]]></content>
      
      
      <categories>
          
          <category> AAIS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AAIS </tag>
            
            <tag> keras </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Java] Day04 - 제어문</title>
      <link href="2021/01/25/java-day4/"/>
      <url>2021/01/25/java-day4/</url>
      
        <content type="html"><![CDATA[<h1 id="Day04-제어문"><a href="#Day04-제어문" class="headerlink" title="Day04 제어문"></a>Day04 제어문</h1><h2 id="Review-Day03"><a href="#Review-Day03" class="headerlink" title="Review Day03"></a>Review Day03</h2><hr><blockquote><p>Q1. <code>mid = (start + end)</code> / 2의 문제점은?</p></blockquote><br><p>만약 <code>int start = 2_100_000_000, int end = 2_100_000_000</code> 이라면 start와 end를 더하면 오버플로우가 일어날 수 있다.<br>따라서 중간값을 구하는 방법은 대체로 <code>mid = start + (end-start) / 2</code>로 한다.<br>한가지 신박한 방법은 java에서 제공하는 <code>&gt;&gt;&gt;</code>연산자인데 양수일 때, <code>mid = (start+end) &gt;&gt;&gt; 1</code>로 한다면 중간값을 구할 수 있다.<br><strong>하지만</strong> 앞선 방법을 사용하는 것이 가장 안전하고 직관적이다.</p><br><blockquote><p>Q2. numbers라는 int형 배열이 있다.<br>해당 배열이 들어있는 숫자들은 오직 한 숫자를 제외하고는 모두 두번씩 들어있다.<br>오직 한 번만 등장하는 숫자를 찾는 코드를 작성하여라.</p></blockquote><br><p>C++의 sstream을 사용하는 방법이 떠올랐지만(Java에도 있다), 선장님께서 비트연산으로 푸는 방법을 알려주셨다.</p><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">Hello hello = <span class="keyword">new</span> Hello();</span><br><span class="line">    <span class="keyword">int</span> result = hello.solution(<span class="keyword">new</span> <span class="keyword">int</span>[] &#123;<span class="number">5</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>&#125;);</span><br><span class="line">    System.out.println(result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">solution</span><span class="params">(<span class="keyword">int</span>[] numbers)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> number : numbers) &#123;</span><br><span class="line">            result ^= number;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br><p>간단하다. 모든 배열안에 있는 것들끼리 XOR연산을 하게 된다면 두개가 존재하지 않는 한개의 원소만 반환하게되기 때문이다. (<code>5 ^ 5 = 0</code>, <code>5 ^ 0 = 5</code>다.)</p><br><h3 id="java13의-switch연산자"><a href="#java13의-switch연산자" class="headerlink" title="java13의 switch연산자"></a>java13의 switch연산자</h3><hr><p>일단 switch operator는 switch statement와 다른 것이다.</p><ol><li>switch statement</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(num)&#123;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">               returnNum = <span class="number">1</span>;</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">               returnNum = <span class="number">2</span>;</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">               returnNum = <span class="number">3</span>;</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure><hr><ol start="2"><li>switch operator</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> value = <span class="keyword">switch</span>(str)&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;hello?&quot;</span>:</span><br><span class="line">    yield <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;hi?&quot;</span>:</span><br><span class="line">    yield <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">    yield <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>직관적으로 어떤의미인지 알 수 있는데, 값을 반환하는 operator이라는 것이다. 앞선방법으로 <code>break</code>을 사용하지 않고 <code>yield</code>로 값을 산출할 수 있다. 또한, <code>var</code>을 사용하여 각각의 경우 다른 변수타입을 반환하는 것 또한 가능하다.</p><br><h2 id="Day04-제어문-1"><a href="#Day04-제어문-1" class="headerlink" title="Day04. 제어문"></a>Day04. 제어문</h2><hr><p>저번시간과 마찬가지로 시간이 없기 때문에.. if, while, 기타 등등 다양한 반복문과 조건문은 생략하도록 하겠다. <a href="https://kils-log-of-develop.tistory.com/349">다음의링크</a>에서 좋은 설명을 볼 수 있을 것이다.</p><h3 id="for-each문"><a href="#for-each문" class="headerlink" title="for each문"></a>for each문</h3><hr><p>for each는 J2SE 5.0 부터 추가되었다. for each 라는 키워드가 따로 있는 것은 아니고 동일한 for를 이용한다. 하지만 조건식 부분이 조금 다르다. 보통 다른 언어에서 for each 라고 많이 하므로 자바에서도 보통 for each문이라고 말한다.</p><br><p><strong>기존의 for문</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String[] numbers = &#123;<span class="string">&quot;one&quot;</span>, <span class="string">&quot;two&quot;</span>, <span class="string">&quot;three&quot;</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;numbers.length; i++)&#123;</span><br><span class="line">    System.out.println(numbers[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><p><strong>for each문</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String[] numbers = &#123;<span class="string">&quot;one&quot;</span>, <span class="string">&quot;two&quot;</span>, <span class="string">&quot;three&quot;</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(String number: numbers) &#123;</span><br><span class="line">    System.out.println(number);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>단, for each문 같은경우에는 index로 iteration하는 것이 아니기 때문에 두개씩 건너뛰는 것이 불가능하다. 상황에 맞추어 사용하면 된다.</p><br><h3 id="LinkedList-구현하기"><a href="#LinkedList-구현하기" class="headerlink" title="LinkedList 구현하기"></a>LinkedList 구현하기</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">makeLinkedList</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">LinkedList</span> </span>&#123;</span><br><span class="line">        <span class="function">ListNode <span class="title">add</span><span class="params">(ListNode head, ListNode nodeToAdd, <span class="keyword">int</span> position)</span></span>;</span><br><span class="line">        <span class="function">ListNode <span class="title">remove</span><span class="params">(ListNode head, <span class="keyword">int</span> positionToRemove)</span></span>;</span><br><span class="line">        <span class="function"><span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(ListNode head, ListNode nodeTocheck)</span></span>;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">printList</span><span class="params">(ListNode head)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ListNode</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> data;</span><br><span class="line">        <span class="keyword">private</span> ListNode next;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ListNode</span><span class="params">(<span class="keyword">int</span> input)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.data = input;</span><br><span class="line">            <span class="keyword">this</span>.next = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedListImpl</span> <span class="keyword">implements</span> <span class="title">LinkedList</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printList</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (head != <span class="keyword">null</span>) &#123;</span><br><span class="line">                System.out.println(head.data);</span><br><span class="line">                head = head.next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">            ListNode node = head;</span><br><span class="line">            <span class="keyword">int</span> size = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (node.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">                node = node.next;</span><br><span class="line">                size++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> size;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ListNode <span class="title">add</span><span class="params">(ListNode head, ListNode nodeToAdd, <span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">            ListNode node = head;</span><br><span class="line">            <span class="keyword">if</span> (position == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (head == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> nodeToAdd;</span><br><span class="line">                &#125;</span><br><span class="line">                ListNode add = nodeToAdd;</span><br><span class="line">                add.next = head;</span><br><span class="line">                head = add;</span><br><span class="line">                <span class="keyword">return</span> head;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; position - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                node = node.next;</span><br><span class="line">            &#125;</span><br><span class="line">            nodeToAdd.next = node.next;</span><br><span class="line">            node.next = nodeToAdd;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(ListNode head, ListNode nodeTocheck)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (head != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (head.data == nodeTocheck.data) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                head = head.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ListNode <span class="title">remove</span><span class="params">(ListNode head, <span class="keyword">int</span> positionToRemove)</span> </span>&#123;</span><br><span class="line">            ListNode node = head;</span><br><span class="line">            <span class="keyword">if</span> (positionToRemove == <span class="number">0</span>) &#123;</span><br><span class="line">                head = head.next;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; positionToRemove - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                    node = node.next;</span><br><span class="line">                &#125;</span><br><span class="line">                ListNode delNode = node.next;</span><br><span class="line">                node.next = node.next.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다른것들도 천천히 구현해보겠다.</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AAIS] E03. Convolution Layer - 2</title>
      <link href="2021/01/21/aais-03/"/>
      <url>2021/01/21/aais-03/</url>
      
        <content type="html"><![CDATA[<h1 id="Agian-CNN"><a href="#Agian-CNN" class="headerlink" title="Agian CNN"></a>Agian CNN</h1><h2 id="Review-the-reports"><a href="#Review-the-reports" class="headerlink" title="Review the reports"></a>Review the reports</h2><h3 id="Tooth-wise-age-group-prediction-with-CNN-model"><a href="#Tooth-wise-age-group-prediction-with-CNN-model" class="headerlink" title="Tooth-wise age-group prediction with CNN model"></a>Tooth-wise age-group prediction with CNN model</h3><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Tooth‑wise age‑group prediction with CNN model. As the frst molar is considered to be the most reliable tooth for estimating dental age, we selected it for developing a CNN model for the age-group determination.</span><br><span class="line">From a panoramic radiograph of each patient, image patches of teeth #16, #26, #36, and #46 were manually extracted. </span><br><span class="line">The goal of extracting image patches from the panoramic radiographs was to include complete contours of the teeth. </span><br><span class="line">As a result, a total of 4,312 image patches of frst molars were collected from 1078 patients for training, and every tooth patch was resized into a fxed size of 151×112. </span><br><span class="line">To minimize any unnecessary variance in the dataset and to improve the performance of the model, the dataset was augmented23, and we used the following selective data augmentation techniques: </span><br><span class="line">the tooth images were fipped lef and right, upside down, rotated, and reversed by 90°.</span><br><span class="line">Te residual deep neural network with 152 layers (ResNet-152) was trained to predict the age-group toothwise, that is, for each tooth.</span><br><span class="line">The weights of the network were initialized using pre-trained weights from ImageNet dataset24. </span><br><span class="line">Ten, the entire network was fne-tuned for the target age-group estimation problem. </span><br><span class="line">Although the ImageNet base dataset does not include teeth images, various studies have shown that the fne-tuning of a pretrained network with several images of ImageNet helps improve the performance in disease-related problem learning using medical images.</span><br><span class="line">The network was trained using the cross-entropy loss function and adaptive moment estimation (Adam) optimizer with a learning rate of 1e-5 and a batch size of 32. </span><br><span class="line">We trained the network for 40,000 iterations and validated it using validation data every 1000 iterations with a classifcation accuracy metric to determine whether to stop the training. </span><br><span class="line">The network showing the highest validation accuracy was selected as the fnal model and used for testing.</span><br></pre></td></tr></table></figure><p>첫번째 큰어금니가 치아 나이를 추론<sup><a href="#footnote_1">1</a></sup><sup><a href="#footnote_2">2</a></sup>하는데 가장 좋으므로, 이를 채택하여 CNN 모델을 생성하였다.<br>각각의 환자의 파노라마사진으로부터 #16, #26, #36, #46번 치아를 추출하였다.</p><p align = "center"><img src="http://postfiles9.naver.net/MjAxNzAzMTBfMTUx/MDAxNDg5MTE2MTY3MDE5.FJwhRPEDicEibFZ9haFXwlkpCUW8IDQkHMGBAKQyK_4g.hWk8acgCVJA2b125bulyofsgNMgk52gU5QDJ73MML2gg.JPEG.onedaydent/image_2923048291489116088889.jpg?type=w966" width = "500px"></p><p>파노라마 이미지로부터 image patch를 추출하는 목표는 완전한 이의 윤곽(contour)를 포함시키는 것이다. 결론적으로, 1078명의 이미지로부터 4,312개의 image patch들을 모았고 모든 image patch는 151 X 112로 사이즈를 리사이징(resize)하였다. 불필요한 데이터셋들을 줄이고 모델의 성능(performance)를 증가시키기위해 데이터셋이 추가<sup><a href="#footnote_3">3</a></sup>되었다.</p><p>ResNet-152<sup><a href="#footnote_3">3</a></sup>(The Residual deep neural network with 152 layers)는 각각의 치아의 age-group을 추정했다. 가중치(The weights of the network)는 ImageNet datet으로부터 이미 훈련된것들로부터 시작되었다. 그 후, 전체 네트워크는 age-group을 추정하기위한 모델로 변형(fine-tuned)되었다. 비록, ImageNetbase dataset은 이(teeth)의 이미지를 포함하지 않지만, 다수의 연구들이 의학이미지(medical image)들을 사용하여 질병에관련된 문제들을 푸는데 성능을 증가시켰다는 것을 보여줬다. ResNet은 <code>cross-entopy loss function</code>과 <code>adaptive moment estimation(Adam) optimizer</code>를 통해 학습되었다. <code>learning rate</code>은 1e-5이며 <code>batch size</code>는 32이다. 또한, 4만번의 반복학습을 하였고 1000회마다 분류(classification)정확도를 측정하였다. 가장 높은 validation accuracy를 보여준 네트워크를 최종모델로 선정하였다.</p><h2 id="ResNet-152"><a href="#ResNet-152" class="headerlink" title="ResNet-152?"></a>ResNet-152?</h2><p>위의 내용에 따르면 ResNet-152라는 것이 나온다. CNN이랑 다른건가?싶어 걱정이 앞섰지만 다행히도 CNN의 한 종류이다.<br><a href="https://arxiv.org/pdf/1512.03385.pdf">Deep Residual Learning for Image Recognition</a>에 따르면 <code>residual learning</code>을 통해 기존의 심층신경망보다 상당히 깊은 신경망에 대해서도 학습을 잘하고 있는 것을 보여준다. 152개의 layer로 구성되어있으며, 전년도 ILSVRC에서 우승한 GoogleLeNet보다 약 두배의 성능이 좋아졌다.</p><br><p align = "center"><img src = "https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fcx1l7G%2FbtqzR2RurjQ%2FuRBKXJoxhDZdBjqI2BqWnK%2Fimg.png" width = "600px"></p><br><p>위 그림을 보면 레이어가 점점 깊어지는데 error_rate이 줄어드는 것을 확인할 수 있다. 그렇다면 레이어가 깊어질수록 더 좋은 결과를 보여주는 것이 아닌가?생각이 들 수 있다. 하지만, 앞선 포스트에서도 확인했듯이 CNN의 layer가 많아질수록(깊어질수록) 파라미터의 수가 급격히 늘어남을 확인했었다. 이는 overfitting의 문제가 아닐지라도 에러가 커지는 현상이 발생하게 된다. 무조건적으로 layer를 깊게하는 것이 아닌 다른 방법이 필요하다 생각한 것이고 <code>residual learning</code>을 하게 된 것이다.</p><p>따라서, ResNet팀은 두가지의 원칙을 세웠다고 한다.</p><ol><li>출력 feature-map의 크기가 같은 경우, 해당 모든 layer는 모두 동일한 수의 filter를 갖는다.</li><li>feature-map의 크기가 절반으로 작아지는 경우는 연산량의 균형을 맞추기 위해 필터의 수를 두배로 늘린다. Feature-map의 크기를 줄일 때는 pooling을 사용하는 대신에 convolution을 수행할 때, stride의 크기를 “2”로 하는 방식을 취한다.</li></ol><p>연산량에 대해서는 자세히 배운 후 다시 다뤄보도록 하겠다. 우선, maxpooling과 dropout이 이 네트워크에선 쓰이지 않았다고 한다. 쓰이지 않은 이유를 알기 전에 먼저 maxpooling과 dropout을 알아보겠다.</p><hr><br><h2 id="maxpooling2d"><a href="#maxpooling2d" class="headerlink" title="maxpooling2d"></a>maxpooling2d</h2><p>convolution layer의 출력 이미지에서 주요값만 뽑아 크기가 작은 출력영상으로 만드는 역할이다. 이 layer는 사소한 변화가 영향을 미치지 않도록 한다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MaxPooling2D(pool_size = (<span class="number">2</span>,<span class="number">2</span>))</span><br></pre></td></tr></table></figure><p><code>pool_size</code>가 (2,2)이면 입력영상의 크기가 절반으로 줄어든다.</p><p>예를 들어, <code>input_shape</code>이 4X4 이고, <code>pool_size</code>가 2,2일 때를 도식화 하면 다음과 같다. 녹색은 입력영상을, 노란색은 <code>pool_size</code>에 따라 나눈 경계를, pool마다 가장 큰값(max)을 선택하여 파란블럭으로 만들면, 그것이 <code>output</code>이 된다.</p><p align = "center"><img src ="http://tykimos.github.io/warehouse/2017-1-27_CNN_Layer_Talk_lego_12.png", width = "700px"></p><p>이것이 <code>translation</code>에 굉장히 좋은 결과를 얻게되는데 그 이유는 밑의 그림을 통해 한눈에 알아볼 수 있다.</p><p align = "center"><img src = "http://tykimos.github.io/warehouse/2017-1-27_CNN_Layer_Talk_lego_13.png", width = "700px"></p><p>결론적으로 분류 작업에 유리한 불변성질(invariance)를 얻을 수 있는 장점도 있다.</p><p>하지만 ResNet-152에서는 maxpooling을 가급적 사용하지 않았다(except 1 layer). maxpooling은 이미지 구성요소의 공간관계에 대한 정보를 잃기 때문이다. 이는 위치와 상관없이 객체를 동일하게 인식하지만, 방향(orientation)이나 비율(proportion)이 달라지면 서로 다른 객체로 인식하게 된다. 특히 시점(viewpoint)변화에 유독 취약하다. 이를 해결하기 위해 data augmentation을 사용하지만 학습시간이 증가하게 되는 단점이 생기게 된다.</p><p>제프리 힌턴교수는 CNN의 층을 쌓는 대신, 캡슐망을 고안해냈는데 이는 나의 범위를 넘어가므로 먼훗날.. 다시 다뤄보겠다.</p><hr><br><h2 id="dropout"><a href="#dropout" class="headerlink" title="dropout"></a>dropout</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Dropout(<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure><p>layer가 많아질 때 대표적으로 발생하는 문제는 overfitting이다. 아래 그림처럼 unseparable한 상황임에도 불구하고 억지로 separate하는 상황을 overfitting이라고 한다.</p><p><img src="/image/20210121_203242.jpg"></p><p>overfitting을 방지하는 방법은 세가지가 있다고 한다.</p><ol><li>training data를 늘리기</li><li>feature의 수를 줄이기</li><li><strong>regularization</strong></li></ol><p align= "center"><img src = "https://t1.daumcdn.net/cfile/tistory/2264014957A0248C2D"></p><p>이 중 Dropout은 regularization에 해당한다. <code>reLU</code>도 이에 해당한다. Dropout은 일부 neuron을 제거하여 다음 학습에 필요하지 않도록 만드는 것이다. 그렇다면 이게 왜 좋은 방법인 것인가?<br>“사공이 많으면 배가 산으로간다”라고 생각하면 좋다. 고양이임을 판단할 때 귀,꼬리,발톱,손,눈 등을 판단하는 여러 weight이 있다고 생각할 때, dropout을 통해 몇개의 노드들을 쉬게하는 것이다.<br>위의 예제에서는 20퍼센트의 neuron들을 쉬게하는것이다. 노드들의 정보는 남기고 connection만 삭제하는 <code>dropconnect</code>같은 방법도 있다고 한다.</p><p>위의 오버피팅을 줄이기 위해서 <code>ensenble</code>이라는 방법을 사용한다고 한다. 이는 ResNet-152에서도 사용했다고 하는데 2~5%정도의 예측률이 올라간다고 한다. 이또한 나중에 다뤄보겠다.</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://tykimos.github.io/2017/01/27/CNN_Layer_Talk/">https://tykimos.github.io/2017/01/27/CNN_Layer_Talk/</a><br><a href="https://www.kakaobrain.com/blog/9">https://www.kakaobrain.com/blog/9</a><br><a href="http://blog.creation.net/mxnet-part-5-vgc16-resnet152">http://blog.creation.net/mxnet-part-5-vgc16-resnet152</a><br><a href="https://doorbw.tistory.com/147">https://doorbw.tistory.com/147</a><br><a href="https://pythonkim.tistory.com/42">https://pythonkim.tistory.com/42</a></p><p><a name="footnote_1">1</a> : Shah, P. H. &amp; Venkatesh, R. Pulp/tooth ratio of mandibular frst and second molars on panoramic radiographs: an aid for forensic<br>age estimation. J. Forensic Dent. Sci. 8, 112. <a href="https://doi.org/10.4103/0975-1475.186374">https://doi.org/10.4103/0975-1475.186374</a> (2016).<br><a name="footnote_2">2</a> : Mathew, D. G. et al. Adult forensic age estimation using mandibular frst molar radiographs: a novel technique. J. Forensic Dent. Sci. 5, 56–59. <a href="https://doi.org/10.4103/0975-1475.114552">https://doi.org/10.4103/0975-1475.114552</a> (2013).<br><a name="footnote_3">3</a> : He, K., Zhang, X., Ren, S. &amp; Sun, J. Deep residual learning for image recognition. In 2016 IEEE Conference on Computer Vision and Pattern Recognition (CVPR), Las Vegas, NV, 2016, 770–778, <a href="https://doi.org/10.1109/CVPR.2016.90">https://doi.org/10.1109/CVPR.2016.90</a>.</p>]]></content>
      
      
      <categories>
          
          <category> AAIS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AAIS </tag>
            
            <tag> tensorflow </tag>
            
            <tag> keras </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AAIS] E02. Convolution Layer - 1</title>
      <link href="2021/01/21/aais-02/"/>
      <url>2021/01/21/aais-02/</url>
      
        <content type="html"><![CDATA[<h1 id="Conv2D-Layer"><a href="#Conv2D-Layer" class="headerlink" title="Conv2D Layer"></a>Conv2D Layer</h1><p>이번 포스트에서는 Conv2D Layer에 대해서 자세히 다뤄볼 예정이다.</p><h2 id="Conv2D-parameters"><a href="#Conv2D-parameters" class="headerlink" title="Conv2D parameters"></a>Conv2D parameters</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tf.keras.layers.Conv2D(</span><br><span class="line">    filters, kernel_size, strides=(<span class="number">1</span>, <span class="number">1</span>), padding=<span class="string">&#x27;valid&#x27;</span>,</span><br><span class="line">    data_format=<span class="literal">None</span>, dilation_rate=(<span class="number">1</span>, <span class="number">1</span>), groups=<span class="number">1</span>, activation=<span class="literal">None</span>,</span><br><span class="line">    use_bias=<span class="literal">True</span>, kernel_initializer=<span class="string">&#x27;glorot_uniform&#x27;</span>,</span><br><span class="line">    bias_initializer=<span class="string">&#x27;zeros&#x27;</span>, kernel_regularizer=<span class="literal">None</span>,</span><br><span class="line">    bias_regularizer=<span class="literal">None</span>, activity_regularizer=<span class="literal">None</span>, kernel_constraint=<span class="literal">None</span>,</span><br><span class="line">    bias_constraint=<span class="literal">None</span>, **kwargs</span><br><span class="line">)</span><br></pre></td></tr></table></figure><br><ol><li><code>filters</code> : convolution filter의 수</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Conv2D(<span class="number">1</span>, (<span class="number">2</span>, <span class="number">2</span>), padding=<span class="string">&#x27;same&#x27;</span>, input_shape=(<span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>))</span><br></pre></td></tr></table></figure><p>이 코드를 도식화 하면 다음과 같다.</p><p align = "center"><img src = "http://tykimos.github.io/warehouse/2017-1-27_CNN_Layer_Talk_lego_5.png"></p><p>필터의 개수가 채널의 수와도 연관이 있으므로 input_shape을 고려해서 필터의 개수를 지정해야 한다. 이 필터를 거치게 되면 다음과 같은 <code>feature_map</code>을 얻게 된다.</p><p align = "center"><img src = "https://wikidocs.net/images/page/64066/conv8.png"></p><p><a href="https://machinelearningmastery.com/how-to-visualize-filters-and-feature-maps-in-convolutional-neural-networks/">feature map을 도식화하는 방법</a>으로 눈으로 직접 <code>feature_map</code>을 보는 것도 좋을 것 같다.</p><ol start="2"><li><code>kernel_size</code> : convolution filter의 (행,열)</li></ol><p>위와 같은 경우에는 2 X 2 filter가 존재하는 것이다.</p><ol start="3"><li><code>strides</code> : filter가 stride하는 단위</li><li><code>padding</code> : 경계처리방법으로 filter를 거친 feature map의 크기를 결정짓는 요소이기도 하다.</li></ol><p align = "center"><img src ="https://wikidocs.net/images/page/64066/conv10.png"></p><p>option이 <code>valid</code>일 경우 유효한 영역만 출력이 되므로 출력이미지 사이즈가 입력 사이즈보다 작아질 것이다.<br>option이 <code>same</code>일 경우 입력사이즈와 동일하게 행,열을 추가하며 주로 <code>zero padding</code>을 사용한다. <code>zero padding</code>을 사용하면 좋은 점은 영상의 크기를 동일하게 맞출 뿐만 아니라 <strong>경계면의 정보까지 살릴 수가 있어</strong> 더 좋은 결과를 얻게 된다.</p><ol start="5"><li><code>input_shape</code> = (행, 열, 채널수)로 정의하며 모델에서 첫 레이어만 정의한다. 채널수는 흑백일경우 1, 컬러일경우 3으로 설정한다.</li><li><code>activation</code> = 활성화함수를 정의한 것으로 우리가 주로 다룰 것은 <code>relu</code>,<code>softmax</code>이다. 이는 다음에 다뤄보도록 하겠다.</li></ol><p>다른 parameter들은 필요할 때 살펴보도록 하겠다.</p><h2 id="parameter-수-계산하기"><a href="#parameter-수-계산하기" class="headerlink" title="parameter 수 계산하기"></a>parameter 수 계산하기</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span> Dense, Conv2D , MaxPool2D , Flatten , Dropout , BatchNormalization</span><br><span class="line"></span><br><span class="line">num_classes = <span class="number">25</span></span><br><span class="line"></span><br><span class="line">model = Sequential()</span><br><span class="line">model.add(Conv2D(<span class="number">75</span> , (<span class="number">3</span>,<span class="number">3</span>) , strides = <span class="number">1</span> , padding = <span class="string">&#x27;same&#x27;</span> , activation = <span class="string">&#x27;relu&#x27;</span> , input_shape = (<span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>)))</span><br><span class="line">model.add(BatchNormalization())</span><br><span class="line">model.add(MaxPool2D((<span class="number">2</span>,<span class="number">2</span>) , strides = <span class="number">2</span> , padding = <span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">model.add(Conv2D(<span class="number">50</span> , (<span class="number">3</span>,<span class="number">3</span>) , strides = <span class="number">1</span> , padding = <span class="string">&#x27;same&#x27;</span> , activation = <span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">model.add(Dropout(<span class="number">0.2</span>))</span><br><span class="line">model.add(BatchNormalization())</span><br><span class="line">model.add(MaxPool2D((<span class="number">2</span>,<span class="number">2</span>) , strides = <span class="number">2</span> , padding = <span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">model.add(Conv2D(<span class="number">25</span> , (<span class="number">3</span>,<span class="number">3</span>) , strides = <span class="number">1</span> , padding = <span class="string">&#x27;same&#x27;</span> , activation = <span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">model.add(BatchNormalization())</span><br><span class="line">model.add(MaxPool2D((<span class="number">2</span>,<span class="number">2</span>) , strides = <span class="number">2</span> , padding = <span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">model.add(Flatten())</span><br><span class="line">model.add(Dense(units = <span class="number">512</span> , activation = <span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">model.add(Dropout(<span class="number">0.3</span>))</span><br><span class="line">model.add(Dense(units = num_classes , activation = <span class="string">&#x27;softmax&#x27;</span>))</span><br><span class="line">model.summary()</span><br></pre></td></tr></table></figure><pre><code>                Model: &quot;sequential_4&quot;                _________________________________________________________________                Layer (type)                 Output Shape              Param #                =================================================================                conv2d_6 (Conv2D)            (None, 28, 28, 75)        750                _________________________________________________________________                batch_normalization (BatchNo (None, 28, 28, 75)        300                _________________________________________________________________                max_pooling2d (MaxPooling2D) (None, 14, 14, 75)        0                _________________________________________________________________                conv2d_7 (Conv2D)            (None, 14, 14, 50)        33800                _________________________________________________________________                dropout (Dropout)            (None, 14, 14, 50)        0                _________________________________________________________________                batch_normalization_1 (Batch (None, 14, 14, 50)        200                _________________________________________________________________                max_pooling2d_1 (MaxPooling2 (None, 7, 7, 50)          0                _________________________________________________________________                conv2d_8 (Conv2D)            (None, 7, 7, 25)          11275                _________________________________________________________________                batch_normalization_2 (Batch (None, 7, 7, 25)          100                _________________________________________________________________                max_pooling2d_2 (MaxPooling2 (None, 4, 4, 25)          0                _________________________________________________________________                flatten (Flatten)            (None, 400)               0                _________________________________________________________________                dense (Dense)                (None, 512)               205312                _________________________________________________________________                dropout_1 (Dropout)          (None, 512)               0                _________________________________________________________________                dense_1 (Dense)              (None, 25)                12825                =================================================================                Total params: 264,562                Trainable params: 264,262                Non-trainable params: 300                _________________________________________________________________</code></pre><p>위의 <code>summary</code>는 다른 data들을 학습시킨 결과로 배포할 수 없는 데이터들이기 때문에 <code>summary</code>를 통해서 param number만 계산해 보도록 하겠다.</p><br><hr><h3 id="convolution-layer-1의-activation-map-크기-계산"><a href="#convolution-layer-1의-activation-map-크기-계산" class="headerlink" title="convolution layer 1의 activation map 크기 계산"></a>convolution layer 1의 activation map 크기 계산</h3><p align = "center"><img src = "https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FCGGUL%2FbtqFo5oGkOV%2F0ZFkRKpAeFeNPkYuzAAbWK%2Fimg.png"></p><p>Width Output Size = (W - F + 2P) / S + 1<br>W: input_volume_size(width)<br>F: kernel_size(width)<br>P: padding_size(width)<br>S: strides</p><p>첫번째 convolution layer를 지나면 <code>Width</code> = 28, <code>kernel_size(width)</code> = 3, <code>padding_size</code> = 1, <code>strides</code> = 1 이므로 계산하면 <code>width output</code>은 28이 된다.<br><code>filters</code>의 수가 75이므로 output size = (28,28,75)가 된다.</p><br><p>이를 간단한 그림으로 보이겠다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Conv2D(<span class="number">3</span>, (<span class="number">2</span>, <span class="number">2</span>), padding=<span class="string">&#x27;same&#x27;</span>, input_shape=(<span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>))</span><br></pre></td></tr></table></figure><p align = "center"><img src = "http://tykimos.github.io/warehouse/2017-1-27_CNN_Layer_Talk_lego_6.png"></p><p>필터가 3개라서 출력 이미지도 필터 수에 따라 3개로 늘어난다.<br>필터마다 고유한 특징을 뽑아 고유한 출력 이미지로 만들기 때문에 필터의 출력값을 더해서 하나의 이미지로 만들지 않는다.</p><p>위의 경우는 채널이 1개일 때고 채널이 여러개일 때를 도식화 한것은 다음과 같다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Conv2D(<span class="number">2</span>, (<span class="number">2</span>, <span class="number">2</span>), padding=<span class="string">&#x27;same&#x27;</span>, input_shape=(<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure><p>input_shape이 <code>(3,3,3)</code>이므로 3X3이미지가 3개의 채널로 존재한다는 것이다. 따라서 필터를 2개를 주고 필터의 사이즈를 2X2로 하게된다면 아래의 그림처럼 필터 1개마다 채널 1개씩 곱이 convolution이 진행되고 다시 한개의 layer로 합쳐지므로 결론적으로는 3X3사이즈의 2개의 채널이 만들어지므로 output_shape은 <code>(3,3,2)</code>일 것이다.</p><p align = "center"><img src = "http://tykimos.github.io/warehouse/2017-1-27_CNN_Layer_Talk_lego_10.png"></p><p>즉 필터의 개수만큼의 layer가 쌓이게 되고 중간에 컨벌루션곱이 이루어진 것이므로 feature map은 당연히 다른 것이다.</p><br><p>이제 파라미터의 수를 구해보겠다. 그 식은 다음과 같다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">number_parameters &#x3D; out_channels * (in_channels * kernel_h * kernel_w + 1)  # 1 for bias</span><br></pre></td></tr></table></figure><p>여기서 <code>out_channels</code>이란 필터의 개수와 동일하다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">in_channels &#x3D; 1</span><br><span class="line">out_channels &#x3D; 75</span><br><span class="line">kernel_h &#x3D; kernel_w &#x3D; 3</span><br><span class="line">number_parameters &#x3D; 75(1*3*3 + 1) &#x3D; 750</span><br></pre></td></tr></table></figure><p>우리의 <code>summary</code>에서 확인한 750은 위와같이 계산된 것이다.</p><br><hr><h3 id="convolution-layer-2의-activation-map-크기-계산"><a href="#convolution-layer-2의-activation-map-크기-계산" class="headerlink" title="convolution layer 2의 activation map 크기 계산"></a>convolution layer 2의 activation map 크기 계산</h3><p><code>max_pooling2d</code>를 지나면 <code>output_shape</code>은 <code>(14,14,75)</code>가 된다. 이는 conv2d의 <code>input_shape</code>이 된다. (그래서 첫번째 레이어에서만 input_shape을 정의하는 것이다.)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">in_channels &#x3D; 75</span><br><span class="line">out_channels &#x3D; 50</span><br><span class="line">kernel_h &#x3D; kernel_w &#x3D; 3</span><br><span class="line">number_parameters &#x3D; 75(50*3*3 + 1) &#x3D; 33825</span><br></pre></td></tr></table></figure><p>두번째 conv2d의 파라미터의 수도 잘계산되었다. 이처럼 <code>Layer</code>들을 지나다보면 <code>in_channels</code>의 수가 증가하여 <code>parameters</code>의 수가 급격히 증가하게 되는데 이를 다루는 방법은 다음에 다뤄보겠다~</p><br><hr><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://tykimos.github.io/2017/01/27/CNN_Layer_Talk/">https://tykimos.github.io/2017/01/27/CNN_Layer_Talk/</a><br><a href="https://underflow101.tistory.com/38?category=826164">https://underflow101.tistory.com/38?category=826164</a><br><a href="https://blog.naver.com/laonple/220587920012">https://blog.naver.com/laonple/220587920012</a></p>]]></content>
      
      
      <categories>
          
          <category> AAIS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AAIS </tag>
            
            <tag> tensorflow </tag>
            
            <tag> keras </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Java]Day03 - 연산자</title>
      <link href="2021/01/20/java-day3/"/>
      <url>2021/01/20/java-day3/</url>
      
        <content type="html"><![CDATA[<h2 id="JAVA-NEWS"><a href="#JAVA-NEWS" class="headerlink" title="JAVA NEWS"></a>JAVA NEWS</h2><p>오늘은 들어가기에 앞서 스터디에서 다룬 내용을 살펴보겠다.</p><h3 id="Maven-Dependencies-Pop-Quiz"><a href="#Maven-Dependencies-Pop-Quiz" class="headerlink" title="Maven Dependencies Pop Quiz"></a><a href="http://andresalmiray.com/maven-dependencies-pop-quiz-results/">Maven Dependencies Pop Quiz</a></h3><p align = "center"><img src = "http://andresalmiray.com/wp-content/uploads/2020/03/pop-mvn01-768x629.png"></p><p>정답은 <code>28.2version</code>이다.<br>dependency는 동일한 groupId일 경우 가장 마지막에 있는 버젼이 위에 있는 것을 오버라이딩한다고 생각하면 좋다.</p><p align = "center"><img src = "http://andresalmiray.com/wp-content/uploads/2020/03/pop-mvn02-768x660.png"></p><p>정답은 <code>28.2version</code>이다.<br>dependency는 가장 POM파일에 명확하게 정의된 것으로 정의한다.<br>truth의 27.0.1version은 28.2v보다 depth가 깊다고 생각하면 된다.</p><p align = "center"><img src = "http://andresalmiray.com/wp-content/uploads/2020/03/pop-mvn03-768x734.png"></p><p>정답은 <code>27.0version</code>이다.<br>dependencyManagement(이하 DM)는 추이적(transitive)으로 정의된 dependency보다는 가깝다.</p><p align = "center"><img src = "http://andresalmiray.com/wp-content/uploads/2020/03/pop-mvn04-768x854.png"></p><p>정답은 <code>27.0version</code>이다.<br>DM은 dependency보다는 조금 멀다. DM은 어떤버젼을 쓸지 명시해놓은 것이다. 만약 guava 28.2-jre를 제거할 경우 27.0 version이 적용이 될것이다.</p><p>결론적으로는 dependency &gt; DM &gt; 추이적정의 순서대로 정의가 된다고 생각하면 된다.</p><h2 id="Review-Day02"><a href="#Review-Day02" class="headerlink" title="Review Day02"></a>Review Day02</h2><blockquote><p>Q1. Java에 unsigned이 존재하는가?</p></blockquote><p>정답은 <code>Yes</code>이다. 정확히는 java8 이전까지는 unsigned형이 존재하지 않는다. C에서는 <code>unsigned int</code>를 사용하면 됐지만 java에는 이가 존재하지 않는다. <code>int unsigned = Integer.parseUnsignedInt(&quot;21억이상&quot;)</code>이라고 할 시 <code>Integer.toUnsignedString(unsigned)</code>로 출력을 하는것은 가능하다. 하지만 이는 좋은 방법이 아니므로 그냥 <code>BigInteger</code>를 사용하자! (<strong>L을 넣어야한다.</strong>)</p><blockquote><p>Q2. <code>int number = 1_000;</code>이 정의가 되는가?</p></blockquote><p>정답은 <code>Yes</code>이다. 숫자를 표현할 때 가독성이 좋게 하기위해 언더바(_)를 통해 정의할 수 있다.</p><p>또 하나의 중요한 점은 Static 변수와 Instance변수의 라이프사이클이다.<br>Static의 라이프사이클은 클래스가 로딩된 시점이지만 Instance변수의 라이프사이클은 클래스가 생성된 시점이므로 instance가 생성되기 이전에는 instance변수가 존재하지 않는다 따라서 static은 instance 변수를 참조할 수 없다. 이는 중요한 내용이므로 모르면 찾아보자<br>오늘의 리뷰는 짧게 하고 DAY03 시작해보겠다.</p><h2 id="Day03-연산자"><a href="#Day03-연산자" class="headerlink" title="Day03. 연산자"></a>Day03. 연산자</h2><p>산술 연산자, 비트 연산자, 관계 연산자, 논리 연산자, assignment(=) operator, 3항 연산자 그리고 연산자 우선 순위는 넘어가보도록 할 것이다. 시간이 부족해서 다른 것들에 더 집중해보도록 하겠다. 이에 대해서는 <a href="https://www.notion.so/3-f3a94e0092664d8aa1debe7e88dec43b">이 블로그</a>에서 깔끔히 다뤘으므로 참고하면 좋겠다.</p><h3 id="instanceof-연산자"><a href="#instanceof-연산자" class="headerlink" title="instanceof 연산자"></a>instanceof 연산자</h3><p>참조변수가 참조하고 있는 인스턴스의 실제 타입을 알아보기 위해 instanceof 연산자를 사용한다.<br>주로 <strong>조건문</strong>에서 사용되며, 왼쪽에는 참조변수를 오른쪽에는 타입(class name)을 쓴다. 그리고 연산의 결과는 boolean형인 <code>true</code>나 <code>false</code>를 반환한다.</p><p> instanceof를 이용한 연산결과로 true를 얻었다는 것은 참조변수가 검사한 타입으로 형변환이 가능하다는 것을 뜻한다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doWork</span><span class="params">(Car c)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(c <span class="keyword">instanceof</span> FireEngine)&#123;</span><br><span class="line">    FireEngine fe = (FireEngine)c;</span><br><span class="line">        fe.water();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(c instance of Ambulance)&#123;</span><br><span class="line">    Ambulance a = (Ambulance)c;</span><br><span class="line">        a.siren();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>위의 코드는 Car타입의 참조변수인 c를 매개변수로 하는 메서드이다. 이 메서드가 호출될 때, 매개변수로 Car클래스 혹은 그 자손 클래스의 인스턴스를 넘겨받겠지만 메서드 내에서는 정확히 어떤 인스턴스인지 알 수가 없다. 따라서, <code>instanceof</code>연산자를 이용해서 참조변수 c가 가리키고 있는 인스턴스의 타입을 체크하고 적절히 형변환을 한 다음에 작업을 해야한다.</p><p>위의 코드에서는 c라는 참조변수가 FireEngine인지 Ambulance인지 구분을 시킨 후 각각에 맞춰서 형변환을 이룬 후 메서드를 실행한다. 이는 정말 중요한 작업이다.</p><p>그리고 또한 중요한 것은 만약 c라는 참조변수가 FireEngine이라 해도 <code>c instance of Car</code>의 구문에서도 <code>true</code>를 반환한다는 점과 모든 클래스의 조상클래스인 <code>Object</code>의 인스턴스 이기도 하다는 것이다. 즉, 실제 인스턴스와 같은 타입의 instanceof연산 이외에 조상타입의 instanceof연산에도 true를 결과로 얻으며, <strong>instanceof연산의 결과가 true라는 것은 검사한 타입으로의 형변환을 해도 문제가 없다는 뜻이다.</strong></p><h3 id="화살표-gt-연산자"><a href="#화살표-gt-연산자" class="headerlink" title="화살표(-&gt;) 연산자"></a>화살표(-&gt;) 연산자</h3><p>자바가 등장한 이후로 두 번의 큰 변화가 있었는데, 한번은 5버젼의 <code>지네릭스</code>와 8버젼의 <code>람다식</code>이다. -&gt;연산자는 이 람다식이다.<br>람다식의 도입으로 자바는 객체지향언어임과 동시에 함수형 언어가 되었다.</p><blockquote><p>람다식이란?</p></blockquote><p> 람다식에 대해 간단히 먼저 설명하자면, 메서드를 하나의 ‘식(Expression)’으로 표현한 것을 말한다. 람다식은 함수를 간략하면서도 명확한 식으로 표현할 수 있게 해준다.<br> 메서드를 람다식으로 표현하면 메서드의 이름과 반환값이 없어지므로, 람다식을 ‘Anonymous funcion’이라고도 한다.</p><p>아래와 같이 선언된 매개변수가 하나뿐인 경우에는 괄호()를 생략할 수 있다. 단, 매개변수의 타입이 있으면 괄호()를 생략할 수 없다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(a) -&gt; a*a <span class="comment">// OK</span></span><br><span class="line">(<span class="keyword">int</span> a) -&gt; a*a <span class="comment">// Error</span></span><br></pre></td></tr></table></figure><p>마찬가지로 괄호{}안의 문장이 하나일 때는 괄호{}를 생략할 수 있다. 이 때 문장의 끝에 ‘;’를 붙이지 않아야 한다는 것에 주의하자.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(String name, <span class="keyword">int</span> i) -&gt; System.out.println(name+<span class="string">&quot;=&quot;</span>+i)</span><br></pre></td></tr></table></figure><p>그러나 괄호{}안의 문장이 return문일 경우에는 괄호를{}생략할 수 없다.</p><p>람다식에 대해서는 중요한 내용이므로 나아아중에 다시 제대로 다뤄보겠다.</p><h3 id="Optional"><a href="#Optional" class="headerlink" title="Optional"></a>Optional</h3><p>Optional도 정말 중요한 내용이지만 우선 지금 다루기엔 너무 내용이 많으므로 간략히 다뤄보겠다.<br>Optional class는 지네릭(generic)클래스(벌써 범위를 넘어갔다.)로써 ‘T타입의 객체’를 감싸는 래퍼(wrapper) 클래스이다. 그래서 Optional타입의 객체에는 <code>모든 타입의 참조변수</code>를 담을 수 있다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Optional</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> T value; <span class="comment">// T타입의 참조변수</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>최종 연산의 결과를 그냥 반환하는 것이 아니라 Optional객체에 담아서 반환하는 것이다.이처럼 객체에 담아서 반환을 하면, 반환된 결과가 null인지 매번 if문으로 체크하는 대신 Optional에 정의된 메서드를 통해서 간단히 처리할 수 있다.<br> 즉, Null체크를 위한 if문 없이도 <code>NullPointerException</code>이 발생하지 않는 안전한 코드를 작성하는 것이 가능해진 것이다.<br>자세한 내용은 <a href="https://velog.io/@bluesky7017/%EC%9E%90%EB%B0%94%EA%B0%80-%EC%A0%9C%EA%B3%B5%ED%95%98%EB%8A%94-%EB%8B%A4%EC%96%91%ED%95%9C-%EC%97%B0%EC%82%B0%EC%9E%90%EB%A5%BC-%ED%95%99%EC%8A%B5%ED%95%98%EC%84%B8%EC%9A%94">이 블로그</a>에서 참고하면 좋을 것 같다.</p><h3 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h3><p>이번 연산자단원에서는 내가 크게 다룬 것은 없다. -&gt;연산자는 뒤에 람다식을 다루며 자세히 다뤄야할 내용이며 Optional도 그러하다. 진도를 빨리 나가기 위해 연산자에 대한 내용은 위에 참조된 링크들을 보면 좋을 것이다.</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li>자바의 정석</li></ul>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AAIS]E01.Using Deep Learning Tools</title>
      <link href="2021/01/20/aais-01/"/>
      <url>2021/01/20/aais-01/</url>
      
        <content type="html"><![CDATA[<h1 id="Using-Deep-Learning-Tools"><a href="#Using-Deep-Learning-Tools" class="headerlink" title="Using Deep Learning Tools"></a>Using Deep Learning Tools</h1><h2 id="들어가기에-앞서"><a href="#들어가기에-앞서" class="headerlink" title="들어가기에 앞서"></a>들어가기에 앞서</h2><p> 지난 시간에 CNN에 대해 간략하게 나마 알아보았다. <br><br>이번에는 교수님께서 제공해주신 예제들을 통해 친숙해져보도록 하겠다.</p><p><code>!nvidia-smi</code>는 nvidia gpu resource들을 모니터링하는 명령어이다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!nvidia-smi</span><br></pre></td></tr></table></figure><pre><code>Wed Jan 20 05:13:24 2021+-----------------------------------------------------------------------------+| NVIDIA-SMI 410.104      Driver Version: 410.104      CUDA Version: 10.1     ||-------------------------------+----------------------+----------------------+| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC || Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. ||===============================+======================+======================||   0  Tesla V100-DGXS...  On   | 00000000:07:00.0 Off |                    0 || N/A   41C    P0    51W / 300W |   1561MiB / 32478MiB |      0%      Default |+-------------------------------+----------------------+----------------------+|   1  Tesla V100-DGXS...  On   | 00000000:08:00.0 Off |                    0 || N/A   40C    P0    54W / 300W |    626MiB / 32478MiB |      0%      Default |+-------------------------------+----------------------+----------------------+|   2  Tesla V100-DGXS...  On   | 00000000:0E:00.0 Off |                    0 || N/A   40C    P0    50W / 300W |  27829MiB / 32478MiB |      0%      Default |+-------------------------------+----------------------+----------------------+|   3  Tesla V100-DGXS...  On   | 00000000:0F:00.0 Off |                    0 || N/A   40C    P0    49W / 300W |    652MiB / 32478MiB |      0%      Default |+-------------------------------+----------------------+----------------------++-----------------------------------------------------------------------------+| Processes:                                                       GPU Memory ||  GPU       PID   Type   Process name                             Usage      ||=============================================================================|+-----------------------------------------------------------------------------+</code></pre><p>랩실에서 실제로 사용하고 있는 서버이기 때문에 리소스를 확인하고 적절히 분배해서 사용해야한다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># using gpu:/1</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.environ[<span class="string">&quot;CUDA_VISIBLE_DEVICES&quot;</span>] = <span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line">gpus = tf.config.experimental.list_physical_devices(<span class="string">&#x27;GPU&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> gpus:</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    tf.config.experimental.set_memory_growth(gpus[<span class="number">0</span>], <span class="literal">True</span>)</span><br><span class="line">  <span class="keyword">except</span> RuntimeError <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br></pre></td></tr></table></figure><p>위와 같은 코드를 사용하면 GPU #1번을 사용하는 것이다. 또한, 한꺼번에 모든 메모리를 사용하는 것이 아닌 <code>tf.config.experimental.set_memory_growth</code>를 사용해 메모리를 증가시키며 사용한다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># using gpu:/1</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.environ[<span class="string">&quot;CUDA_VISIBLE_DEVICES&quot;</span>] = <span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line">gpus = tf.config.experimental.list_physical_devices(<span class="string">&#x27;GPU&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> gpus:</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    tf.config.experimental.set_memory_growth(gpus[<span class="number">0</span>], <span class="literal">True</span>)</span><br><span class="line">  <span class="keyword">except</span> RuntimeError <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br></pre></td></tr></table></figure><p><code>MNIST dataset</code>은 튜링어워드를 수상하셨던 <code>Convolution network</code>의 창시자 <code>Yann LeCun</code>가 제공해주시는 데이터셋이다.<br><br>이를 활용하여 실습을 진행해보겠다.</p><p><code>MNIST dataset</code>은 손으로 쓴 숫자 이미지를 벡터로 나타낸 images와 그 이미지가 의미하는 숫자를 나타내는 labels로 이루어져 있다. 한개의 이미지는 <code>28*28(=784)의 픽셀</code>로 이루어져 있기 때문에 이는 784차원의 벡터로 저장되어 있고 진하기의 정도에 따라 0~1사이의 값이 들어있다. 예시는 다음과 같다.</p><p align="center"><img src="https://docs.ncloud.com/ko/tensorflow/images/tensorflow-1-3-102.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span> Dense, Conv2D, Flatten</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># the data, split between train and test sets</span></span><br><span class="line">(x_train, y_train), (x_test, y_test) = mnist.load_data()</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;# of train data : &quot;</span>,x_train.shape)</span><br><span class="line">print(<span class="string">&quot;# of test data : &quot;</span>,x_test.shape)</span><br></pre></td></tr></table></figure><pre><code># of train data :  (60000, 28, 28)# of test data :  (10000, 28, 28)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.imshow(x_train[<span class="number">509</span>], cmap=<span class="string">&#x27;gray&#x27;</span>)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.image.AxesImage at 0x7f14e8b00940&gt;</code></pre><p><img src="/image/output_8_1.png" alt="png"></p><p>우선 CNN을 적용시키기 이전에 데이터를 vectorization시킨 후 진행해보겠다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Vectorization for ANN</span></span><br><span class="line">x_train_vectorize = x_train.reshape(<span class="number">60000</span>, <span class="number">784</span>)</span><br><span class="line">x_test_vectorize = x_test.reshape(<span class="number">10000</span>, <span class="number">784</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tensorflow.keras <span class="keyword">as</span> keras</span><br><span class="line">num_categories = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">y_train_onehot = keras.utils.to_categorical(y_train, num_categories)</span><br><span class="line">y_test_onehot = keras.utils.to_categorical(y_test, num_categories)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">model = Sequential()</span><br><span class="line"></span><br><span class="line">model.add(Dense(units=<span class="number">512</span>, activation=<span class="string">&#x27;relu&#x27;</span>, input_shape=(<span class="number">784</span>,)))</span><br><span class="line">model.add(Dense(units = <span class="number">512</span>, activation=<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">model.add(Dense(units = <span class="number">10</span>, activation=<span class="string">&#x27;softmax&#x27;</span>))</span><br><span class="line"></span><br><span class="line">model.summary()</span><br></pre></td></tr></table></figure><pre><code>Model: &quot;sequential&quot;_________________________________________________________________Layer (type)                 Output Shape              Param #=================================================================dense (Dense)                (None, 512)               401920_________________________________________________________________dense_1 (Dense)              (None, 512)               262656_________________________________________________________________dense_2 (Dense)              (None, 10)                5130=================================================================Total params: 669,706Trainable params: 669,706Non-trainable params: 0_________________________________________________________________</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">model.<span class="built_in">compile</span>(loss=<span class="string">&#x27;categorical_crossentropy&#x27;</span>, metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br><span class="line"></span><br><span class="line">history = model.fit(x_train_vectorize, y_train_onehot,</span><br><span class="line">                    epochs=<span class="number">20</span>,</span><br><span class="line">                    verbose=<span class="number">1</span>,</span><br><span class="line">                    validation_data=(x_test_vectorize, y_test_onehot))</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>Epoch 1/201875/1875 [==============================] - 6s 3ms/step - loss: 0.3957 - accuracy: 0.9521 - val_loss: 0.5461 - val_accuracy: 0.9337Epoch 2/201875/1875 [==============================] - 6s 3ms/step - loss: 0.3798 - accuracy: 0.9524 - val_loss: 0.7209 - val_accuracy: 0.9506Epoch 3/201875/1875 [==============================] - 6s 3ms/step - loss: 0.3913 - accuracy: 0.9522 - val_loss: 0.5986 - val_accuracy: 0.9464Epoch 4/201875/1875 [==============================] - 6s 3ms/step - loss: 0.3965 - accuracy: 0.9505 - val_loss: 0.6736 - val_accuracy: 0.9391Epoch 5/201875/1875 [==============================] - 6s 3ms/step - loss: 0.4349 - accuracy: 0.9540 - val_loss: 0.7524 - val_accuracy: 0.9441Epoch 6/201875/1875 [==============================] - 6s 3ms/step - loss: 0.4307 - accuracy: 0.9506 - val_loss: 0.9400 - val_accuracy: 0.9461Epoch 7/201875/1875 [==============================] - 6s 3ms/step - loss: 0.4567 - accuracy: 0.9509 - val_loss: 0.8693 - val_accuracy: 0.9406Epoch 8/201875/1875 [==============================] - 6s 3ms/step - loss: 0.4598 - accuracy: 0.9475 - val_loss: 0.9901 - val_accuracy: 0.9225Epoch 9/201875/1875 [==============================] - 6s 3ms/step - loss: 0.4730 - accuracy: 0.9471 - val_loss: 1.5888 - val_accuracy: 0.9191Epoch 10/201875/1875 [==============================] - 6s 3ms/step - loss: 0.4903 - accuracy: 0.9363 - val_loss: 0.9527 - val_accuracy: 0.9295Epoch 11/201875/1875 [==============================] - 6s 3ms/step - loss: 0.5425 - accuracy: 0.9351 - val_loss: 1.4321 - val_accuracy: 0.9451Epoch 12/201875/1875 [==============================] - 6s 3ms/step - loss: 0.5320 - accuracy: 0.9397 - val_loss: 1.7940 - val_accuracy: 0.9428Epoch 13/201875/1875 [==============================] - 6s 3ms/step - loss: 0.5362 - accuracy: 0.9346 - val_loss: 1.5604 - val_accuracy: 0.8951Epoch 14/201875/1875 [==============================] - 6s 3ms/step - loss: 0.5934 - accuracy: 0.9328 - val_loss: 1.8964 - val_accuracy: 0.8971Epoch 15/201875/1875 [==============================] - 6s 3ms/step - loss: 0.5844 - accuracy: 0.9265 - val_loss: 1.7190 - val_accuracy: 0.9085Epoch 16/201875/1875 [==============================] - 6s 3ms/step - loss: 0.6048 - accuracy: 0.9211 - val_loss: 1.6869 - val_accuracy: 0.9072Epoch 17/201875/1875 [==============================] - 6s 3ms/step - loss: 0.5789 - accuracy: 0.9172 - val_loss: 2.8615 - val_accuracy: 0.8887Epoch 18/201875/1875 [==============================] - 6s 3ms/step - loss: 0.6705 - accuracy: 0.9189 - val_loss: 2.0492 - val_accuracy: 0.9045Epoch 19/201875/1875 [==============================] - 6s 3ms/step - loss: 0.6655 - accuracy: 0.9216 - val_loss: 1.9504 - val_accuracy: 0.9053Epoch 20/201875/1875 [==============================] - 6s 3ms/step - loss: 0.6559 - accuracy: 0.9233 - val_loss: 2.6255 - val_accuracy: 0.9164</code></pre><h1 id="Keras-Sequential-model"><a href="#Keras-Sequential-model" class="headerlink" title="Keras Sequential model"></a>Keras Sequential model</h1><h2 id="Specify-Input-Shape"><a href="#Specify-Input-Shape" class="headerlink" title="Specify Input Shape"></a>Specify Input Shape</h2><hr><p>Model should know the Input Shape. So, <code>Sequential</code>model’s first layer(after this, layer know the shape) shold give the information.</p><ul><li>Pass the <code>input_shape</code> to the first layer. This is a tuple containing shape information.(A tuple with an integer or <code>None</code> as an entry; <code>None</code> represents an arbitrary positive integer). The <code>input_shape</code> does not include batch dimension.</li><li>Some two-dimensional layers, such as <code>Dense</code>, can specify the input shape through the <code>input_dim</code> argument, and some three-dimensional layers(temporal) support the <code>input_dim</code> and <code>input_length</code> arguments.</li></ul><h2 id="Compile"><a href="#Compile" class="headerlink" title="Compile"></a>Compile</h2><hr><p>Before Learning, you must configure the learning process with the <code>compile</code> method. This Method accepts three arguments.</p><ol><li>optimizer : It can be a string identifier that represents a built-in optimizer (such as <code>rmsprop</code> or <code>adagrad</code>), or an instance of the <code>optimizer</code> class.</li><li>loss : Loss function. This is what the model wants to minimize. It can be the string identifier(<code>categorical_crossentropy</code> or <code>mse</code>, and so on) or an instance of the target function itself of the built-in loss function</li><li>metrics : List of Metrics. If you solve the classification problem, It is recommended to use <code>metrics = [&#39;accuracy&#39;]</code>. Metrics can be string identifiers for built-in metrics or user-defined metric functions.</li></ol><h2 id="Train"><a href="#Train" class="headerlink" title="Train"></a>Train</h2><hr><p>The Keras model is trained based on input data and labels from the Numpy array. When you train a model, you typically use the <code>fit</code> function.</p><h3 id="For-the-better-explanation"><a href="#For-the-better-explanation" class="headerlink" title="For the better explanation"></a><a href="https://www.codeonweb.com/entry/eda18bec-7c7d-426f-ab98-90e18db6fdba">For the better explanation</a></h3><h1 id="Layer"><a href="#Layer" class="headerlink" title="Layer"></a>Layer</h1><h2 id="Activation-Function"><a href="#Activation-Function" class="headerlink" title="Activation Function"></a>Activation Function</h2><hr><h3 id="1-ReLU-Rectified-Linear-Unit-activation-function"><a href="#1-ReLU-Rectified-Linear-Unit-activation-function" class="headerlink" title="1. ReLU(Rectified Linear Unit activation function)"></a>1. ReLU(Rectified Linear Unit activation function)</h3><p align ="center"><img src="https://mlnotebook.github.io/img/transferFunctions/relu.png"></p><ul><li><strong>Features</strong></li></ul><ol><li>It makes the vanishing gradient problem(tanh, sigmoid have) <strong>MUCH WORSE</strong>,since for all negative values the derivative is precisely zero.</li><li>Computational Cost is not significant.</li><li>In comparison to (sigmoid,tanh), convergence speed is much better.</li></ol><h3 id="2-softmax"><a href="#2-softmax" class="headerlink" title="2. softmax"></a>2. softmax</h3><ul><li><strong>Features</strong></li></ul><ol><li>A function that normalizes the output value of a neuron at the last stage for class classification.(normalize sigmoid function)</li><li>So, we can think that It converts the output into probability. (sum = 1.0)</li></ol><h2 id="결과에-대한-분석"><a href="#결과에-대한-분석" class="headerlink" title="결과에 대한 분석"></a>결과에 대한 분석</h2><p>우선 케라스의 <code>Sequential Model</code>, <code>compile</code>, <code>fit</code>과 <code>activation function</code>에 대해 간략히 적어보았다. 이전에 있어보이려고 영어로 적어봤는데 아까워서 그냥 붙여썼다.</p><p>결과에 대해 다뤄보자면, <code>epoch= 20</code>으로 수행한 결과 어느정도까지는 accuracy는 높아지고 loss는 낮아지는 좋은 현상이 일어났지만 그 이후로는 줄어들었다 늘어났다를 반복하여 결론적으로는 성능이 더 낮아졌다. 그 이유는 무엇일까?</p><p>정답은 이미지를 벡터로 표현했기 때문이다. 저번 시간에도 말했듯 이미지를 벡터화한다면 조금만 translation되어도 다른 이미지로 인식하므로 overfitting되는 결과가 나온다. 따라서 이를 방지하고자 CNN을 사용하는 것이다.</p><p>Convolution을 한 모델로 새롭게 해보자.</p><h2 id="New-Model-with-Convolution"><a href="#New-Model-with-Convolution" class="headerlink" title="New Model with Convolution"></a>New Model with Convolution</h2><p><strong>새로 들어가기에 앞서 이 서버는 다른분들도 사용하셔서 항상 리소스를 반환해줘야한다.<br>따라서 학습이 끝난 후 리소스를 반환해주자.</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> IPython</span><br><span class="line">app = IPython.Application.instance()</span><br><span class="line">app.kernel.do_shutdown(<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><pre><code>&#123;&#39;status&#39;: &#39;ok&#39;, &#39;restart&#39;: True&#125;</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># using gpu:/1</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.environ[<span class="string">&quot;CUDA_VISIBLE_DEVICES&quot;</span>] = <span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line">gpus = tf.config.experimental.list_physical_devices(<span class="string">&#x27;GPU&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> gpus:</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    tf.config.experimental.set_memory_growth(gpus[<span class="number">0</span>], <span class="literal">True</span>)</span><br><span class="line">  <span class="keyword">except</span> RuntimeError <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># using gpu:/1</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.environ[<span class="string">&quot;CUDA_VISIBLE_DEVICES&quot;</span>] = <span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line">gpus = tf.config.experimental.list_physical_devices(<span class="string">&#x27;GPU&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> gpus:</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    tf.config.experimental.set_memory_growth(gpus[<span class="number">0</span>], <span class="literal">True</span>)</span><br><span class="line">  <span class="keyword">except</span> RuntimeError <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span> Dense, Conv2D, Flatten</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># the data, split between train and test sets</span></span><br><span class="line">(x_train, y_train), (x_test, y_test) = mnist.load_data()</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tensorflow.keras <span class="keyword">as</span> keras</span><br><span class="line">num_categories = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">y_train_onehot = keras.utils.to_categorical(y_train, num_categories)</span><br><span class="line">y_test_onehot = keras.utils.to_categorical(y_test, num_categories)</span><br></pre></td></tr></table></figure><p>여기까지의 내용은 동일하다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">model = Sequential()</span><br><span class="line"></span><br><span class="line">model.add(Conv2D(<span class="number">64</span>, kernel_size=<span class="number">3</span>, activation=<span class="string">&#x27;relu&#x27;</span>, input_shape=(<span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>)))</span><br><span class="line">model.add(Conv2D(<span class="number">32</span>, kernel_size=<span class="number">3</span>, activation=<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">model.add(Flatten())</span><br><span class="line">model.add(Dense(<span class="number">10</span>, activation=<span class="string">&#x27;softmax&#x27;</span>))</span><br><span class="line">model.summary()</span><br><span class="line"></span><br><span class="line">model.<span class="built_in">compile</span>(loss=<span class="string">&#x27;categorical_crossentropy&#x27;</span>, metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br><span class="line"></span><br><span class="line">x_train_forConv = x_train.reshape(<span class="number">60000</span>,<span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>)</span><br><span class="line">x_test_forConv = x_test.reshape(<span class="number">10000</span>,<span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">history = model.fit(x_train_forConv, y_train_onehot,</span><br><span class="line">                    epochs=<span class="number">20</span>,</span><br><span class="line">                    verbose=<span class="number">1</span>,</span><br><span class="line">                    validation_data=(x_test_forConv, y_test_onehot))</span><br></pre></td></tr></table></figure><pre><code>Model: &quot;sequential_1&quot;_________________________________________________________________Layer (type)                 Output Shape              Param #=================================================================conv2d_2 (Conv2D)            (None, 26, 26, 64)        640_________________________________________________________________conv2d_3 (Conv2D)            (None, 24, 24, 32)        18464_________________________________________________________________flatten_1 (Flatten)          (None, 18432)             0_________________________________________________________________dense_1 (Dense)              (None, 10)                184330=================================================================Total params: 203,434Trainable params: 203,434Non-trainable params: 0_________________________________________________________________Epoch 1/201875/1875 [==============================] - 7s 4ms/step - loss: 0.1776 - accuracy: 0.9570 - val_loss: 0.1147 - val_accuracy: 0.9729Epoch 2/201875/1875 [==============================] - 7s 4ms/step - loss: 0.0854 - accuracy: 0.9766 - val_loss: 0.0864 - val_accuracy: 0.9778Epoch 3/201875/1875 [==============================] - 8s 4ms/step - loss: 0.0745 - accuracy: 0.9797 - val_loss: 0.0905 - val_accuracy: 0.9735Epoch 4/201875/1875 [==============================] - 8s 4ms/step - loss: 0.0724 - accuracy: 0.9802 - val_loss: 0.0919 - val_accuracy: 0.9781Epoch 5/201875/1875 [==============================] - 8s 4ms/step - loss: 0.0700 - accuracy: 0.9812 - val_loss: 0.0837 - val_accuracy: 0.9746Epoch 6/201875/1875 [==============================] - 8s 4ms/step - loss: 0.0690 - accuracy: 0.9818 - val_loss: 0.1036 - val_accuracy: 0.9742Epoch 7/201875/1875 [==============================] - 8s 4ms/step - loss: 0.0690 - accuracy: 0.9818 - val_loss: 0.1009 - val_accuracy: 0.9750Epoch 8/201875/1875 [==============================] - 7s 4ms/step - loss: 0.0689 - accuracy: 0.9819 - val_loss: 0.1134 - val_accuracy: 0.9746Epoch 9/201875/1875 [==============================] - 8s 4ms/step - loss: 0.0700 - accuracy: 0.9819 - val_loss: 0.1004 - val_accuracy: 0.9760Epoch 10/201875/1875 [==============================] - 8s 4ms/step - loss: 0.0692 - accuracy: 0.9826 - val_loss: 0.1298 - val_accuracy: 0.9750Epoch 11/201875/1875 [==============================] - 8s 4ms/step - loss: 0.0681 - accuracy: 0.9827 - val_loss: 0.1055 - val_accuracy: 0.9732Epoch 12/201875/1875 [==============================] - 7s 4ms/step - loss: 0.0688 - accuracy: 0.9820 - val_loss: 0.1205 - val_accuracy: 0.9725Epoch 13/201875/1875 [==============================] - 7s 4ms/step - loss: 0.0682 - accuracy: 0.9830 - val_loss: 0.1140 - val_accuracy: 0.9751Epoch 14/201875/1875 [==============================] - 8s 4ms/step - loss: 0.0671 - accuracy: 0.9830 - val_loss: 0.1266 - val_accuracy: 0.9729Epoch 15/201875/1875 [==============================] - 8s 4ms/step - loss: 0.0664 - accuracy: 0.9831 - val_loss: 0.1417 - val_accuracy: 0.9723Epoch 16/201875/1875 [==============================] - 7s 4ms/step - loss: 0.0639 - accuracy: 0.9837 - val_loss: 0.1319 - val_accuracy: 0.9729Epoch 17/201875/1875 [==============================] - 8s 4ms/step - loss: 0.0670 - accuracy: 0.9837 - val_loss: 0.1290 - val_accuracy: 0.9723Epoch 18/201875/1875 [==============================] - 7s 4ms/step - loss: 0.0668 - accuracy: 0.9840 - val_loss: 0.1517 - val_accuracy: 0.9736Epoch 19/201875/1875 [==============================] - 7s 4ms/step - loss: 0.0625 - accuracy: 0.9849 - val_loss: 0.1545 - val_accuracy: 0.9699Epoch 20/201875/1875 [==============================] - 7s 4ms/step - loss: 0.0640 - accuracy: 0.9845 - val_loss: 0.1448 - val_accuracy: 0.9691</code></pre><p>epoch를 20으로 했더니 train data들은 대부분 loss도 감소하고 accuracy도 증가하지만 <br><br>test data들은 loss도 들쭉날쭉에 accuracy는 감소하기까지한다.<br><br>아직 <code>overfitting</code>의 문제를 해결하지 못했을 뿐만아니라 <code>vanishing/exploding gradient</code>또한 해결하지 못했다. <br><br>이는 다음 실습에서 <code>batchnormalization</code>과 <code>dropdout</code>에 대해 공부해보고 좀 더 지켜보도록 하겠다.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">90</span></span><br><span class="line">plt.imshow(x_test[n].reshape(<span class="number">28</span>, <span class="number">28</span>), cmap=<span class="string">&#x27;Greys&#x27;</span>, interpolation=<span class="string">&#x27;nearest&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;정답은 : &#x27;</span>, np.argmax(model.predict(x_test[n].reshape((<span class="number">1</span>,<span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>)))))</span><br></pre></td></tr></table></figure><p><img src="/image/output_25_0.png" alt="png"></p><center>정답은 :  3</center><p>랜덤하게 추출해서 확인해보자.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">use_samples = np.random.randint(<span class="number">5000</span>,size = <span class="number">16</span>)</span><br><span class="line">samples_to_predict = []</span><br><span class="line"></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line">nrows = ncols = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize = (<span class="number">12</span>,<span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> sample <span class="keyword">in</span> use_samples:</span><br><span class="line">  count+=<span class="number">1</span></span><br><span class="line">  plt.subplot(nrows,ncols,count)</span><br><span class="line">  reshaped_image = x_test[sample].reshape((<span class="number">28</span>, <span class="number">28</span>))</span><br><span class="line">  plt.imshow(reshaped_image,cmap=<span class="string">&#x27;Greys&#x27;</span>, interpolation=<span class="string">&#x27;nearest&#x27;</span>)</span><br><span class="line">  samples_to_predict.append(x_test[sample])</span><br><span class="line">  tmp = <span class="string">&quot;Label:&quot;</span> + <span class="built_in">str</span>(y_test[sample]) + <span class="string">&quot;, Prediction:&quot;</span> + <span class="built_in">str</span>(np.argmax(model.predict(x_test[sample].reshape((<span class="number">1</span>,<span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>)))))</span><br><span class="line">  plt.title(tmp)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="/image/output_27_0.png" alt="png"></p><p>약간의 오차가 있는 듯하다. 이는 다른 <code>Layer</code>들을 공부하면서 줄여보도록 하겠다.</p><p>그리고 리소스반환도 필수다!</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> IPython</span><br><span class="line">app = IPython.Application.instance()</span><br><span class="line">app.kernel.do_shutdown(<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><pre><code>&#123;&#39;status&#39;: &#39;ok&#39;, &#39;restart&#39;: True&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> AAIS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AAIS </tag>
            
            <tag> tensorflow </tag>
            
            <tag> jupyter-notebook </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Algorithm] 오픈채팅방</title>
      <link href="2021/01/20/algorithm-02/"/>
      <url>2021/01/20/algorithm-02/</url>
      
        <content type="html"><![CDATA[<h1 id="오픈채팅방-2019-KAKAO-BLIND-RECRUITMENT"><a href="#오픈채팅방-2019-KAKAO-BLIND-RECRUITMENT" class="headerlink" title="오픈채팅방 (2019 KAKAO BLIND RECRUITMENT)"></a>오픈채팅방 (2019 KAKAO BLIND RECRUITMENT)</h1><hr><h2 id="문제설명"><a href="#문제설명" class="headerlink" title="문제설명"></a>문제설명</h2><p>카카오톡 오픈채팅방에서는 친구가 아닌 사람들과 대화를 할 수 있는데, 본래 닉네임이 아닌 가상의 닉네임을 사용하여 채팅방에 들어갈 수 있다.</p><p>신입사원인 김크루는 카카오톡 오픈 채팅방을 개설한 사람을 위해, 다양한 사람들이 들어오고, 나가는 것을 지켜볼 수 있는 관리자창을 만들기로 했다. 채팅방에 누군가 들어오면 다음 메시지가 출력된다.</p><p>[닉네임]님이 들어왔습니다.</p><p>채팅방에서 누군가 나가면 다음 메시지가 출력된다.</p><p>[닉네임]님이 나갔습니다.</p><p>채팅방에서 닉네임을 변경하는 방법은 다음과 같이 두 가지이다.</p><p>채팅방을 나간 후, 새로운 닉네임으로 다시 들어간다.<br>채팅방에서 닉네임을 변경한다.<br>닉네임을 변경할 때는 기존에 채팅방에 출력되어 있던 메시지의 닉네임도 전부 변경된다.</p><p>예를 들어, 채팅방에 Muzi와 Prodo라는 닉네임을 사용하는 사람이 순서대로 들어오면 채팅방에는 다음과 같이 메시지가 출력된다.</p><p>Muzi님이 들어왔습니다.<br>Prodo님이 들어왔습니다.</p><p>채팅방에 있던 사람이 나가면 채팅방에는 다음과 같이 메시지가 남는다.</p><p>Muzi님이 들어왔습니다.<br>Prodo님이 들어왔습니다.<br>Muzi님이 나갔습니다.</p><p>Muzi가 나간후 다시 들어올 때, Prodo 라는 닉네임으로 들어올 경우 기존에 채팅방에 남아있던 Muzi도 Prodo로 다음과 같이 변경된다.</p><p>Prodo님이 들어왔습니다.<br>Prodo님이 들어왔습니다.<br>Prodo님이 나갔습니다.<br>Prodo님이 들어왔습니다.</p><p>채팅방은 중복 닉네임을 허용하기 때문에, 현재 채팅방에는 Prodo라는 닉네임을 사용하는 사람이 두 명이 있다. 이제, 채팅방에 두 번째로 들어왔던 Prodo가 Ryan으로 닉네임을 변경하면 채팅방 메시지는 다음과 같이 변경된다.</p><p>Prodo님이 들어왔습니다.<br>Ryan님이 들어왔습니다.<br>Prodo님이 나갔습니다.<br>Prodo님이 들어왔습니다.</p><p>채팅방에 들어오고 나가거나, 닉네임을 변경한 기록이 담긴 문자열 배열 record가 매개변수로 주어질 때, 모든 기록이 처리된 후, 최종적으로 방을 개설한 사람이 보게 되는 메시지를 문자열 배열 형태로 return 하도록 solution 함수를 완성하라.</p><h2 id="제한사항"><a href="#제한사항" class="headerlink" title="제한사항"></a>제한사항</h2><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">record는 다음과 같은 문자열이 담긴 배열이며, 길이는 1 이상 100,000 이하이다.</span><br><span class="line">다음은 record에 담긴 문자열에 대한 설명이다.</span><br><span class="line"> - 모든 유저는 [유저 아이디]로 구분한다.</span><br><span class="line"> - [유저 아이디] 사용자가 [닉네임]으로 채팅방에 입장 - Enter [유저 아이디] [닉네임] (ex. Enter uid1234 Muzi)</span><br><span class="line"> - [유저 아이디] 사용자가 채팅방에서 퇴장 - Leave [유저 아이디] (ex. Leave uid1234)</span><br><span class="line"> - [유저 아이디] 사용자가 닉네임을 [닉네임]으로 변경 - Change [유저 아이디] [닉네임] (ex. Change uid1234 Muzi)</span><br><span class="line"> - 첫 단어는 Enter, Leave, Change 중 하나이다.</span><br><span class="line"> - 각 단어는 공백으로 구분되어 있으며, 알파벳 대문자, 소문자, 숫자로만 이루어져있다.</span><br><span class="line"> - 유저 아이디와 닉네임은 알파벳 대문자, 소문자를 구별한다.</span><br><span class="line"> - 유저 아이디와 닉네임의 길이는 1 이상 10 이하이다.</span><br><span class="line"> - 채팅방에서 나간 유저가 닉네임을 변경하는 등 잘못 된 입력은 주어지지 않는다.</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left"><center>record</center></th><th align="center"><center>result</center></th></tr></thead><tbody><tr><td align="left">[“Enter uid1234 Muzi”, “Enter uid4567 Prodo”,”Leave uid1234”,”Enter uid1234 Prodo”,”Change uid4567 Ryan”]</td><td align="center"><center>[“Prodo님이 들어왔습니다.”, “Ryan님이 들어왔습니다.”, “Prodo님이 나갔습니다.”, “Prodo님이 들어왔습니다.”] </center></td></tr></tbody></table><h2 id="문제풀이"><a href="#문제풀이" class="headerlink" title="문제풀이"></a>문제풀이</h2><hr><p>문제풀이가 굉장히 간단해보였다. 나는 하드코딩을 하였지만 그래도 쉽게 풀릴 것이라 생각했다.<br>제한사항을 읽어봤더니 Enter, Change, Leave로 분기만 하면될 것이라 생각했다.</p><ol><li>Enter<ul><li>userId를 검색하여 이미 존재하는 id라면 모든 이름을 바꾼 후 추가</li><li>존재하지 않는다면 추가</li></ul></li><li>Change<ul><li>userId를 검색하여 이름을 모두 바꿈</li></ul></li><li>Leave<ul><li>userId를 검색하여 추가</li></ul></li></ol><p>우선 Leave는 id만 존재하고 닉네임이 존재하지 않아 벡터에 추가하였다.<br>그리고 맨마지막엔 translation을 하는 과정을 추가하였다.<br>따라서 다음과 같이 풀이하였다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;string&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">bool find(string s, string name ,vector&lt;vector&lt;string&gt;&gt; &amp;before) &#123;</span><br><span class="line">    bool answer &#x3D; false;</span><br><span class="line">    for (int i &#x3D; 0; i &lt; before.size(); i++) &#123;</span><br><span class="line">        if (before[i][1] &#x3D;&#x3D; s) &#123;</span><br><span class="line">            answer &#x3D; true;</span><br><span class="line">            before[i][2] &#x3D; name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return answer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">string append(string s, vector&lt;vector&lt;string&gt;&gt;&amp; before) &#123;</span><br><span class="line">    for (int i &#x3D; 0; i &lt; before.size(); i++) &#123;</span><br><span class="line">        if (before[i][1] &#x3D;&#x3D; s)</span><br><span class="line">            return before[i][1];</span><br><span class="line">    &#125;</span><br><span class="line">    return &quot;잘못된 입력&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void change(string s, string name,vector&lt;vector&lt;string&gt;&gt;&amp; before) &#123;</span><br><span class="line">    for (int i &#x3D; 0; i &lt; before.size(); i++) &#123;</span><br><span class="line">        if (before[i][1] &#x3D;&#x3D; s)</span><br><span class="line">            before[i][2] &#x3D; name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vector&lt;string&gt; solution(vector&lt;string&gt; record) &#123;</span><br><span class="line">    vector&lt;string&gt; answer;</span><br><span class="line">    vector&lt;vector&lt;string&gt;&gt; word;</span><br><span class="line">    vector&lt;vector&lt;string&gt;&gt; before;</span><br><span class="line"></span><br><span class="line">    for (int i &#x3D; 0; i &lt; record.size(); i++) &#123;</span><br><span class="line">        vector&lt;string&gt; s;</span><br><span class="line">        int count &#x3D; 0;</span><br><span class="line">        for (int j &#x3D; 0; j &lt; record[i].size()+1; j++) &#123;</span><br><span class="line">            if (record[i][j] &#x3D;&#x3D; &#39; &#39; || j&#x3D;&#x3D;record[i].size()) &#123;</span><br><span class="line">                s.emplace_back(record[i].substr(count, j-count));</span><br><span class="line">                count &#x3D; j + 1;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        word.emplace_back(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (int i &#x3D; 0; i &lt; word.size(); i++) &#123;</span><br><span class="line">        if (word[i][0] &#x3D;&#x3D; &quot;Enter&quot;) &#123;</span><br><span class="line">            if (find(word[i][1],word[i][2], before)) &#123;</span><br><span class="line">                before.emplace_back(word[i]);</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">                before.emplace_back(word[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        else if (word[i][0] &#x3D;&#x3D; &quot;Leave&quot;) &#123;</span><br><span class="line">            word[i].emplace_back(append(word[i][1], before));</span><br><span class="line">            before.emplace_back(word[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            change(word[i][1],word[i][2], before);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for (int i &#x3D; 0; i &lt; before.size(); i++) &#123;</span><br><span class="line">        string s;</span><br><span class="line">        s.append(before[i][2]);</span><br><span class="line">        s.append(&quot;님이 &quot;);</span><br><span class="line">        if (before[i][0] &#x3D;&#x3D; &quot;Enter&quot;) s.append(&quot;들어왔습니다.&quot;);</span><br><span class="line">        else s.append(&quot;나갔습니다.&quot;);</span><br><span class="line">        answer.emplace_back(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return answer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>일단 결과가 매우 안좋았다. 실패하는 경우도 있었을 뿐만 아니라 시간초과도 떴기 때문이다.</p><p>모를 땐 빨리 구글링이 답이다.</p><h3 id="BEST"><a href="#BEST" class="headerlink" title="BEST "></a><center><a href="https://life-with-coding.tistory.com/395">BEST</a> </center></h3><p>내가 처음보는 STL이 있었다.</p><hr><h3 id="StringStream"><a href="#StringStream" class="headerlink" title="StringStream"></a>StringStream</h3><p>해당 자료형에 맞는 필요한 정보를 추출하는 stream 클래스이다.<br><sstream>헤더파일이 필요하다.</p><p>stringstream 연산자/함수</p><ul><li>“&gt;&gt;” : 데이터를 추출하는 연산자</li><li>“&lt;&lt;” : 데이터를 삽입하는 연산자</li><li>“obj.str(target)” : obj의 string을 변환하여 target에 저장</li></ul><hr><h3 id="해결코드"><a href="#해결코드" class="headerlink" title="해결코드"></a>해결코드</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;string&gt;</span><br><span class="line">#include &lt;sstream&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">#include &lt;map&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">map&lt;string, string&gt; m;</span><br><span class="line"></span><br><span class="line">vector&lt;string&gt; solution(vector&lt;string&gt; record)</span><br><span class="line">&#123;</span><br><span class="line">    vector&lt;string&gt; answer;</span><br><span class="line">    string id, name, state;</span><br><span class="line">    stringstream ss;</span><br><span class="line"></span><br><span class="line">    for(int i&#x3D;0;i&lt;record.size();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ss.str(record[i]);</span><br><span class="line">        ss &gt;&gt; state; ss &gt;&gt; id; ss &gt;&gt; name;</span><br><span class="line">        if(state &#x3D;&#x3D; &quot;Enter&quot; || state &#x3D;&#x3D; &quot;Change&quot;)&#123;</span><br><span class="line">            m[id] &#x3D; name;</span><br><span class="line">        &#125;</span><br><span class="line">        ss.clear();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for(int i&#x3D;0;i&lt;record.size();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ss.str(record[i]);</span><br><span class="line">        ss &gt;&gt; state; ss &gt;&gt; id;</span><br><span class="line">        name &#x3D; m[id];</span><br><span class="line">        if(state &#x3D;&#x3D; &quot;Enter&quot;) &#123;</span><br><span class="line">            answer.push_back(name + &quot;님이 들어왔습니다.&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        if(state &#x3D;&#x3D; &quot;Leave&quot;)&#123;</span><br><span class="line">            answer.push_back(name + &quot;님이 나갔습니다.&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        ss.clear();</span><br><span class="line">    &#125;</span><br><span class="line">    return answer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>새로운 STL을 발견하여 기분은 좋았다. 빨리 코딩하려다보니 해시도 까먹고 후다닥 처리하다보니 저런 망작이 나왔다.<br>위의 코드를 참고하여 다른 문제들에 적용시켜보도록 해야겠다.</p>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Algorithm </tag>
            
            <tag> Programmers </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Java]Day02 - 자바 데이터타입,변수 그리고 배열</title>
      <link href="2021/01/20/java-day2/"/>
      <url>2021/01/20/java-day2/</url>
      
        <content type="html"><![CDATA[<h2 id="Review-Day01"><a href="#Review-Day01" class="headerlink" title="Review Day01"></a>Review Day01</h2><p>오늘 포스트에 앞서 지난 시간에 다뤘던 Compile에 대해서 다시 한 번 다뤄보겠다.</p><blockquote><p>Q1. java14로 compile한 파일을 java8로 실행하면 어떻게 될 것인가?<br>Q2. java8로 compile한 파일을 java14로 실행하면 어떻게 될 것인가?</p></blockquote><p>Q1의 정답은 <code>Error</code>, Q2의 정답은 <code>Success</code>이다. 쉽게 생각하면 낮은 버젼의 컴파일러로 컴파일 시 높은 버젼의 자바로 실행은 가능하지만 높은 버젼의 컴파일러로 컴파일 시 낮은 버젼의 자바로 실행은 불가능하다.</p><blockquote><p>Q3. 그렇다면 java14버젼으로 compile시에는 java8로는 절대 실행불가능한 것인가?</p></blockquote><p>Q3의 정답은 <code>False</code>이다. <code>javac -source 1.6 -target 1.6</code>옵션을 줌으로써 컴파일시 실행도 가능해진다. 높은 버젼에서만 사용할 수 있는 기능도 컴파일러가 낮은버젼에 호환되도록 컴파일을 하기 때문에 실행이 가능하지는것이다. (모든 기능이 가능한 것은 아니니까 굳이 그러진말자!)<br>그러나 정말 안타깝게도, 일부 Maven plugin이 간혹 특정버젼으로 만들어지고 낮은버젼으로 호환이 안되어 프로젝트 시 확인을 해야한다.</p><p>높은 버젼의 컴파일시 낮은 버젼으로 실행하면 다음과 같은 에러가 뜬다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Error: A JNI error has occurred, please check your installation and try again</span><br><span class="line">Exception in thread &quot;main&quot; java.lang.InsupportedClassVersionError: 파일명 has been compiled by a more recent version of the Java Runtime (class file version 58.0), this version of the Java Runtime only recognizes class file versions up to 52.0</span><br></pre></td></tr></table></figure><p>이는 위에 설명했던 그대로의 말을 의미한다.</p><blockquote><p>Q4. javac는 어디에 들어있는가?</p></blockquote><p>Q4의 정답은 <code>JDK</code>이다. <code>compile</code>을 하는 것은 개발자의 몫이기 때문에 JDK에만 들어가있다. JAVA9부터는 JRE는 따로 배포 안하므로 나중에 확인해보자.</p><blockquote><p>Q5. 바이트코드는 왜 바이트코드에요?</p></blockquote><p>Q5의 정답은 <code>opcode가 1바이트이기 때문</code>이다. 시스템프로그래밍 수업을 들었다면 알겠지만 기계어로 바꾸는 과정 중에 바이트코드나 어셈블리어같은 것들은 opcode라는 것이 존재한다. 이것이 1바이트이기 때문에 바이트코드라고 한다. 또한, <strong>java뿐만 아니라 다른 언어</strong>들도 적절한 컴파일러로 통해 바이트코드로 변환이 된다면 jvm은 이를 실행할 수 있다.</p><hr><h2 id="Day02-자바-데이터-타입-변수-그리고-배열"><a href="#Day02-자바-데이터-타입-변수-그리고-배열" class="headerlink" title="Day02. 자바 데이터 타입, 변수 그리고 배열"></a>Day02. 자바 데이터 타입, 변수 그리고 배열</h2><hr><h3 id="프리미티브-타입-종류와-값의-범위-그리고-기본-값"><a href="#프리미티브-타입-종류와-값의-범위-그리고-기본-값" class="headerlink" title="프리미티브 타입 종류와 값의 범위 그리고 기본 값"></a>프리미티브 타입 종류와 값의 범위 그리고 기본 값</h3><p>변수의 타입에는 크게 두가지로 나눌 수 있다.</p><ol><li>Primitive Type</li><li>Reference Type</li></ol><p>이중 Primitive Type에는 총 8개의 타입이 있으며, 크게 논리형, 문자형, 정수형, 실수형으로 구분된다.<br>문자형인 char는 문자를 내부적으로 정수(유니코드)로 저장하기 때문에 정수형과 별반 다르지 않으며, <strong>정수형 또는 실수형과 연산도 가능하다.</strong> 반면에 boolean은 다른 기본형과의 연산이 불가능하다. 즉, boolean을 제외한 나머지 7개의 기본형은 서로 연산과 변환이 가능하다. 정수는 가장 ㅁ많이 사용되므로 타입을 4가지나 제공한다. 각 타입마다 저장할 수 있는 값의 범위가 다르므로 저장할 값의 범위에 맞는 타입을 선택하면 되지만, 일반적으로 int를 많이 사용한다. 왜냐하면, int는 CPU가 가장 효율적으로 처리할 수 있는 타입이기 때문이다. 효율적인 실행보다 메모리를 절약하려면, byte나 short를 선택하자.</p><p>Reference Type은 다음과 같다.</p><blockquote><p>“The basic difference is that primitive variables store the actual values, whereas reference variables store the addresses of the objects they refer to.”    <a href="https://stackoverflow.com/a/32049775">출처</a></p></blockquote><h3 id="상수와-리터럴"><a href="#상수와-리터럴" class="headerlink" title="상수와 리터럴"></a>상수와 리터럴</h3><p>‘상수(constant)’는 변수와 마찬가지로 ‘값을 저장할 수 있는 공간’이다. 하지만 말그대로 변수는 변할 수 있는 공간이지만 상수는 변할 수 없는 공간이다. 상수의 이름은 모두 <strong>대문자</strong>로 하는 것이 암묵적인 관례이며, 여러 단어로 이루어져있는경우 ‘_’로 구분한다. (ex. <code>final int MAX_SPEED</code>)<br>‘리터럴(literal)’은 상수와 구분짓기 위해 만든 것으로 그 자체로 값을 의미한다.</p><blockquote><p>“A literal is the source code representation of a fixed value; literals are represented directly in your code without requiring computation. As shown below, it’s possible to assign a literal to a variable of a primitive type”   <a href="https://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html">출처</a></p></blockquote><h3 id="변수의-스코프와-라이프타임"><a href="#변수의-스코프와-라이프타임" class="headerlink" title="변수의 스코프와 라이프타임"></a>변수의 스코프와 라이프타임</h3><p>변수의 스코프란 말그대로 스코프이다. 즉, 변수가 살아있는 범위에 대해 말하는 것이다. 라이프타임과 스코프는 붙어다니는 단어들이다.<br>이제 우리는 변수를 instance, static, local로 나눌 수 있는데 이는 다음과 같이 쓸 수 있다. <a href="https://www.tutorialspoint.com/scope-and-lifetime-of-variables-in-java">출처</a></p><ol><li><p>Instance Variable<br>Scope : throughout the class except in static methods<br>Lifetime : until the object stays in memory.</p></li><li><p>Static(Class) Variable<br>Scope : throughout the class<br>Lifetime : until the end of the program or as long as the class is loaded in memory.</p></li><li><p>Local Variable<br>Scope : within the block in which it is declared<br>Lifetime : until the control leaves the block in which it is declared.</p></li></ol><h3 id="타입-변환-캐스팅-그리고-타입-프로모션"><a href="#타입-변환-캐스팅-그리고-타입-프로모션" class="headerlink" title="타입 변환, 캐스팅 그리고 타입 프로모션"></a>타입 변환, 캐스팅 그리고 타입 프로모션</h3><p>타입 변환이란 말 그대로 타입 변환이다.(Dejavu..) byte로 선언했던 변수를 int 또는 기타 type으로 변환시키는 것이다. 하지만 이는 굉장히 중요한 문제이다. C를 처음 접했었다면 처음에 부딪혔던 난관이 있을것이다. 0.5를 표현하는 것이다. int형 변수 a,b를 각각 1, 2로 했다면 우리는 0.5는 당연히 a/b일 것이라 생각했겠지만 절대 0.5가 출력되지 않는다. 이는 변수의 자료형이 int로 반환되기 때문에 절대 원하는 값인 0.5가 아닌 0이 출력이 되었던걸 경험했을 것이다. 그래서 필요한 것이 이런 타입변환이다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">double c &#x3D; (double)(a&#x2F;b);</span><br></pre></td></tr></table></figure><p>이런식으로 하는 것이 캐스팅이다. 굉장히 간단하지 않은가? 원하는 타입으로 앞에 괄호를 붙여쓰기만 하면되는 것이다.<br>하지만 세상은 그렇게 녹록치 않다. boolean을 제외한 Primitive Type간에는 자유롭게 변환이 가능하지만(물론 데이터 손실은 있을 수 있다.)  Primitive Type간에도 형변환을 하는것이 원칙이지만, 값의 범위가 작은 타입에서 큰 타입으로의 형변환은 생략이 가능하다. Reference Type간에는 implicit up-casting, explicit down-casting이 이루어진다.</p><h3 id="1차-및-2차-배열-선언하기"><a href="#1차-및-2차-배열-선언하기" class="headerlink" title="1차 및 2차 배열 선언하기"></a>1차 및 2차 배열 선언하기</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">int[] a &#x3D; &#123;1,2,3&#125;;</span><br><span class="line">int[][] b &#x3D; &#123;&#123;2,3,4&#125;,&#123;5,6,7&#125;&#125;;</span><br><span class="line">이부분은 이정도로만 해두고 다음시간에 Review를 통해 더 자세히 다뤄보도록 하겠다.</span><br></pre></td></tr></table></figure><h3 id="타입-추론-var"><a href="#타입-추론-var" class="headerlink" title="타입 추론, var"></a>타입 추론, var</h3><p>코틀린을 써보며 자주 사용했던 <code>var</code>이다. 그때는 뭔지도 모르고 무조건! <code>var</code>로 선언했었다. 물론 차이가 있겠지만 우선 자바로 배워보도록 하겠다. 우선 <code>var</code>은 java10에서 생겨난 것이다. <code>var</code>로 선언한다면 런타임시 변수의 종류를 파악해 알아서 변환시켜준다.  타입추론이란 자바자체적으로 어떤 타입인지 예측하고, 그것을 사용하는 것을 의미한다.</p><p> <a href="https://johngrib.github.io/wiki/java10-var/">올바른 사용과 잘못된 사용</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;            <span class="comment">// Legal</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="number">2</span>, c = <span class="number">3.0</span>;   <span class="comment">// Illegal: multiple declarators</span></span><br><span class="line"><span class="keyword">var</span> d[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">4</span>]; <span class="comment">// Illegal: extra bracket pairs</span></span><br><span class="line"><span class="keyword">var</span> e;                <span class="comment">// Illegal: no initializer</span></span><br><span class="line"><span class="keyword">var</span> f = &#123; <span class="number">6</span> &#125;;        <span class="comment">// Illegal: array initializer</span></span><br><span class="line"><span class="keyword">var</span> g = (g = <span class="number">7</span>);      <span class="comment">// Illegal: self reference in initializer</span></span><br></pre></td></tr></table></figure><p> <a href="https://johngrib.github.io/wiki/java10-var/">타입</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;                <span class="comment">// a has type &#x27;int&#x27;</span></span><br><span class="line"><span class="keyword">var</span> b = java.util.List.of(<span class="number">1</span>, <span class="number">2</span>);  <span class="comment">// b has type &#x27;List&lt;Integer&gt;&#x27;</span></span><br><span class="line"><span class="keyword">var</span> c = <span class="string">&quot;x&quot;</span>.getClass();</span><br><span class="line">                          <span class="comment">// (see JLS 15.12.2.6)</span></span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> Object() &#123;&#125;;  <span class="comment">// d has the type of the anonymous class</span></span><br><span class="line"><span class="keyword">var</span> e = (CharSequence &amp; Comparable&lt;String&gt;) <span class="string">&quot;x&quot;</span>;</span><br><span class="line">                          <span class="comment">// e has type CharSequence &amp; Comparable&lt;String&gt;</span></span><br><span class="line"><span class="keyword">var</span> f = () -&gt; <span class="string">&quot;hello&quot;</span>;    <span class="comment">// Illegal: lambda not in an assignment context</span></span><br><span class="line"><span class="keyword">var</span> g = <span class="keyword">null</span>;             <span class="comment">// Illegal: null type</span></span><br></pre></td></tr></table></figure><p>엄청 편해보여서 모든 변수를 var로 선언해버리는 것이 어떻겠냐는 생각을 할 수 있겠지만 아쉽게도 그러면 안된다. 예상치못한 에러에 대처할 수 없어진다. 그렇다면 언제 사용하는 것이냐?에 대해서는 <a href="https://velog.io/@composite/Java-10-%EC%97%90%EC%84%9C-var-%EC%9E%AC%EB%8C%80%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0">다음의 글</a>을 살펴보는 것이 좋겠다. <code>제네릭</code>,<code>람다</code>,<code>foreach</code>구문 등 쓰는 부분이 굉장히 많다. 이는 추후에 더 자세히 다뤄보도록 하겠다.</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java8 </tag>
            
            <tag> java10 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AAIS]Intro.</title>
      <link href="2021/01/19/aais-00/"/>
      <url>2021/01/19/aais-00/</url>
      
        <content type="html"><![CDATA[<h1 id="In-AAIS-Advanced-Application-for-Intelligence-Systems-Lab-at-Hanyang-University"><a href="#In-AAIS-Advanced-Application-for-Intelligence-Systems-Lab-at-Hanyang-University" class="headerlink" title="In AAIS(Advanced Application for Intelligence Systems) Lab at Hanyang University"></a>In AAIS(Advanced Application for Intelligence Systems) Lab at Hanyang University</h1><h2 id="들어가기에-앞서"><a href="#들어가기에-앞서" class="headerlink" title="들어가기에 앞서"></a>들어가기에 앞서</h2><p>이번 겨울방학에 무엇을 해야할 지 굉장히 생각이 많았다. 자바백엔드개발자로써 시작을 위해 자바8,스프링부트를 시작했고 이제 코딩테스트도 준비해야한다 생각해서 <code>Programmers</code>와 <code>Leetcode</code>의 코딩테스트 연습문제를 풀고 있다. 또한, 도커를 공부할 것이다.<br>아직 끝나지 않았다. 봉사활동도 하지않아서 봉사활동(온라인..)도 신청했고 계절학기도 신청해서 오늘자(210119)로 마무리 됐다. (선형대수 만세)<br>이렇게 할게 많은 와중에 노영균교수님께서 AAIS LAB 인턴을 모집하셔서 바로 신청을 했다.<br>비록 늦게 신청을 했지만 교수님께서 받아주셔서 인턴으로써 활동을 하게 되었다.</p><blockquote><p>이번방학 할 목록</p></blockquote><ol><li>AAIS LAB 인턴</li><li>JAVA8</li><li>스프링부트</li><li>도커</li><li>코딩테스트준비</li><li>봉사활동</li><li><del>계절학기</del></li></ol><p>일단 목표는 크게 잡고 하나씩 쳐낼(?) 것이다. 아직까지는 만족스러운 방학생활이다.</p><p>근황은 이쯤에서 마무리하고, 랩실에서 할 내용에 대해 간략히 정리해보겠다.</p><h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>내가 다룰 주제는 <a href="https://www.nature.com/articles/s41598-020-80182-8">Age-gruop determination of living individuals using first molar images based on artificial intelligence</a>이다.<br>교수님께서 가장 쉽게 구현할 수 있다고 강조해주신 자료이다. 아직 텐서플로우는 커녕 이론도 잘 모르는 상태라 가장 끌렸다. 이것은 두번째 이유이고 첫번째로는 <strong>재미</strong>있어보였다. 추리장르를 좋아하는 사람으로써 치아의 나이를 추론한다는 내용은 굉장히 흥미로웠기 때문이다.</p><h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><blockquote><p>Dental age estimation of living individuals is difcult and challenging, and there is no consensus method in adults with permanent dentition. Thus, we aimed to provide an accurate and robust artifcial intelligence (AI)-based diagnostic system for age-group estimation by incorporating a convolutional neural network (CNN) using dental X-ray image patches of the frst molars extracted via panoramic radiography. The data set consisted of four frst molar images from the right and left sides of the maxilla and mandible of each of 1586 individuals across all age groups, which were extracted from their panoramic radiographs. The accuracy of the tooth-wise estimation was 89.05 to 90.27%. Performance accuracy was evaluated mainly using a majority voting system and area under curve (AUC) scores. The AUC scores ranged from 0.94 to 0.98 for all age groups, which indicates outstanding capacity. The learned features of CNNs were visualized as a heatmap, and revealed that CNNs focus on diferentiated anatomical parameters, including tooth pulp, alveolar bone level, or interdental space, depending on the age and location of the tooth. With this, we provided a deeper understanding of the most informative regions distinguished by age groups. The prediction accuracy and heat map analyses support that this AI-based age-group determination model is plausible and useful.</p></blockquote><p>내가 정말 정말 간단하게 요약하자면 1586명의 첫번째 어금니 4개를 데이터를 통해 나이구간을 추정한다는 것이다. 특정한 나이를 구하는 것이 아니라 나이구간을 구한다. CNN을 통해 학습시키며 잇속(tooth pulp), 이틀뼈(alveolar bone level), 또는 수특부(interdental space)를 <strong>나이와 치아의 위치</strong>에 따라 파라미터로 받는다.<br>여기서 중요하게 봐야할 것은 convolutional neural network(CNN)과 파라미터를 다르게 받는다는 점이다. 모든 이를 같은 특징을 통해 구별하는 것이 아니라 나이대, 치아의 위치에 따라서 다르게 구별한다는 것이다. 이는 나중에 다루고(잘 모른다..) 이번 포스트에서는 CNN으로 간단하게 시작해보겠다.</p><h2 id="CNN-Convolutional-Neural-Network"><a href="#CNN-Convolutional-Neural-Network" class="headerlink" title="CNN(Convolutional Neural Network)"></a>CNN(Convolutional Neural Network)</h2><p align="center"><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FnIswa%2FbtqFrmYm9zI%2FcF0xZms06Zkdjy95Bt0K8k%2Fimg.gif"></p><p>위 그림과 같이 일반적으로 CNN모델은 3 * 3 필터를 주로 사용한다. 위 그림에서는 3개의 channel에서 3개의 convolutional filter를 사용하여 곱을하고 그 결과를 모두 합하는 것이다.<br>위에서의 곱이란 Convolution Product(합성곱)을 말한다. 그 수학적 공식은 다음과 같다.</p><p align="center"><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fd6EbAa%2FbtqFpBf5GwW%2Fb2ne6NbSP2mbQA9hT0NvpK%2Fimg.jpg"></p><br><p>수학적인 얘기는 아직 잘 모를뿐더러 나는 이론적인 얘기보단 용도와 결과에 대해서만 우선! 다룰 것이다.</p><p align="center"><img src="https://blogfiles.pstatic.net/20160105_9/laonple_14519535933045r2XJ_JPEG/%C0%CC%B9%CC%C1%F6_207.jpg?type=w2" height = "300px" width = "600px"></p><p align="center"><img src="https://blogfiles.pstatic.net/20160105_103/laonple_1451953593820FopUd_JPEG/%C0%CC%B9%CC%C1%F6_208.jpg?type=w2" height = "300px" width = "600px"></p><p>CNN을 사용하는 이유는 위의 그림에서의 이유가 가장 크다. 같은 A라는 문자를 입력한다 해도 한 픽셀만 translation되어도 다른 이미지로 인식을 하기 때문에 문제가 된다. data가 굉장히 많아 많은 양을 학습시켰다고 하더라도 약간이라도 translation된다면 전혀 모르는 데이터가 되기 때문이다. 따라서 이를 사용하게 된다.</p><p>앞선 움짤(.gif)을 봤듯이 필터를 이용하여 얻은 output을 Maxpooling Layer을 통과시켜 이미지의 특징점을 잡을 수 있다고 한다.</p><p>여기서 Pooling Layer란 차례로 처리되는 데이터의 크기를 줄이는 것을 말한다. 이 과정으로 모델의 전체 파라미터의 수를 크게 줄일 수 있다.<br>풀링에는 MaxPooling과 AveragePooling이 존재하는데, MaxPooling은 해당 영역에서 최댓값을 찾는 방법이고, AveragePooling은 해당 영역의 평균값을 계산하는 방법이다.<br>이러한 과정을 거치는 이유에 대해서 잠깐 말하자면 더 높은 정확도를 위해서는 필터가 많아야 하는데, 필터가 늘어날 수록 Feature Map이 늘어난다.이는 딥러닝 모델의 Dimension이 늘어난다는 것이고, High Dimension 모델은 그만큼 파라미터의 수 또한 늘어난는 것이다.이는 Over fitting의 문제점 뿐만이 아니라, 모델의 사이즈와 레이턴시에도 큰 영향을 끼친다. 따라서 차원을 감소시킬 필요성이 있는데,이것을 하는 방법이 Pooling Layer를 활용하는 것이다. 오버피팅에 대해서는 다음에 또 batchnormalization을 다루며 할것이다.</p><p>우선 간단하게 정리한 내용은 위와 같다. 아직 모르는 내용도 많고 겉핥기식 공부라 많이 부족한 글이다. 나중에 이 글을 봤을 때 조금이나마 노력했다라는 생각이 들었다면 오늘의 나는 만족할 것이다.</p>]]></content>
      
      
      <categories>
          
          <category> AAIS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AAIS </tag>
            
            <tag> tensorflow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Java]Day01 - JVM이란?</title>
      <link href="2021/01/19/java-day1/"/>
      <url>2021/01/19/java-day1/</url>
      
        <content type="html"><![CDATA[<h2 id="1-JVM이란"><a href="#1-JVM이란" class="headerlink" title="1. JVM이란?"></a>1. JVM이란?</h2><h3 id="JVM의-용도와-정의"><a href="#JVM의-용도와-정의" class="headerlink" title="JVM의 용도와 정의"></a>JVM의 용도와 정의</h3><hr><p>JVM에는 2가지 기본 기능이 있다.<br> 첫번째로 자바 프로그램이 어느 기기, 또는 어느 운영체제 상에서도 실행될 수 있게 하는 것과 프로그램 메모리를 관리하고 최적화하는 것이다. 이에 대해서는 JVM 구성요소에서 자세히 다뤄보겠다.<br> 가장 유명한 원칙인 “한 번 작성해, 어디에서나 실행한다.(Write Once, Run Anywhere, WORA)”가 바로 이것이다. 즉, 자바 애플리케이션은 JVM 위에서 동작하기 때문에 JVM에 종속적이나, OS와 하드웨어와는 독립적이라 프로그램의 변경없이 실행이 가능하다.<br>자바가 나온 시점에는 메모리관리와 OS와 하드웨어 의존성이 있었기 때문에 이는 큰 장점이기도 했다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- 기술적 정의 : JVM은 코드를 실행하고 해당 코드에 대해 런타임 환경을 제공하는 소프트웨어 프로그램에 대한 사양(Specification)이다.</span><br><span class="line">- 일반적 정의 : JVM은 자바 프로그램을 실행하는 방법이다. JVM의 설정을 구성한 다음 설정사항에 따라 실행 중에 프로그램 리소스를 관리한다.</span><br></pre></td></tr></table></figure><h3 id="Garbage-Collection"><a href="#Garbage-Collection" class="headerlink" title="Garbage Collection"></a><strong>Garbage Collection</strong></h3><p> 자바 이전에는 프로그래머가 모든 프로그램 메모리를 관리했었다. 자바에서는 JVM이 프로그램 메모리를 관리한다. JVM은 가비지 컬렉션이란 프로세스를 통해 메모리를 관리하며, 이는 프로그램에서 사용되지 않는 메모리를 지속적으로 찾아내서 제거한다. 즉, 실행중인 JVM내부에서 일어난다.<br> 그럼 왜 많은 개발자들이 C나 C++같이 메모리관리를 직접해야하는 언어를 사용하냐는 생각이 들 수 있다. 하지만 편리함에는 대가를 치루는 법. 앞서 말했듯 JVM이 지속적으로 가비지 컬렉션을 하기 때문에 시간이 그만큼 많이 들어간다. 하지만, 직접관리를 한다면 그 시간을 줄일 수 있을 것이다. 그래서 초창기 자바의 가비지컬렉션에 대해 속도측면에서 많이 까였다. 하지만, 지금은 많은 개발과 최적화를 통해 크게 개선되어 메탈에 가까워졌다.</p><hr><h3 id="컴파일-하는-방법"><a href="#컴파일-하는-방법" class="headerlink" title="컴파일 하는 방법"></a>컴파일 하는 방법</h3><p><a href="https://zerodark.tistory.com/14">컴파일 하는 과정</a><br>위 링크에 컴파일 하는 과정을 잘 요약해주었다.</p><p>컴파일 하는 과정은 다음과 같다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 소스코드를 작성한다.(.java)</span><br><span class="line">2. 컴파일러를 통해 바이트코드로 컴파일한다. (.class)</span><br><span class="line">3. java명령어로 프로그램을 실행한다.</span><br></pre></td></tr></table></figure><p>대부분의 나같은 주니어개발자들은 intelliJ나 이클립스같은 IDE를 통해 컴파일부터 실행까지 모두 하지만 위의 과정들은 당연히 알아두어야한다.</p><hr><h3 id="바이트코드란"><a href="#바이트코드란" class="headerlink" title="바이트코드란?"></a>바이트코드란?</h3><p>앞선 과정중에 <code>바이트코드</code>라는 것이나온다. 보통 C나 C++을 배우다보면 이런 것은 들어본 적이 없다. 바이트 코드의 정의는 다음과 같다.</p><blockquote><p>바이트코드(Bytecode, portable code, p-code)는 특정 하드웨어가 아닌 가상 컴퓨터에서 돌아가는 실행 프로그램을 위한 이진 표현법이다. 하드웨어가 아닌 소프트웨어에 의해 처리되기 때문에, 보통 기계어보다 더 추상적이다.<br>다음의 자바코드가 있다고 하자.</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">outer:</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j &lt; i; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i % j == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">continue</span> outer;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println (i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>이는 다음과 같은 바이트코드로 번역된다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">0:   iconst_2</span><br><span class="line">1:   istore_1</span><br><span class="line">2:   iload_1</span><br><span class="line">3:   sipush  1000</span><br><span class="line">6:   if_icmpge       44</span><br><span class="line">9:   iconst_2</span><br><span class="line">10:  istore_2</span><br><span class="line">11:  iload_2</span><br><span class="line">12:  iload_1</span><br><span class="line">13:  if_icmpge       31</span><br><span class="line">16:  iload_1</span><br><span class="line">17:  iload_2</span><br><span class="line">18:  irem</span><br><span class="line">19:  ifne    25</span><br><span class="line">22:  goto    38</span><br><span class="line">25:  iinc    2, 1</span><br><span class="line">28:  goto    11</span><br><span class="line">31:  getstatic       #84; &#x2F;&#x2F; Field java&#x2F;lang&#x2F;System.out:Ljava&#x2F;io&#x2F;PrintStream;</span><br><span class="line">34:  iload_1</span><br><span class="line">35:  invokevirtual   #85; &#x2F;&#x2F; Method java&#x2F;io&#x2F;PrintStream.println:(I)V</span><br><span class="line">38:  iinc    1, 1</span><br><span class="line">41:  goto    2</span><br><span class="line">44:  return</span><br></pre></td></tr></table></figure><p>바이트코드도 컴파일의 과정이므로 당연히 사람이 읽기 쉽도록 쓰인 소스코드보다 덜 추상적이며, 더 간결하고, 더 컴퓨터 중심적이다.(어셈블리어와 비슷한형태다.) 실은 아까 보여준 컴파일 과정중에 한가지 과정이 생략되었는데, 바로 실행전에 JIT컴파일러로 기계코드로 바꾸는 것이다. 이에 대해서는 다음 과정에서 살펴보겠다.</p><hr><h3 id="JIT-컴파일러란"><a href="#JIT-컴파일러란" class="headerlink" title="JIT 컴파일러란?"></a>JIT 컴파일러란?</h3><p>정의는 다음과 같다.</p><blockquote><p>JIT 컴파일(just-in-time compilation) 또는 동적 번역(dynamic translation)은 프로그램을 실제 실행하는 시점에 기계어로 번역하는 컴파일 기법이다.</p></blockquote><p>이런 기계어 변환은 코드가 실행되는 과정에 실시간으로 일어나며(그래서 Just-In-Time이다), 전체 코드의 필요한 부분만 변환한다. 기계어로 변환된 코드는 캐시에 저장되기 때문에 재사용시 컴파일을 다시 할 필요가 없다.</p><p>일반적인 <code>인터프러터 언어(예시: cpython)</code>는 바이트코드나 소스코드를 최적화 과정이 없기 번역하기 때문에 성능이 낮다. 반면 <code>정적으로 컴파일하는 언어(예시: c 언어)</code>는 실행 전에 무조건 컴파일을 해야하기 때문에 다양한 플랫폼에 맞게 컴파일을 하려면 시간이 오래 걸린다. <code>동적 컴파일 환경</code>은 실행 과정에서 컴파일을 할 수 있기 위해 만들어졌다. JIT는 정적 컴파일러 만큼 빠르면서 인터프러터 언어의 빠른 응답속도를 추구하기 위해 사용한다. 바이트코드 컴파일러가 시간이 많이 소요되는 최적화를 미리 해주기 때문에 바이트코드에서 기계어 번역은 훨씬 빠르게 진행될 수 있다. 또한 바이트코드는 이식성이 뛰어나 가상 머신이 설치되어 있으면 빠르게 실행할 수 있다.</p><hr><h3 id="JVM-구성요소"><a href="#JVM-구성요소" class="headerlink" title="JVM 구성요소"></a>JVM 구성요소</h3><p align="center"><img src="https://d2.naver.com/content/images/2015/06/helloworld-1230-1.png"></p><p>JVM에는 3가지 측면이 있다고 할 수 있다. 표준(Specification), 구현(Implementation ) 그리고 인스턴스(Instance)인데, 각각에 대해 살펴보자.</p><h4 id="1-표준-Specification"><a href="#1-표준-Specification" class="headerlink" title="1. 표준(Specification)"></a>1. 표준(Specification)</h4><p>첫째, JVM은 소프트웨어 사양이다. 다소 순환적인 방식으로, JVM 사양은 구현에 있어 최대한의 창조성을 허용하기 위해, JVM 구현 세부사항이 사양 안에 정의되어 있지 않다고 강조하고 있다.<br>결국, JVM이 해야만 하는 일은 자바 프로그램을 정확하게 실행하는 것뿐이다. 간단해 보인다, 심지어 겉으로 보기에는 단순해 보이기도 하지만, 자바 언어의 능력과 유연성을 고려할 때, 이것은 엄청나게 힘든 일이다.</p><h4 id="2-구현-Implementation"><a href="#2-구현-Implementation" class="headerlink" title="2. 구현(Implementation)"></a>2. 구현(Implementation)</h4><p>JVM 사양 구현은 실제 소프트웨어 프로그램을 도출하며, 이것이 JVM 구현이다. 실제로, 오픈소스와 특정 업체 고유의 JVM 구현이 다수 존재한다. 오픈JDK의 핫스팟(HotSpot) JVM은 참조 구현이며, 세계에서 가장 철저하게 증명된 코드기반 중 하나로 남아있다. 핫스팟은 가장 널리 사용되는 JVM이기도 하다.</p><p>오라클의 라이선스가 부여된 JDK를 포함해, 라이선스가 부여되는 거의 모든 JVM은 오픈JDK와 핫스팟 JVM의 포크(Fork)로 생성된 것이다. 오픈JDK로부터 허가받은 포크를 생성하는 개발자들은 종종 운영체제 고유의 성능 개선사항들을 추가하려는 욕구에 의해 동기 부여된다. 일반적으로, 개발자는 JRE(Java Runtime Environment) 번들의 한 부분으로 JVM을 다운로드해 설치한다.</p><h4 id="3-인스턴스-Instance"><a href="#3-인스턴스-Instance" class="headerlink" title="3. 인스턴스(Instance)"></a>3. 인스턴스(Instance)</h4><p>JVM 스펙이 구현돼서 소프트웨어 제품으로 릴리즈되면, 개발자는 그것을 하나의 프로그램처럼 다운로드해 실행할 수 있다. 이렇게 다운로드 된 프로그램이 하나의 JVM 인스턴스(또는 인스턴스화된 버전)이다.</p><p>개발자들이 “JVM”에 대해 말하는 경우, 대부분의 경우에는 소프트웨어 개발 환경 또는 제품화 환경에서 실행되는 하나의 JVM 인스턴스를 지칭한다. “아난드, 그 서버에 있는 JVM은 메모리를 얼마나 사용하고 있어?” 또는 “순환 호출(Circular Call)을 하는 바람에 스택 오버플로우 에러가 내 JVM을 망가뜨렸다니, 믿을 수가 없군. 이런 초보적인 실수를 하다니!”라고 말할 지도 모른다.</p><hr><h3 id="JDK와-JRE의-차이"><a href="#JDK와-JRE의-차이" class="headerlink" title="JDK와 JRE의 차이"></a>JDK와 JRE의 차이</h3><p>간단하게 설명하면 다음과 같다.</p><p><strong>JRE란?</strong><br>먼저 JRE는 Java Runtime Environment의 약자로 자바 프로그램을 실행시켜주는 환경을 구성해주는 도구다. 즉 JAVA를 개발할 필요는 없는데, 실행은 시켜줘야 하는 경우에는 꼭 JRE가 있어야 한다. 반면 JAVA 개발시 꼭 필요한 것이 있는데 그것이 바로 JDK다.</p><p><strong>JDK란?</strong><br>JDK는 Java Development Kit의 약자로 말그대로 자바 개발시 필요한 툴킷을 제공하는 도구모음이다. 개발하려면 당연히 실행도 시켜야 하므로 JDK 안에는 JRE가 포함되어 있다. </p><p>사용자 입장에서 요약하자면<br>JAVA로 만들어진 프로그램을 실행만 시킬 것이라면  JRE만 설치하면 되고<br>JAVA 개발자라면 JDK를 설치하면 된다.</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Algorithm] 멀쩡한사각형</title>
      <link href="2021/01/10/algorithm_210119/"/>
      <url>2021/01/10/algorithm_210119/</url>
      
        <content type="html"><![CDATA[<h1 id="멀쩡한-사각형-Summer-Winter-Coding-2019"><a href="#멀쩡한-사각형-Summer-Winter-Coding-2019" class="headerlink" title="멀쩡한 사각형 (Summer/Winter Coding(2019))"></a>멀쩡한 사각형 (Summer/Winter Coding(2019))</h1><hr><h2 id="문제설명"><a href="#문제설명" class="headerlink" title="문제설명"></a>문제설명</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> 가로 길이가 Wcm, 세로 길이가 Hcm인 직사각형 종이가 있습니다. 종이에는 가로, 세로 방향과 평행하게 격자 형태로 선이 그어져 있으며, 모든 격자칸은 1cm x 1cm 크기입니다. 이 종이를 격자 선을 따라 1cm × 1cm의 정사각형으로 잘라 사용할 예정이었는데, 누군가가 이 종이를 대각선 꼭지점 2개를 잇는 방향으로 잘라 놓았습니다.</span><br><span class="line"> 그러므로 현재 직사각형 종이는 크기가 같은 직각삼각형 2개로 나누어진 상태입니다. 새로운 종이를 구할 수 없는 상태이기 때문에, 이 종이에서 원래 종이의 가로, 세로 방향과 평행하게 1cm × 1cm로 잘라 사용할 수 있는 만큼만 사용하기로 하였습니다.</span><br><span class="line">가로의 길이 W와 세로의 길이 H가 주어질 때, 사용할 수 있는 정사각형의 개수를 구하는 solution 함수를 완성해 주세요.</span><br></pre></td></tr></table></figure><hr><h2 id="제한사항"><a href="#제한사항" class="headerlink" title="제한사항"></a>제한사항</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">W, H : 1억 이하의 자연수</span><br></pre></td></tr></table></figure><h2 id="입출력-예"><a href="#입출력-예" class="headerlink" title="입출력 예"></a>입출력 예</h2><table><thead><tr><th>W</th><th align="center">H</th><th align="right">result</th></tr></thead><tbody><tr><td>8</td><td align="center">12</td><td align="right">80</td></tr></tbody></table><hr><h2 id="입출력-예-설명"><a href="#입출력-예-설명" class="headerlink" title="입출력 예 설명"></a>입출력 예 설명</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">입출력 예 #1</span><br><span class="line">가로가 8, 세로가 12인 직사각형을 대각선 방향으로 자르면 총 16개 정사각형을 사용할 수 없게 됩니다. 원래 직사각형에서는 96개의 정사각형을 만들 수 있었으므로, 96 - 16 &#x3D; 80 을 반환합니다.</span><br></pre></td></tr></table></figure><p><img src="https://grepp-programmers.s3.amazonaws.com/files/production/ee895b2cd9/567420db-20f4-4064-afc3-af54c4a46016.png" alt="example"></p><hr><h2 id="문제풀이"><a href="#문제풀이" class="headerlink" title="문제풀이"></a>문제풀이</h2><p>처음에 문제를 봤을 때 바로 떠오른 생각이 최대공약수 개념이었다.<br>위에 있는 그림은 스크롤을 내리지 못해 미처 발견하지 못했고 혼자서 생각해보았다.</p><p>5분 정도 혼자 고민을 한 끝에 최대공약수로는 판단할 수 없다고 생각을 했다.</p><p>따라서, 구글링을 통해 [대각선이 지나는 점의 개수]를 찾는 방법을 찾았다.<br>[대각선이 지나는 점의 개수] : <a href="https://m.blog.naver.com/orbis1020/220664563768">https://m.blog.naver.com/orbis1020/220664563768</a><br><br><br><img src="https://mblogthumb-phinf.pstatic.net/20160324_159/orbis1020_1458747302465IxfMV_PNG/%B0%DD%C0%DA.png?type=w2" alt="example"></p><p>초등학교 5학년의 수학문제라는 점에서 자괴감이 들었다. 나는. 4학년이니까 괜찮다! (..대학교)</p><p>본론으로 다시 넘어와서 점의 개수는 위의 그림처럼 격자점의 유무에 따라 달라진다.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(1) 격자점이 존재할 경우 : 가로와 세로의 최대공약수가 2일 때</span><br><span class="line">(2) 격자점이 존재하지 않을 경우 : 두 수의 최대공약수가 1일 때</span><br><span class="line"></span><br><span class="line">(1)의 경우에는 &#39;(가로)+(세로)-1&#39;</span><br><span class="line">(2)의 경우에는 &#39;(가로)+(세로)-(가로와 세로의 최대공약수)</span><br></pre></td></tr></table></figure><p>하지만 둘 다 코드에선 같은 최대공약수를 빼므로 결론적으론 (가로) + (세로) - (최대공약수)임을 알 수 있다.</p><p>최대 공약수를 구하는 방법은 다양한 방법이 있겠지만 Level1에서 배웠던 유클리드호제법을 사용하여 구했다. (Level1_C++_gcdlcm)</p><h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">long long gcd(long long a, long long b)</span><br><span class="line">&#123;</span><br><span class="line">    long c;</span><br><span class="line"></span><br><span class="line">    while (b !&#x3D; 0)</span><br><span class="line">    &#123;</span><br><span class="line">        c &#x3D; a % b;</span><br><span class="line">        a &#x3D; b;</span><br><span class="line">        b &#x3D; c;</span><br><span class="line">    &#125;</span><br><span class="line">    return a;</span><br><span class="line">&#125;</span><br><span class="line">long long solution(int w, int h) &#123;</span><br><span class="line">    long long W &#x3D; w;</span><br><span class="line">    long long H &#x3D; h;</span><br><span class="line"></span><br><span class="line">    return (W * H) - ((W + H) - gcd(W, H));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Algorithm </tag>
            
            <tag> Programmers </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
